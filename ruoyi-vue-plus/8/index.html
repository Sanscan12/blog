<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ruoyi-vue-plus-代码生成功能 | 柏竹</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="https://image.bozhu12.cc/myblog/Essay/favicon.ico">
    <script language="javascript" type="text/javascript" src="/js/pgmanor-self.js"></script>
    <script language="javascript" type="text/javascript" src="/js/echarts.min.js"></script>
    <meta name="description" content="学习足迹 , 记录生活!">
    <meta name="Sasncan12" content="柏竹博客, 个人技术博客, 前后端端 , 技术文档">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#bd93f9">
    
    <link rel="preload" href="/assets/css/0.styles.b41e82d5.css" as="style"><link rel="preload" href="/assets/js/app.d9970b58.js" as="script"><link rel="preload" href="/assets/js/2.b26d2d6f.js" as="script"><link rel="preload" href="/assets/js/108.047f07cd.js" as="script"><link rel="prefetch" href="/assets/js/10.9835140b.js"><link rel="prefetch" href="/assets/js/100.e799b182.js"><link rel="prefetch" href="/assets/js/101.623403a0.js"><link rel="prefetch" href="/assets/js/102.bc3ab65d.js"><link rel="prefetch" href="/assets/js/103.302a4635.js"><link rel="prefetch" href="/assets/js/104.c6257ace.js"><link rel="prefetch" href="/assets/js/105.f35cc49f.js"><link rel="prefetch" href="/assets/js/106.400ec2b2.js"><link rel="prefetch" href="/assets/js/107.03e97ae6.js"><link rel="prefetch" href="/assets/js/109.b04ead8b.js"><link rel="prefetch" href="/assets/js/11.95f8dafb.js"><link rel="prefetch" href="/assets/js/110.441b156a.js"><link rel="prefetch" href="/assets/js/111.64fc3310.js"><link rel="prefetch" href="/assets/js/112.507dbf5e.js"><link rel="prefetch" href="/assets/js/113.04105445.js"><link rel="prefetch" href="/assets/js/114.bcc90ccb.js"><link rel="prefetch" href="/assets/js/115.aee2110f.js"><link rel="prefetch" href="/assets/js/116.e985fcfc.js"><link rel="prefetch" href="/assets/js/117.a82b7a02.js"><link rel="prefetch" href="/assets/js/118.3864ee93.js"><link rel="prefetch" href="/assets/js/119.739cc195.js"><link rel="prefetch" href="/assets/js/12.5c7db9f8.js"><link rel="prefetch" href="/assets/js/120.0f8cbc2c.js"><link rel="prefetch" href="/assets/js/121.1e33566a.js"><link rel="prefetch" href="/assets/js/122.5d236ac4.js"><link rel="prefetch" href="/assets/js/123.443ed395.js"><link rel="prefetch" href="/assets/js/124.972578da.js"><link rel="prefetch" href="/assets/js/125.ecde9969.js"><link rel="prefetch" href="/assets/js/126.e87d28dd.js"><link rel="prefetch" href="/assets/js/127.f3b1ebde.js"><link rel="prefetch" href="/assets/js/128.45b39825.js"><link rel="prefetch" href="/assets/js/129.98f67914.js"><link rel="prefetch" href="/assets/js/13.749214b7.js"><link rel="prefetch" href="/assets/js/130.40cb1628.js"><link rel="prefetch" href="/assets/js/131.c5f26790.js"><link rel="prefetch" href="/assets/js/132.118b5d70.js"><link rel="prefetch" href="/assets/js/133.e94f4a93.js"><link rel="prefetch" href="/assets/js/134.69a22950.js"><link rel="prefetch" href="/assets/js/135.97a74579.js"><link rel="prefetch" href="/assets/js/136.3c7b99a9.js"><link rel="prefetch" href="/assets/js/137.048d2980.js"><link rel="prefetch" href="/assets/js/138.d57c05c0.js"><link rel="prefetch" href="/assets/js/139.ea8ce6ff.js"><link rel="prefetch" href="/assets/js/14.7e6d262f.js"><link rel="prefetch" href="/assets/js/140.987fbe40.js"><link rel="prefetch" href="/assets/js/141.9abd3dff.js"><link rel="prefetch" href="/assets/js/142.1fa6f9dc.js"><link rel="prefetch" href="/assets/js/143.9a0eb388.js"><link rel="prefetch" href="/assets/js/144.11967947.js"><link rel="prefetch" href="/assets/js/145.c7ea3574.js"><link rel="prefetch" href="/assets/js/146.11f6e059.js"><link rel="prefetch" href="/assets/js/147.922208c3.js"><link rel="prefetch" href="/assets/js/148.cb24856a.js"><link rel="prefetch" href="/assets/js/149.e2c945a2.js"><link rel="prefetch" href="/assets/js/15.2e4f8cc2.js"><link rel="prefetch" href="/assets/js/150.350f4997.js"><link rel="prefetch" href="/assets/js/151.78694867.js"><link rel="prefetch" href="/assets/js/152.24e7402e.js"><link rel="prefetch" href="/assets/js/153.bada6165.js"><link rel="prefetch" href="/assets/js/154.44296cf7.js"><link rel="prefetch" href="/assets/js/155.c01593f8.js"><link rel="prefetch" href="/assets/js/156.d9e3d1da.js"><link rel="prefetch" href="/assets/js/157.a5bd6128.js"><link rel="prefetch" href="/assets/js/158.6e1cf4e5.js"><link rel="prefetch" href="/assets/js/159.2d87ab7e.js"><link rel="prefetch" href="/assets/js/16.c2cd40e1.js"><link rel="prefetch" href="/assets/js/160.a5eb764e.js"><link rel="prefetch" href="/assets/js/161.d41eafb0.js"><link rel="prefetch" href="/assets/js/17.687de162.js"><link rel="prefetch" href="/assets/js/18.6ec9b542.js"><link rel="prefetch" href="/assets/js/19.c927b9a4.js"><link rel="prefetch" href="/assets/js/20.6802ce4f.js"><link rel="prefetch" href="/assets/js/21.0cdd82a6.js"><link rel="prefetch" href="/assets/js/22.cd5b0f4c.js"><link rel="prefetch" href="/assets/js/23.66f907eb.js"><link rel="prefetch" href="/assets/js/24.4c0b05ee.js"><link rel="prefetch" href="/assets/js/25.65e92ad2.js"><link rel="prefetch" href="/assets/js/26.c3dc5ccc.js"><link rel="prefetch" href="/assets/js/27.45c9e057.js"><link rel="prefetch" href="/assets/js/28.20d6c7ca.js"><link rel="prefetch" href="/assets/js/29.5abdde47.js"><link rel="prefetch" href="/assets/js/3.be234d5b.js"><link rel="prefetch" href="/assets/js/30.9b50083a.js"><link rel="prefetch" href="/assets/js/31.f177c36d.js"><link rel="prefetch" href="/assets/js/32.8212f0bc.js"><link rel="prefetch" href="/assets/js/33.c8bf090d.js"><link rel="prefetch" href="/assets/js/34.01658520.js"><link rel="prefetch" href="/assets/js/35.ee91ee76.js"><link rel="prefetch" href="/assets/js/36.47833f09.js"><link rel="prefetch" href="/assets/js/37.bd3ffb36.js"><link rel="prefetch" href="/assets/js/38.c948d014.js"><link rel="prefetch" href="/assets/js/39.bff8ae75.js"><link rel="prefetch" href="/assets/js/4.5017c5ca.js"><link rel="prefetch" href="/assets/js/40.dba246e4.js"><link rel="prefetch" href="/assets/js/41.11ef63c0.js"><link rel="prefetch" href="/assets/js/42.00e110e9.js"><link rel="prefetch" href="/assets/js/43.e21776c9.js"><link rel="prefetch" href="/assets/js/44.255279ff.js"><link rel="prefetch" href="/assets/js/45.ef371806.js"><link rel="prefetch" href="/assets/js/46.7965bbbe.js"><link rel="prefetch" href="/assets/js/47.33f2d7e7.js"><link rel="prefetch" href="/assets/js/48.c6ad58ff.js"><link rel="prefetch" href="/assets/js/49.bc8d702d.js"><link rel="prefetch" href="/assets/js/5.9c242416.js"><link rel="prefetch" href="/assets/js/50.3c950101.js"><link rel="prefetch" href="/assets/js/51.157514fb.js"><link rel="prefetch" href="/assets/js/52.4badcde4.js"><link rel="prefetch" href="/assets/js/53.a34ff845.js"><link rel="prefetch" href="/assets/js/54.3b99dd22.js"><link rel="prefetch" href="/assets/js/55.4f92ff2a.js"><link rel="prefetch" href="/assets/js/56.4eea5408.js"><link rel="prefetch" href="/assets/js/57.571dec1f.js"><link rel="prefetch" href="/assets/js/58.015dea87.js"><link rel="prefetch" href="/assets/js/59.366f7812.js"><link rel="prefetch" href="/assets/js/6.20f6982a.js"><link rel="prefetch" href="/assets/js/60.8d1b8c5c.js"><link rel="prefetch" href="/assets/js/61.fba48ca4.js"><link rel="prefetch" href="/assets/js/62.9daf74ad.js"><link rel="prefetch" href="/assets/js/63.12e3cce7.js"><link rel="prefetch" href="/assets/js/64.5038c472.js"><link rel="prefetch" href="/assets/js/65.c1ffc5f0.js"><link rel="prefetch" href="/assets/js/66.c8e2718c.js"><link rel="prefetch" href="/assets/js/67.7097ddc6.js"><link rel="prefetch" href="/assets/js/68.b81ad9cb.js"><link rel="prefetch" href="/assets/js/69.5011b50a.js"><link rel="prefetch" href="/assets/js/7.c22f1339.js"><link rel="prefetch" href="/assets/js/70.dc1a7a23.js"><link rel="prefetch" href="/assets/js/71.9c4c3fdf.js"><link rel="prefetch" href="/assets/js/72.75e15070.js"><link rel="prefetch" href="/assets/js/73.239a4507.js"><link rel="prefetch" href="/assets/js/74.ae02de1c.js"><link rel="prefetch" href="/assets/js/75.c649579a.js"><link rel="prefetch" href="/assets/js/76.4cfcab2d.js"><link rel="prefetch" href="/assets/js/77.c5b4cdd8.js"><link rel="prefetch" href="/assets/js/78.4c50028c.js"><link rel="prefetch" href="/assets/js/79.737fdd97.js"><link rel="prefetch" href="/assets/js/8.a8e2447d.js"><link rel="prefetch" href="/assets/js/80.3ee2ea53.js"><link rel="prefetch" href="/assets/js/81.6f36a800.js"><link rel="prefetch" href="/assets/js/82.0b767d6e.js"><link rel="prefetch" href="/assets/js/83.262783ec.js"><link rel="prefetch" href="/assets/js/84.16d2e181.js"><link rel="prefetch" href="/assets/js/85.5ca1bc34.js"><link rel="prefetch" href="/assets/js/86.a8bf2d59.js"><link rel="prefetch" href="/assets/js/87.3e285b84.js"><link rel="prefetch" href="/assets/js/88.78debaed.js"><link rel="prefetch" href="/assets/js/89.d7221e19.js"><link rel="prefetch" href="/assets/js/9.674ab0b1.js"><link rel="prefetch" href="/assets/js/90.6ffd7277.js"><link rel="prefetch" href="/assets/js/91.c84db656.js"><link rel="prefetch" href="/assets/js/92.11e3f66e.js"><link rel="prefetch" href="/assets/js/93.0f3b183b.js"><link rel="prefetch" href="/assets/js/94.ba40a568.js"><link rel="prefetch" href="/assets/js/95.766806b4.js"><link rel="prefetch" href="/assets/js/96.8aef4890.js"><link rel="prefetch" href="/assets/js/97.c40078bd.js"><link rel="prefetch" href="/assets/js/98.b63fa585.js"><link rel="prefetch" href="/assets/js/99.e0705a4f.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b41e82d5.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu have-body-img"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="https://image.bozhu12.cc/myblog/Essay/hendImage01.jpg" alt="柏竹" class="logo"> <span class="site-name can-hide">柏竹</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/backend/" class="nav-link">后端</a></div><div class="nav-item"><a href="/web/" class="nav-link">前端</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/other/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/Amway/" class="nav-link">应用推荐</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/friendLink/" class="nav-link">友链</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://image.bozhu12.cc/myblog/Essay/favicon.ico"> <div class="blogger-info"><h3>柏竹</h3> <span>奋斗柏竹</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/backend/" class="nav-link">后端</a></div><div class="nav-item"><a href="/web/" class="nav-link">前端</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/other/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/Amway/" class="nav-link">应用推荐</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/friendLink/" class="nav-link">友链</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Java基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JavaWeb</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>拓展技术</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>框架技术</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据库</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据结构</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Spring</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>SpringMVC</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>SpringBoot</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>SpringClound</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Ruoyi-Vue-Plus</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/ruoyi-vue-plus/1/" class="sidebar-link">ruoyi-vue-plus-基础功能</a></li><li><a href="/ruoyi-vue-plus/2/" class="sidebar-link">ruoyi-vue-plus-权限控制</a></li><li><a href="/ruoyi-vue-plus/3/" class="sidebar-link">ruoyi-vue-plus-表格操作</a></li><li><a href="/ruoyi-vue-plus/4/" class="sidebar-link">ruoyi-vue-plus-缓存功能</a></li><li><a href="/ruoyi-vue-plus/5/" class="sidebar-link">ruoyi-vue-plus-日志功能</a></li><li><a href="/ruoyi-vue-plus/6/" class="sidebar-link">ruoyi-vue-plus-线程相关</a></li><li><a href="/ruoyi-vue-plus/7/" class="sidebar-link">ruoyi-vue-plus-OSS功能</a></li><li><a href="/ruoyi-vue-plus/8/" aria-current="page" class="active sidebar-link">ruoyi-vue-plus-代码生成功能</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/ruoyi-vue-plus/8/#快速应用" class="sidebar-link">快速应用</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/ruoyi-vue-plus/8/#基本信息" class="sidebar-link">基本信息</a></li><li class="sidebar-sub-header level3"><a href="/ruoyi-vue-plus/8/#字段信息" class="sidebar-link">字段信息</a></li><li class="sidebar-sub-header level3"><a href="/ruoyi-vue-plus/8/#生成信息" class="sidebar-link">生成信息</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/ruoyi-vue-plus/8/#配置文件" class="sidebar-link">配置文件</a></li><li class="sidebar-sub-header level2"><a href="/ruoyi-vue-plus/8/#核心业务" class="sidebar-link">核心业务</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/ruoyi-vue-plus/8/#导入列表" class="sidebar-link">导入列表</a></li><li class="sidebar-sub-header level3"><a href="/ruoyi-vue-plus/8/#导入生成表" class="sidebar-link">导入生成表</a></li><li class="sidebar-sub-header level3"><a href="/ruoyi-vue-plus/8/#详细生成表" class="sidebar-link">详细生成表</a></li><li class="sidebar-sub-header level3"><a href="/ruoyi-vue-plus/8/#修改生成表" class="sidebar-link">修改生成表</a></li><li class="sidebar-sub-header level3"><a href="/ruoyi-vue-plus/8/#生成预览" class="sidebar-link">生成预览</a></li><li class="sidebar-sub-header level3"><a href="/ruoyi-vue-plus/8/#生成代码" class="sidebar-link">生成代码</a></li><li class="sidebar-sub-header level4"><a href="/ruoyi-vue-plus/8/#下载zip" class="sidebar-link">下载zip</a></li><li class="sidebar-sub-header level4"><a href="/ruoyi-vue-plus/8/#自定义路径生成" class="sidebar-link">自定义路径生成</a></li><li class="sidebar-sub-header level3"><a href="/ruoyi-vue-plus/8/#同步生成表" class="sidebar-link">同步生成表</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/ruoyi-vue-plus/8/#上下文参数-模板" class="sidebar-link">上下文参数&amp;模板</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/ruoyi-vue-plus/8/#上下文参数" class="sidebar-link">上下文参数</a></li><li class="sidebar-sub-header level3"><a href="/ruoyi-vue-plus/8/#java模板" class="sidebar-link">Java模板</a></li><li class="sidebar-sub-header level3"><a href="/ruoyi-vue-plus/8/#xml模块" class="sidebar-link">XML模块</a></li><li class="sidebar-sub-header level3"><a href="/ruoyi-vue-plus/8/#sql模板" class="sidebar-link">SQL模板</a></li></ul></li></ul></li><li><a href="/ruoyi-vue-plus/9/" class="sidebar-link">ruoyi-vue-plus-多数据源</a></li><li><a href="/ruoyi-vue-plus/10/" class="sidebar-link">ruoyi-vue-plus-任务调度</a></li><li><a href="/ruoyi-vue-plus/11/" class="sidebar-link">ruoyi-vue-plus-监控功能</a></li><li><a href="/ruoyi-vue-plus/12/" class="sidebar-link">ruoyi-vue-plus-国际化</a></li><li><a href="/ruoyi-vue-plus/13/" class="sidebar-link">ruoyi-vue-plus-XSS功能</a></li><li><a href="/ruoyi-vue-plus/14/" class="sidebar-link">ruoyi-vue-plus-防重幂&amp;限流 功能</a></li><li><a href="/ruoyi-vue-plus/15/" class="sidebar-link">ruoyi-vue-plus-推送功能</a></li><li><a href="/ruoyi-vue-plus/16/" class="sidebar-link">ruoyi-vue-plus-序列化功能</a></li><li><a href="/ruoyi-vue-plus/17/" class="sidebar-link">ruoyi-vue-plus-数据加密</a></li><li><a href="/ruoyi-vue-plus/18/" class="sidebar-link">ruoyi-vue-plus-单元测试</a></li><li><a href="/ruoyi-vue-plus/96/" class="sidebar-link">ruoyi-vue-plus-前端篇</a></li><li><a href="/ruoyi-vue-plus/97/" class="sidebar-link">ruoyi-vue-plus-工具篇</a></li><li><a href="/ruoyi-vue-plus/98/" class="sidebar-link">ruoyi-vue-plus-框架篇</a></li><li><a href="/ruoyi-vue-plus/99/" class="sidebar-link">ruoyi-vue-plus-问题解决</a></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper bg-style-1"><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/backend/#后端" data-v-06225672>后端</a></li><li data-v-06225672><a href="/backend/#Ruoyi-Vue-Plus" data-v-06225672>Ruoyi-Vue-Plus</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="javascript:;" data-v-06225672>柏竹</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2023-12-09</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">ruoyi-vue-plus-代码生成功能<!----></h1>  <div class="theme-vdoing-content content__default"><p>框架代码生成功能可快速构建项目的基础文件 , 如 : Controller , Service , Mapper 等基础架构文件 . 该框架是在页面进行配置生成信息 , 以实现快速开发 , 能够提高前期开发效率</p> <p><strong>ruoyi-vue-plus应用文档 :</strong> <a href="https://plus-doc.dromara.org/#/ruoyi-vue-plus/framework/basic/code_generate" target="_blank" rel="noopener noreferrer">https://plus-doc.dromara.org<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="快速应用"><a href="#快速应用" class="header-anchor">#</a> 快速应用</h2> <p><strong>应用大致步骤</strong></p> <ol><li>导入表</li> <li>设置配置表生成信息</li> <li>下载生成代码</li> <li>导入sql</li> <li>copy 前后端</li> <li>启用...</li></ol> <div class="custom-block warning"><p class="custom-block-title">注意</p> <ul><li>每个表必须包含有 : <strong>create_by</strong> , <strong>create_time</strong> , <strong>update_by</strong> , <strong>update_time</strong> 字段</li> <li>树表 必须包含有 指向指定字段(一般用id) , 用于指向父级数据</li></ul></div> <h3 id="基本信息"><a href="#基本信息" class="header-anchor">#</a> 基本信息</h3> <p>无关键信息填写</p> <h3 id="字段信息"><a href="#字段信息" class="header-anchor">#</a> 字段信息</h3> <p><strong>填写信息说明</strong></p> <ul><li><p><strong>物理类型</strong> =&gt; SQL应用的类型</p></li> <li><p><strong>Java类型</strong> =&gt; 对象属性类型</p></li> <li><p><strong>Java属性</strong> =&gt; 对象属性名称</p> <p>选定字段是否采用 插入/编辑/列表/查询 =&gt; 新增是否显示/编辑是否显示/列表是否显示/查询字段显示</p></li> <li><p><strong>查询方式</strong> : 选中查询后 , 指定SQL查询方式</p></li> <li><p><strong>显示类型</strong> : 在 编辑/新增 时 , 更加的方便使用</p></li> <li><p><strong>必填</strong> : 勾选后 , 插入的时候必须填写</p></li></ul> <h3 id="生成信息"><a href="#生成信息" class="header-anchor">#</a> 生成信息</h3> <p><strong>单表</strong></p> <p>关注 包路径/模块名</p> <p><strong>树表</strong></p> <p>关注 包路径/模块名/树id字段/树父id字段/树名</p> <blockquote><p>大量数据不适合使用 , 数据分级主要通过前端分级展示</p></blockquote> <h2 id="配置文件"><a href="#配置文件" class="header-anchor">#</a> 配置文件</h2> <p><strong><code>generator.yml</code> 配置文件</strong>*</p> <div class="language-yml extra-class"><pre class="language-yml"><code><span class="token comment"># 代码生成</span>
<span class="token key atrule">gen</span><span class="token punctuation">:</span> 
  <span class="token comment"># 作者</span>
  <span class="token key atrule">author</span><span class="token punctuation">:</span> bozhu
  <span class="token comment"># 默认生成包路径 system 需改成自己的模块名称 如 system monitor tool</span>
  <span class="token key atrule">packageName</span><span class="token punctuation">:</span> com.ruoyi.system
  <span class="token comment"># 自动去除表前缀，默认是false</span>
  <span class="token key atrule">autoRemovePre</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
  <span class="token comment"># 表前缀（生成类名不会包含表前缀，多个用逗号分隔）</span>
  <span class="token key atrule">tablePrefix</span><span class="token punctuation">:</span> sys_
</code></pre></div><blockquote><p>根据实际情况修改配置</p></blockquote> <h2 id="核心业务"><a href="#核心业务" class="header-anchor">#</a> 核心业务</h2> <h3 id="导入列表"><a href="#导入列表" class="header-anchor">#</a> 导入列表</h3> <p>根据 <code>information_schem</code> 数据库表信息查询</p> <p><strong>获取库表基础信息 <em>GenController#dataLis()</em></strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@SaCheckPermission</span><span class="token punctuation">(</span><span class="token string">&quot;tool:gen:list&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/db/list&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">TableDataInfo</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">GenTable</span><span class="token punctuation">&gt;</span></span> <span class="token function">dataList</span><span class="token punctuation">(</span><span class="token class-name">GenTable</span> genTable<span class="token punctuation">,</span> <span class="token class-name">PageQuery</span> pageQuery<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> genTableService<span class="token punctuation">.</span><span class="token function">selectPageDbTableList</span><span class="token punctuation">(</span>genTable<span class="token punctuation">,</span> pageQuery<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>业务层</strong> (略过 , 无必要逻辑代码)</p> <p><strong>SQL执行语句 GenTableMapper.selectPageDbTableList()</strong> (该方法适配不同数据源应用 , 只需关注MySQL应用方式即可)</p> <details class="custom-block details"><summary>点击展开</summary> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>selectPageDbTableList<span class="token punctuation">&quot;</span></span> <span class="token attr-name">resultMap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>GenTableResult<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@com.ruoyi.common.helper.DataBaseHelper@isMySql()<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        select table_name, table_comment, create_time, update_time
        from information_schema.tables
        where table_schema = (select database())
        AND table_name NOT LIKE 'xxl_job_%' AND table_name NOT LIKE 'gen_%'
        AND table_name NOT IN (select table_name from gen_table)
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>genTable.tableName != null and genTable.tableName != ''<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            AND lower(table_name) like lower(concat('%', #{genTable.tableName}, '%'))
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>genTable.tableComment != null and genTable.tableComment != ''<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            AND lower(table_comment) like lower(concat('%', #{genTable.tableComment}, '%'))
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">&gt;</span></span>
        order by create_time desc
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@com.ruoyi.common.helper.DataBaseHelper@isOracle()<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        select lower(dt.table_name) as table_name, dtc.comments as table_comment, uo.created as create_time, uo.last_ddl_time as update_time
        from user_tables dt, user_tab_comments dtc, user_objects uo
        where dt.table_name = dtc.table_name
        and dt.table_name = uo.object_name
        and uo.object_type = 'TABLE'
        AND dt.table_name NOT LIKE 'XXL_JOB_%' AND dt.table_name NOT LIKE 'GEN_%'
        AND lower(dt.table_name) NOT IN (select table_name from gen_table)
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>genTable.tableName != null and genTable.tableName != ''<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            AND lower(dt.table_name) like lower(concat(concat('%', #{genTable.tableName}), '%'))
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>genTable.tableComment != null and genTable.tableComment != ''<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            AND lower(dtc.comments) like lower(concat(concat('%', #{genTable.tableComment}), '%'))
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">&gt;</span></span>
        order by create_time desc
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@com.ruoyi.common.helper.DataBaseHelper@isPostgerSql()<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        select table_name, table_comment, create_time, update_time
        from (
            SELECT c.relname AS table_name,
                    obj_description(c.oid) AS table_comment,
                    CURRENT_TIMESTAMP AS create_time,
                    CURRENT_TIMESTAMP AS update_time
            FROM pg_class c
                LEFT JOIN pg_namespace n ON n.oid = c.relnamespace
            WHERE (c.relkind = ANY (ARRAY ['r'::&quot;char&quot;, 'p'::&quot;char&quot;]))
                AND c.relname != 'spatial_%'::text
                AND n.nspname = 'public'::name
                AND n.nspname <span class="token cdata">&lt;![CDATA[ &lt;&gt; ]]&gt;</span> ''::name
        ) list_table
        where table_name NOT LIKE 'xxl_job_%' AND table_name NOT LIKE 'gen_%'
        AND table_name NOT IN (select table_name from gen_table)
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>genTable.tableName != null and genTable.tableName != ''<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            AND lower(table_name) like lower(concat('%', #{genTable.tableName}, '%'))
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>genTable.tableComment != null and genTable.tableComment != ''<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            AND lower(table_comment) like lower(concat('%', #{genTable.tableComment}, '%'))
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">&gt;</span></span>
        order by create_time desc
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@com.ruoyi.common.helper.DataBaseHelper@isSqlServer()<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        SELECT cast(D.NAME as nvarchar) as table_name,
               cast(F.VALUE as nvarchar) as table_comment,
               crdate as create_time,
               refdate as update_time
        FROM SYSOBJECTS D
            INNER JOIN SYS.EXTENDED_PROPERTIES F ON D.ID = F.MAJOR_ID
                AND F.MINOR_ID = 0 AND D.XTYPE = 'U' AND D.NAME != 'DTPROPERTIES'
                AND D.NAME NOT LIKE 'xxl_job_%' AND D.NAME NOT LIKE 'gen_%'
                AND D.NAME NOT IN (select table_name from gen_table)
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>genTable.tableName != null and genTable.tableName != ''<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            AND lower(D.NAME) like lower(concat(N'%', N'${genTable.tableName}', N'%'))
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>genTable.tableComment != null and genTable.tableComment != ''<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            AND lower(CAST(F.VALUE AS nvarchar)) like lower(concat(N'%', N'${genTable.tableComment}', N'%'))
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">&gt;</span></span>
        order by crdate desc
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><strong>实际执行的SQL</strong></p> <p>以下SQL是查询当前数据源的所有库表信息 , 因此需要加多层约束过滤</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
	table_name<span class="token punctuation">,</span>
	table_comment<span class="token punctuation">,</span>
	create_time<span class="token punctuation">,</span>
	update_time 
<span class="token keyword">FROM</span>
	information_schema<span class="token punctuation">.</span><span class="token keyword">TABLES</span> 
<span class="token keyword">WHERE</span>
	<span class="token comment"># 仅保留当前库的表</span>
	table_schema <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token keyword">DATABASE</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
	<span class="token comment"># 排除不必要的表名(模糊匹配)</span>
	<span class="token operator">AND</span> table_name <span class="token operator">NOT</span> <span class="token operator">LIKE</span> <span class="token string">'xxl_job_%'</span> 
	<span class="token operator">AND</span> table_name <span class="token operator">NOT</span> <span class="token operator">LIKE</span> <span class="token string">'gen_%'</span> 
	<span class="token comment"># 排除已经导入的表</span>
	<span class="token operator">AND</span> table_name <span class="token operator">NOT</span> <span class="token operator">IN</span> <span class="token punctuation">(</span> <span class="token keyword">SELECT</span> table_name <span class="token keyword">FROM</span> gen_table <span class="token punctuation">)</span> 
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span>
	create_time <span class="token keyword">DESC</span> 
	<span class="token keyword">LIMIT</span> <span class="token number">10</span>
</code></pre></div></details> <p><strong><code>DataBaseHelper</code>数据源判断</strong></p> <details class="custom-block details"><summary>点击展开</summary> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@NoArgsConstructor</span><span class="token punctuation">(</span>access <span class="token operator">=</span> <span class="token class-name">AccessLevel</span><span class="token punctuation">.</span><span class="token constant">PRIVATE</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DataBaseHelper</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">DynamicRoutingDataSource</span> <span class="token constant">DS</span> <span class="token operator">=</span> <span class="token class-name">SpringUtils</span><span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token class-name">DynamicRoutingDataSource</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * 获取当前数据库类型
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">DataBaseType</span> <span class="token function">getDataBaseType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">DataSource</span> dataSource <span class="token operator">=</span> <span class="token constant">DS</span><span class="token punctuation">.</span><span class="token function">determineDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">Connection</span> conn <span class="token operator">=</span> dataSource<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">DatabaseMetaData</span> metaData <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">getMetaData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> databaseProductName <span class="token operator">=</span> metaData<span class="token punctuation">.</span><span class="token function">getDatabaseProductName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token class-name">DataBaseType</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>databaseProductName<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ServiceException</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">boolean</span> <span class="token function">isMySql</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">DataBaseType</span><span class="token punctuation">.</span><span class="token constant">MY_SQL</span> <span class="token operator">==</span> <span class="token function">getDataBaseType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">boolean</span> <span class="token function">isOracle</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">DataBaseType</span><span class="token punctuation">.</span><span class="token constant">ORACLE</span> <span class="token operator">==</span> <span class="token function">getDataBaseType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">boolean</span> <span class="token function">isPostgerSql</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">DataBaseType</span><span class="token punctuation">.</span><span class="token constant">POSTGRE_SQL</span> <span class="token operator">==</span> <span class="token function">getDataBaseType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">boolean</span> <span class="token function">isSqlServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">DataBaseType</span><span class="token punctuation">.</span><span class="token constant">SQL_SERVER</span> <span class="token operator">==</span> <span class="token function">getDataBaseType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">findInSet</span><span class="token punctuation">(</span><span class="token class-name">Object</span> var1<span class="token punctuation">,</span> <span class="token class-name">String</span> var2<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">DataBaseType</span> dataBasyType <span class="token operator">=</span> <span class="token function">getDataBaseType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> <span class="token keyword">var</span> <span class="token operator">=</span> <span class="token class-name">Convert</span><span class="token punctuation">.</span><span class="token function">toStr</span><span class="token punctuation">(</span>var1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>dataBasyType <span class="token operator">==</span> <span class="token class-name">DataBaseType</span><span class="token punctuation">.</span><span class="token constant">SQL_SERVER</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// charindex(',100,' , ',0,100,101,') &lt;&gt; 0</span>
            <span class="token keyword">return</span> <span class="token string">&quot;charindex(',&quot;</span> <span class="token operator">+</span> <span class="token keyword">var</span> <span class="token operator">+</span> <span class="token string">&quot;,' , ','+&quot;</span> <span class="token operator">+</span> var2 <span class="token operator">+</span> <span class="token string">&quot;+',') &lt;&gt; 0&quot;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>dataBasyType <span class="token operator">==</span> <span class="token class-name">DataBaseType</span><span class="token punctuation">.</span><span class="token constant">POSTGRE_SQL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// (select position(',100,' in ',0,100,101,')) &lt;&gt; 0</span>
            <span class="token keyword">return</span> <span class="token string">&quot;(select position(',&quot;</span> <span class="token operator">+</span> <span class="token keyword">var</span> <span class="token operator">+</span> <span class="token string">&quot;,' in ','||&quot;</span> <span class="token operator">+</span> var2 <span class="token operator">+</span> <span class="token string">&quot;||',')) &lt;&gt; 0&quot;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>dataBasyType <span class="token operator">==</span> <span class="token class-name">DataBaseType</span><span class="token punctuation">.</span><span class="token constant">ORACLE</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// instr(',0,100,101,' , ',100,') &lt;&gt; 0</span>
            <span class="token keyword">return</span> <span class="token string">&quot;instr(','||&quot;</span> <span class="token operator">+</span> var2 <span class="token operator">+</span> <span class="token string">&quot;||',' , ',&quot;</span> <span class="token operator">+</span> <span class="token keyword">var</span> <span class="token operator">+</span> <span class="token string">&quot;,') &lt;&gt; 0&quot;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// find_in_set('100' , '0,100,101')</span>
        <span class="token keyword">return</span> <span class="token string">&quot;find_in_set('&quot;</span> <span class="token operator">+</span> <span class="token keyword">var</span> <span class="token operator">+</span> <span class="token string">&quot;' , &quot;</span> <span class="token operator">+</span> var2 <span class="token operator">+</span> <span class="token string">&quot;) &lt;&gt; 0&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></details> <h3 id="导入生成表"><a href="#导入生成表" class="header-anchor">#</a> 导入生成表</h3> <p>当用户选中需要导入表时 , 接口会 根据 <em>表名称</em> 进行插入 <code>gen_table</code>表 和 <code>gen_table_column</code>表</p> <p><strong>导入表结构 <em>GenController#importTableSave()</em></strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@SaCheckPermission</span><span class="token punctuation">(</span><span class="token string">&quot;tool:gen:import&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Log</span><span class="token punctuation">(</span>title <span class="token operator">=</span> <span class="token string">&quot;代码生成&quot;</span><span class="token punctuation">,</span> businessType <span class="token operator">=</span> <span class="token class-name">BusinessType</span><span class="token punctuation">.</span><span class="token constant">IMPORT</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/importTable&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">R</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> <span class="token function">importTableSave</span><span class="token punctuation">(</span><span class="token class-name">String</span> tables<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> tableNames <span class="token operator">=</span> <span class="token class-name">Convert</span><span class="token punctuation">.</span><span class="token function">toStrArray</span><span class="token punctuation">(</span>tables<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 查询表信息</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">GenTable</span><span class="token punctuation">&gt;</span></span> tableList <span class="token operator">=</span> genTableService<span class="token punctuation">.</span><span class="token function">selectDbTableListByNames</span><span class="token punctuation">(</span>tableNames<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 导入库表 gen_table , gen_table_column</span>
    genTableService<span class="token punctuation">.</span><span class="token function">importGenTable</span><span class="token punctuation">(</span>tableList<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>导入核心业务 <em>GenTableServiceImpl#importGenTable()</em></strong></p> <div class="language-java extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br></div><pre class="language-java"><code><span class="token annotation punctuation">@Transactional</span><span class="token punctuation">(</span>rollbackFor <span class="token operator">=</span> <span class="token class-name">Exception</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">importGenTable</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">GenTable</span><span class="token punctuation">&gt;</span></span> tableList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> operName <span class="token operator">=</span> <span class="token class-name">LoginHelper</span><span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">GenTable</span> table <span class="token operator">:</span> tableList<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">String</span> tableName <span class="token operator">=</span> table<span class="token punctuation">.</span><span class="token function">getTableName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 初始化 表基础信息 并保存</span>
            <span class="token class-name">GenUtils</span><span class="token punctuation">.</span><span class="token function">initTable</span><span class="token punctuation">(</span>table<span class="token punctuation">,</span> operName<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> row <span class="token operator">=</span> baseMapper<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>table<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 初始化 该表的列信息 并保存</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>row <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">GenTableColumn</span><span class="token punctuation">&gt;</span></span> genTableColumns <span class="token operator">=</span> genTableColumnMapper<span class="token punctuation">.</span><span class="token function">selectDbTableColumnsByName</span><span class="token punctuation">(</span>tableName<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">GenTableColumn</span><span class="token punctuation">&gt;</span></span> saveColumns <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">GenTableColumn</span> column <span class="token operator">:</span> genTableColumns<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token class-name">GenUtils</span><span class="token punctuation">.</span><span class="token function">initColumnField</span><span class="token punctuation">(</span>column<span class="token punctuation">,</span> table<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    saveColumns<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>column<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">CollUtil</span><span class="token punctuation">.</span><span class="token function">isNotEmpty</span><span class="token punctuation">(</span>saveColumns<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    genTableColumnMapper<span class="token punctuation">.</span><span class="token function">insertBatch</span><span class="token punctuation">(</span>saveColumns<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ServiceException</span><span class="token punctuation">(</span><span class="token string">&quot;导入失败：&quot;</span> <span class="token operator">+</span> e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong><code>GenUtils</code>代码生成工具类</strong></p> <details class="custom-block details"><summary>点击展开</summary> <p>初始化表信息 <em>GenUtils#initTable()</em></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">initTable</span><span class="token punctuation">(</span><span class="token class-name">GenTable</span> genTable<span class="token punctuation">,</span> <span class="token class-name">String</span> operName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    genTable<span class="token punctuation">.</span><span class="token function">setClassName</span><span class="token punctuation">(</span><span class="token function">convertClassName</span><span class="token punctuation">(</span>genTable<span class="token punctuation">.</span><span class="token function">getTableName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    genTable<span class="token punctuation">.</span><span class="token function">setPackageName</span><span class="token punctuation">(</span><span class="token class-name">GenConfig</span><span class="token punctuation">.</span><span class="token function">getPackageName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    genTable<span class="token punctuation">.</span><span class="token function">setModuleName</span><span class="token punctuation">(</span><span class="token function">getModuleName</span><span class="token punctuation">(</span><span class="token class-name">GenConfig</span><span class="token punctuation">.</span><span class="token function">getPackageName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    genTable<span class="token punctuation">.</span><span class="token function">setBusinessName</span><span class="token punctuation">(</span><span class="token function">getBusinessName</span><span class="token punctuation">(</span>genTable<span class="token punctuation">.</span><span class="token function">getTableName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    genTable<span class="token punctuation">.</span><span class="token function">setFunctionName</span><span class="token punctuation">(</span><span class="token function">replaceText</span><span class="token punctuation">(</span>genTable<span class="token punctuation">.</span><span class="token function">getTableComment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    genTable<span class="token punctuation">.</span><span class="token function">setFunctionAuthor</span><span class="token punctuation">(</span><span class="token class-name">GenConfig</span><span class="token punctuation">.</span><span class="token function">getAuthor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    genTable<span class="token punctuation">.</span><span class="token function">setCreateBy</span><span class="token punctuation">(</span>operName<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>初始化字段属性 <em>GenUtils#initColumnField()</em></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">initColumnField</span><span class="token punctuation">(</span><span class="token class-name">GenTableColumn</span> column<span class="token punctuation">,</span> <span class="token class-name">GenTable</span> table<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 括号处理</span>
    <span class="token class-name">String</span> dataType <span class="token operator">=</span> <span class="token function">getDbType</span><span class="token punctuation">(</span>column<span class="token punctuation">.</span><span class="token function">getColumnType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> columnName <span class="token operator">=</span> column<span class="token punctuation">.</span><span class="token function">getColumnName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    column<span class="token punctuation">.</span><span class="token function">setTableId</span><span class="token punctuation">(</span>table<span class="token punctuation">.</span><span class="token function">getTableId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    column<span class="token punctuation">.</span><span class="token function">setCreateBy</span><span class="token punctuation">(</span>table<span class="token punctuation">.</span><span class="token function">getCreateBy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 设置java字段名 (驼峰处理)</span>
    column<span class="token punctuation">.</span><span class="token function">setJavaField</span><span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">toCamelCase</span><span class="token punctuation">(</span>columnName<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 设置默认类型</span>
    column<span class="token punctuation">.</span><span class="token function">setJavaType</span><span class="token punctuation">(</span><span class="token class-name">GenConstants</span><span class="token punctuation">.</span><span class="token constant">TYPE_STRING</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 设置默认查询条件</span>
    column<span class="token punctuation">.</span><span class="token function">setQueryType</span><span class="token punctuation">(</span><span class="token class-name">GenConstants</span><span class="token punctuation">.</span><span class="token constant">QUERY_EQ</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 数据类型处理</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">arraysContains</span><span class="token punctuation">(</span><span class="token class-name">GenConstants</span><span class="token punctuation">.</span><span class="token constant">COLUMNTYPE_STR</span><span class="token punctuation">,</span> dataType<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">arraysContains</span><span class="token punctuation">(</span><span class="token class-name">GenConstants</span><span class="token punctuation">.</span><span class="token constant">COLUMNTYPE_TEXT</span><span class="token punctuation">,</span> dataType<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 文本类型处理</span>
        <span class="token comment">// 字符串长度超过500设置为文本域</span>
        <span class="token class-name">Integer</span> columnLength <span class="token operator">=</span> <span class="token function">getColumnLength</span><span class="token punctuation">(</span>column<span class="token punctuation">.</span><span class="token function">getColumnType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> htmlType <span class="token operator">=</span> columnLength <span class="token operator">&gt;=</span> <span class="token number">500</span> <span class="token operator">||</span> <span class="token function">arraysContains</span><span class="token punctuation">(</span><span class="token class-name">GenConstants</span><span class="token punctuation">.</span><span class="token constant">COLUMNTYPE_TEXT</span><span class="token punctuation">,</span> dataType<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token class-name">GenConstants</span><span class="token punctuation">.</span><span class="token constant">HTML_TEXTAREA</span> <span class="token operator">:</span> <span class="token class-name">GenConstants</span><span class="token punctuation">.</span><span class="token constant">HTML_INPUT</span><span class="token punctuation">;</span>
        column<span class="token punctuation">.</span><span class="token function">setHtmlType</span><span class="token punctuation">(</span>htmlType<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">arraysContains</span><span class="token punctuation">(</span><span class="token class-name">GenConstants</span><span class="token punctuation">.</span><span class="token constant">COLUMNTYPE_TIME</span><span class="token punctuation">,</span> dataType<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 时间类型处理</span>
        column<span class="token punctuation">.</span><span class="token function">setJavaType</span><span class="token punctuation">(</span><span class="token class-name">GenConstants</span><span class="token punctuation">.</span><span class="token constant">TYPE_DATE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        column<span class="token punctuation">.</span><span class="token function">setHtmlType</span><span class="token punctuation">(</span><span class="token class-name">GenConstants</span><span class="token punctuation">.</span><span class="token constant">HTML_DATETIME</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">arraysContains</span><span class="token punctuation">(</span><span class="token class-name">GenConstants</span><span class="token punctuation">.</span><span class="token constant">COLUMNTYPE_NUMBER</span><span class="token punctuation">,</span> dataType<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 数值类型处理</span>
        column<span class="token punctuation">.</span><span class="token function">setHtmlType</span><span class="token punctuation">(</span><span class="token class-name">GenConstants</span><span class="token punctuation">.</span><span class="token constant">HTML_INPUT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 如果是浮点型 统一用BigDecimal</span>
        <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> str <span class="token operator">=</span> <span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">substringBetween</span><span class="token punctuation">(</span>column<span class="token punctuation">.</span><span class="token function">getColumnType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;(&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token constant">SEPARATOR</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>str <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> str<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">2</span> <span class="token operator">&amp;&amp;</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 浮点型</span>
            column<span class="token punctuation">.</span><span class="token function">setJavaType</span><span class="token punctuation">(</span><span class="token class-name">GenConstants</span><span class="token punctuation">.</span><span class="token constant">TYPE_BIGDECIMAL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>str <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> str<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>str<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 整型</span>
            column<span class="token punctuation">.</span><span class="token function">setJavaType</span><span class="token punctuation">(</span><span class="token class-name">GenConstants</span><span class="token punctuation">.</span><span class="token constant">TYPE_INTEGER</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token comment">// 长整型</span>
            column<span class="token punctuation">.</span><span class="token function">setJavaType</span><span class="token punctuation">(</span><span class="token class-name">GenConstants</span><span class="token punctuation">.</span><span class="token constant">TYPE_LONG</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// BO对象 默认插入勾选</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">arraysContains</span><span class="token punctuation">(</span><span class="token class-name">GenConstants</span><span class="token punctuation">.</span><span class="token constant">COLUMNNAME_NOT_ADD</span><span class="token punctuation">,</span> columnName<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>column<span class="token punctuation">.</span><span class="token function">isPk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        column<span class="token punctuation">.</span><span class="token function">setIsInsert</span><span class="token punctuation">(</span><span class="token class-name">GenConstants</span><span class="token punctuation">.</span><span class="token constant">REQUIRE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// BO对象 默认编辑勾选</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">arraysContains</span><span class="token punctuation">(</span><span class="token class-name">GenConstants</span><span class="token punctuation">.</span><span class="token constant">COLUMNNAME_NOT_EDIT</span><span class="token punctuation">,</span> columnName<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        column<span class="token punctuation">.</span><span class="token function">setIsEdit</span><span class="token punctuation">(</span><span class="token class-name">GenConstants</span><span class="token punctuation">.</span><span class="token constant">REQUIRE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// BO对象 默认是否必填勾选</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">arraysContains</span><span class="token punctuation">(</span><span class="token class-name">GenConstants</span><span class="token punctuation">.</span><span class="token constant">COLUMNNAME_NOT_EDIT</span><span class="token punctuation">,</span> columnName<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        column<span class="token punctuation">.</span><span class="token function">setIsRequired</span><span class="token punctuation">(</span><span class="token class-name">GenConstants</span><span class="token punctuation">.</span><span class="token constant">REQUIRE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// VO对象 默认返回勾选</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">arraysContains</span><span class="token punctuation">(</span><span class="token class-name">GenConstants</span><span class="token punctuation">.</span><span class="token constant">COLUMNNAME_NOT_LIST</span><span class="token punctuation">,</span> columnName<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        column<span class="token punctuation">.</span><span class="token function">setIsList</span><span class="token punctuation">(</span><span class="token class-name">GenConstants</span><span class="token punctuation">.</span><span class="token constant">REQUIRE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// BO对象 默认查询勾选</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">arraysContains</span><span class="token punctuation">(</span><span class="token class-name">GenConstants</span><span class="token punctuation">.</span><span class="token constant">COLUMNNAME_NOT_QUERY</span><span class="token punctuation">,</span> columnName<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>column<span class="token punctuation">.</span><span class="token function">isPk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        column<span class="token punctuation">.</span><span class="token function">setIsQuery</span><span class="token punctuation">(</span><span class="token class-name">GenConstants</span><span class="token punctuation">.</span><span class="token constant">REQUIRE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 固有字段控制</span>
    <span class="token comment">// 查询字段类型</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">endsWithIgnoreCase</span><span class="token punctuation">(</span>columnName<span class="token punctuation">,</span> <span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        column<span class="token punctuation">.</span><span class="token function">setQueryType</span><span class="token punctuation">(</span><span class="token class-name">GenConstants</span><span class="token punctuation">.</span><span class="token constant">QUERY_LIKE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 状态字段设置单选框</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">endsWithIgnoreCase</span><span class="token punctuation">(</span>columnName<span class="token punctuation">,</span> <span class="token string">&quot;status&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        column<span class="token punctuation">.</span><span class="token function">setHtmlType</span><span class="token punctuation">(</span><span class="token class-name">GenConstants</span><span class="token punctuation">.</span><span class="token constant">HTML_RADIO</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 类型&amp;性别字段设置下拉框</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">endsWithIgnoreCase</span><span class="token punctuation">(</span>columnName<span class="token punctuation">,</span> <span class="token string">&quot;type&quot;</span><span class="token punctuation">)</span>
        <span class="token operator">||</span> <span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">endsWithIgnoreCase</span><span class="token punctuation">(</span>columnName<span class="token punctuation">,</span> <span class="token string">&quot;sex&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        column<span class="token punctuation">.</span><span class="token function">setHtmlType</span><span class="token punctuation">(</span><span class="token class-name">GenConstants</span><span class="token punctuation">.</span><span class="token constant">HTML_SELECT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 图片字段设置图片上传控件</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">endsWithIgnoreCase</span><span class="token punctuation">(</span>columnName<span class="token punctuation">,</span> <span class="token string">&quot;image&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        column<span class="token punctuation">.</span><span class="token function">setHtmlType</span><span class="token punctuation">(</span><span class="token class-name">GenConstants</span><span class="token punctuation">.</span><span class="token constant">HTML_IMAGE_UPLOAD</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 文件字段设置文件上传控件</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">endsWithIgnoreCase</span><span class="token punctuation">(</span>columnName<span class="token punctuation">,</span> <span class="token string">&quot;file&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        column<span class="token punctuation">.</span><span class="token function">setHtmlType</span><span class="token punctuation">(</span><span class="token class-name">GenConstants</span><span class="token punctuation">.</span><span class="token constant">HTML_FILE_UPLOAD</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 内容字段设置富文本控件</span>
    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">endsWithIgnoreCase</span><span class="token punctuation">(</span>columnName<span class="token punctuation">,</span> <span class="token string">&quot;content&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        column<span class="token punctuation">.</span><span class="token function">setHtmlType</span><span class="token punctuation">(</span><span class="token class-name">GenConstants</span><span class="token punctuation">.</span><span class="token constant">HTML_EDITOR</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></details> <p><strong>Xml 核心SQL代码</strong></p> <p>库表信息搜索后并初始化</p> <details class="custom-block details"><summary>点击展开</summary> <p><strong>获取表信息 , SQL执行语句 <em>GenTableMapper.selectDbTableListByNames()</em></strong> (该方法适配不同数据源应用 , 只需关注MySQL应用方式即可)</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>selectDbTableListByNames<span class="token punctuation">&quot;</span></span> <span class="token attr-name">resultMap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>GenTableResult<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@com.ruoyi.common.helper.DataBaseHelper@isMySql()<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        select table_name, table_comment, create_time, update_time from information_schema.tables
        where table_name NOT LIKE 'xxl_job_%' and table_name NOT LIKE 'gen_%' and table_schema = (select database())
        and table_name in
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>foreach</span> <span class="token attr-name">collection</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>array<span class="token punctuation">&quot;</span></span> <span class="token attr-name">item</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span> <span class="token attr-name">open</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>(<span class="token punctuation">&quot;</span></span> <span class="token attr-name">separator</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>,<span class="token punctuation">&quot;</span></span> <span class="token attr-name">close</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
             #{name}
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>foreach</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@com.ruoyi.common.helper.DataBaseHelper@isOracle()<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        select lower(dt.table_name) as table_name, dtc.comments as table_comment, uo.created as create_time, uo.last_ddl_time as update_time
        from user_tables dt, user_tab_comments dtc, user_objects uo
        where dt.table_name = dtc.table_name
        and dt.table_name = uo.object_name
        and uo.object_type = 'TABLE'
        AND dt.table_name NOT LIKE 'XXL_JOB_%' AND dt.table_name NOT LIKE 'GEN_%'
        AND dt.table_name NOT IN (select table_name from gen_table)
        and lower(dt.table_name) in
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>foreach</span> <span class="token attr-name">collection</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>array<span class="token punctuation">&quot;</span></span> <span class="token attr-name">item</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span> <span class="token attr-name">open</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>(<span class="token punctuation">&quot;</span></span> <span class="token attr-name">separator</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>,<span class="token punctuation">&quot;</span></span> <span class="token attr-name">close</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            #{name}
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>foreach</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@com.ruoyi.common.helper.DataBaseHelper@isPostgerSql()<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        select table_name, table_comment, create_time, update_time
        from (
            SELECT c.relname AS table_name,
                    obj_description(c.oid) AS table_comment,
                    CURRENT_TIMESTAMP AS create_time,
                    CURRENT_TIMESTAMP AS update_time
            FROM pg_class c
                LEFT JOIN pg_namespace n ON n.oid = c.relnamespace
            WHERE (c.relkind = ANY (ARRAY ['r'::&quot;char&quot;, 'p'::&quot;char&quot;]))
                AND c.relname != 'spatial_%'::text
                AND n.nspname = 'public'::name
                AND n.nspname <span class="token cdata">&lt;![CDATA[ &lt;&gt; ]]&gt;</span> ''::name
        ) list_table
        where table_name NOT LIKE 'xxl_job_%' and table_name NOT LIKE 'gen_%'
        and table_name in
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>foreach</span> <span class="token attr-name">collection</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>array<span class="token punctuation">&quot;</span></span> <span class="token attr-name">item</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span> <span class="token attr-name">open</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>(<span class="token punctuation">&quot;</span></span> <span class="token attr-name">separator</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>,<span class="token punctuation">&quot;</span></span> <span class="token attr-name">close</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            #{name}
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>foreach</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@com.ruoyi.common.helper.DataBaseHelper@isSqlServer()<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        SELECT cast(D.NAME as nvarchar) as table_name,
               cast(F.VALUE as nvarchar) as table_comment,
               crdate as create_time,
               refdate as update_time
        FROM SYSOBJECTS D
            INNER JOIN SYS.EXTENDED_PROPERTIES F ON D.ID = F.MAJOR_ID
                AND F.MINOR_ID = 0 AND D.XTYPE = 'U' AND D.NAME != 'DTPROPERTIES'
                AND D.NAME NOT LIKE 'xxl_job_%' AND D.NAME NOT LIKE 'gen_%'
                AND D.NAME in
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>foreach</span> <span class="token attr-name">collection</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>array<span class="token punctuation">&quot;</span></span> <span class="token attr-name">item</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span> <span class="token attr-name">open</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>(<span class="token punctuation">&quot;</span></span> <span class="token attr-name">separator</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>,<span class="token punctuation">&quot;</span></span> <span class="token attr-name">close</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            #{name}
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>foreach</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>实际执行SQL (用法和上面一样)</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
	table_name<span class="token punctuation">,</span>
	table_comment<span class="token punctuation">,</span>
	create_time<span class="token punctuation">,</span>
	update_time 
<span class="token keyword">FROM</span>
	information_schema<span class="token punctuation">.</span><span class="token keyword">TABLES</span> 
<span class="token keyword">WHERE</span>
	table_name <span class="token operator">NOT</span> <span class="token operator">LIKE</span> <span class="token string">'xxl_job_%'</span> 
	<span class="token operator">AND</span> table_name <span class="token operator">NOT</span> <span class="token operator">LIKE</span> <span class="token string">'gen_%'</span> 
	<span class="token operator">AND</span> table_schema <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token keyword">DATABASE</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
	<span class="token comment"># 多个表名逗号分隔</span>
	<span class="token operator">AND</span> table_name <span class="token operator">IN</span> <span class="token punctuation">(</span> <span class="token string">'tableName'</span> <span class="token punctuation">)</span>
</code></pre></div><p><strong>获取表字段信息 , SQL执行语句 <em>GenTableColumnMapper.selectDbTableColumnsByName()</em></strong></p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>selectDbTableColumnsByName<span class="token punctuation">&quot;</span></span> <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>String<span class="token punctuation">&quot;</span></span> <span class="token attr-name">resultMap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>GenTableColumnResult<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@com.ruoyi.common.helper.DataBaseHelper@isMySql()<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        select column_name,
               (case when (is_nullable = 'no' <span class="token cdata">&lt;![CDATA[ &amp;&amp; ]]&gt;</span> column_key != 'PRI') then '1' else '0' end) as is_required,
               (case when column_key = 'PRI' then '1' else '0' end) as is_pk,
               ordinal_position as sort,
               column_comment,
               (case when extra = 'auto_increment' then '1' else '0' end) as is_increment,
               column_type
        from information_schema.columns where table_schema = (select database()) and table_name = (#{tableName})
        order by ordinal_position
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@com.ruoyi.common.helper.DataBaseHelper@isOracle()<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        select lower(temp.column_name) as column_name,
                (case when (temp.nullable = 'N'  and  temp.constraint_type != 'P') then '1' else '0' end) as is_required,
                (case when temp.constraint_type = 'P' then '1' else '0' end) as is_pk,
                temp.column_id as sort,
                temp.comments as column_comment,
                (case when temp.constraint_type = 'P' then '1' else '0' end) as is_increment,
                lower(temp.data_type) as column_type
        from (
            select col.column_id, col.column_name,col.nullable, col.data_type, colc.comments, uc.constraint_type, row_number()
                over (partition by col.column_name order by uc.constraint_type desc) as row_flg
            from user_tab_columns col
            left join user_col_comments colc on colc.table_name = col.table_name and colc.column_name = col.column_name
            left join user_cons_columns ucc on ucc.table_name = col.table_name and ucc.column_name = col.column_name
            left join user_constraints uc on uc.constraint_name = ucc.constraint_name
            where col.table_name = upper(#{tableName})
        ) temp
        WHERE temp.row_flg = 1
        ORDER BY temp.column_id
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@com.ruoyi.common.helper.DataBaseHelper@isPostgerSql()<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        SELECT column_name, is_required, is_pk, sort, column_comment, is_increment, column_type
        FROM (
            SELECT c.relname AS table_name,
                   a.attname AS column_name,
                   d.description AS column_comment,
                   CASE WHEN a.attnotnull AND con.conname IS NULL THEN 1 ELSE 0
                   END AS is_required,
                   CASE WHEN con.conname IS NOT NULL THEN 1 ELSE 0
                   END AS is_pk,
                   a.attnum AS sort,
                   CASE WHEN &quot;position&quot;(pg_get_expr(ad.adbin, ad.adrelid),
                       ((c.relname::text || '_'::text) || a.attname::text) || '_seq'::text) &gt; 0 THEN 1 ELSE 0
                   END AS is_increment,
                   btrim(
                       CASE WHEN t.typelem <span class="token cdata">&lt;![CDATA[ &lt;&gt; ]]&gt;</span> 0::oid AND t.typlen = '-1'::integer THEN 'ARRAY'::text ELSE
                            CASE WHEN t.typtype = 'd'::&quot;char&quot; THEN format_type(t.typbasetype, NULL::integer)
                            ELSE format_type(a.atttypid, NULL::integer) END
                       END, '&quot;'::text
                   ) AS column_type
            FROM pg_attribute a
                JOIN (pg_class c JOIN pg_namespace n ON c.relnamespace = n.oid) ON a.attrelid = c.oid
                LEFT JOIN pg_description d ON d.objoid = c.oid AND a.attnum = d.objsubid
                LEFT JOIN pg_constraint con ON con.conrelid = c.oid AND (a.attnum = ANY (con.conkey))
                LEFT JOIN pg_attrdef ad ON a.attrelid = ad.adrelid AND a.attnum = ad.adnum
                LEFT JOIN pg_type t ON a.atttypid = t.oid
            WHERE (c.relkind = ANY (ARRAY ['r'::&quot;char&quot;, 'p'::&quot;char&quot;]))
                AND a.attnum &gt; 0
                AND n.nspname = 'public'::name
            ORDER BY c.relname, a.attnum
        ) temp
        WHERE table_name = (#{tableName})
            AND column_type <span class="token cdata">&lt;![CDATA[ &lt;&gt; ]]&gt;</span> '-'
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>@com.ruoyi.common.helper.DataBaseHelper@isSqlServer()<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        SELECT
            cast(A.NAME as nvarchar) as column_name,
            cast(B.NAME as nvarchar) + (case when B.NAME = 'numeric' then '(' + cast(A.prec as nvarchar) + ',' + cast(A.scale as nvarchar) + ')' else '' end) as column_type,
            cast(G.[VALUE] as nvarchar) as column_comment,
            (SELECT 1 FROM INFORMATION_SCHEMA.KEY_COLUMN_USAGE Z WHERE TABLE_NAME = D.NAME and A.NAME = Z.column_name  ) as is_pk,
            colorder as sort
        FROM SYSCOLUMNS A
            LEFT JOIN SYSTYPES B ON A.XTYPE = B.XUSERTYPE
            INNER JOIN SYSOBJECTS D ON A.ID = D.ID AND D.XTYPE='U' AND D.NAME != 'DTPROPERTIES'
            LEFT JOIN SYS.EXTENDED_PROPERTIES G ON A.ID = G.MAJOR_ID AND A.COLID = G.MINOR_ID
            LEFT JOIN SYS.EXTENDED_PROPERTIES F ON D.ID = F.MAJOR_ID AND F.MINOR_ID = 0
        WHERE D.NAME = #{tableName}
        ORDER BY A.COLORDER
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>实际执行SQL</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">SELECT</span>
	column_name<span class="token punctuation">,</span>
	<span class="token comment"># 判断列是否必要的 (为空并且不是主键)</span>
	<span class="token punctuation">(</span> <span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> <span class="token punctuation">(</span> is_nullable <span class="token operator">=</span> <span class="token string">'no'</span> <span class="token operator">&amp;&amp;</span> column_key <span class="token operator">!=</span> <span class="token string">'PRI'</span> <span class="token punctuation">)</span> <span class="token keyword">THEN</span> <span class="token string">'1'</span> <span class="token keyword">ELSE</span> <span class="token string">'0'</span> <span class="token keyword">END</span> <span class="token punctuation">)</span> <span class="token keyword">AS</span> is_required<span class="token punctuation">,</span>
	<span class="token comment"># 判断是否为主键</span>
	<span class="token punctuation">(</span> <span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> column_key <span class="token operator">=</span> <span class="token string">'PRI'</span> <span class="token keyword">THEN</span> <span class="token string">'1'</span> <span class="token keyword">ELSE</span> <span class="token string">'0'</span> <span class="token keyword">END</span> <span class="token punctuation">)</span> <span class="token keyword">AS</span> is_pk<span class="token punctuation">,</span>
	ordinal_position <span class="token keyword">AS</span> sort<span class="token punctuation">,</span>
	column_comment<span class="token punctuation">,</span>
	<span class="token comment"># 判断是否自增</span>
	<span class="token punctuation">(</span> <span class="token keyword">CASE</span> <span class="token keyword">WHEN</span> extra <span class="token operator">=</span> <span class="token string">'auto_increment'</span> <span class="token keyword">THEN</span> <span class="token string">'1'</span> <span class="token keyword">ELSE</span> <span class="token string">'0'</span> <span class="token keyword">END</span> <span class="token punctuation">)</span> <span class="token keyword">AS</span> is_increment<span class="token punctuation">,</span>
	column_type 
<span class="token keyword">FROM</span>
	information_schema<span class="token punctuation">.</span><span class="token keyword">COLUMNS</span> 
<span class="token keyword">WHERE</span>
	table_schema <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">SELECT</span> <span class="token keyword">DATABASE</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
	<span class="token operator">AND</span> table_name <span class="token operator">=</span> <span class="token punctuation">(</span> <span class="token string">'paper_test'</span> <span class="token punctuation">)</span> 
<span class="token keyword">ORDER</span> <span class="token keyword">BY</span>
	ordinal_position
</code></pre></div></details> <h3 id="详细生成表"><a href="#详细生成表" class="header-anchor">#</a> 详细生成表</h3> <p>修改时需要单表的相关详细数据</p> <p><strong>获取库表基础信息 <em>GenController#getInfo()</em></strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@SaCheckPermission</span><span class="token punctuation">(</span><span class="token string">&quot;tool:gen:query&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;/{tableId}&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">R</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Map</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">getInfo</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> <span class="token class-name">Long</span> tableId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">GenTable</span> table <span class="token operator">=</span> genTableService<span class="token punctuation">.</span><span class="token function">selectGenTableById</span><span class="token punctuation">(</span>tableId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">GenTable</span><span class="token punctuation">&gt;</span></span> tables <span class="token operator">=</span> genTableService<span class="token punctuation">.</span><span class="token function">selectGenTableAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 左查询 gen_column</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">GenTableColumn</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> genTableService<span class="token punctuation">.</span><span class="token function">selectGenTableColumnListByTableId</span><span class="token punctuation">(</span>tableId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 当前表详细</span>
    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;info&quot;</span><span class="token punctuation">,</span> table<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 当前表字段信息</span>
    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;rows&quot;</span><span class="token punctuation">,</span> list<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 所有表信息 , 关联表设置别用 (目前尚未开放可以无视)</span>
    map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;tables&quot;</span><span class="token punctuation">,</span> tables<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="修改生成表"><a href="#修改生成表" class="header-anchor">#</a> 修改生成表</h3> <p><strong>修改表信息接口 <em>GenController#editSave()</em></strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@SaCheckPermission</span><span class="token punctuation">(</span><span class="token string">&quot;tool:gen:edit&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Log</span><span class="token punctuation">(</span>title <span class="token operator">=</span> <span class="token string">&quot;代码生成&quot;</span><span class="token punctuation">,</span> businessType <span class="token operator">=</span> <span class="token class-name">BusinessType</span><span class="token punctuation">.</span><span class="token constant">UPDATE</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@PutMapping</span>
<span class="token keyword">public</span> <span class="token class-name">R</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> <span class="token function">editSave</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Validated</span> <span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">GenTable</span> genTable<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 校验数据</span>
    genTableService<span class="token punctuation">.</span><span class="token function">validateEdit</span><span class="token punctuation">(</span>genTable<span class="token punctuation">)</span><span class="token punctuation">;</span>
    genTableService<span class="token punctuation">.</span><span class="token function">updateGenTable</span><span class="token punctuation">(</span>genTable<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>修改实现 <em>GenTableServiceImpl#updateGenTable()</em></strong></p> <div class="language-java extra-class"><div class="highlight-lines"><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><div class="highlighted"> </div><br><br><br><br></div><pre class="language-java"><code><span class="token annotation punctuation">@Transactional</span><span class="token punctuation">(</span>rollbackFor <span class="token operator">=</span> <span class="token class-name">Exception</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">updateGenTable</span><span class="token punctuation">(</span><span class="token class-name">GenTable</span> genTable<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> options <span class="token operator">=</span> <span class="token class-name">JsonUtils</span><span class="token punctuation">.</span><span class="token function">toJsonString</span><span class="token punctuation">(</span>genTable<span class="token punctuation">.</span><span class="token function">getParams</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    genTable<span class="token punctuation">.</span><span class="token function">setOptions</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 保存修改表信息</span>
    <span class="token keyword">int</span> row <span class="token operator">=</span> baseMapper<span class="token punctuation">.</span><span class="token function">updateById</span><span class="token punctuation">(</span>genTable<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 保存修改列信息</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>row <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">GenTableColumn</span> cenTableColumn <span class="token operator">:</span> genTable<span class="token punctuation">.</span><span class="token function">getColumns</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            genTableColumnMapper<span class="token punctuation">.</span><span class="token function">updateById</span><span class="token punctuation">(</span>cenTableColumn<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="生成预览"><a href="#生成预览" class="header-anchor">#</a> 生成预览</h3> <p><strong>预览接口 <em>GenController#preview()</em></strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@SaCheckPermission</span><span class="token punctuation">(</span><span class="token string">&quot;tool:gen:preview&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/preview/{tableId}&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">R</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Map</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">preview</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">&quot;tableId&quot;</span><span class="token punctuation">)</span> <span class="token class-name">Long</span> tableId<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> dataMap <span class="token operator">=</span> genTableService<span class="token punctuation">.</span><span class="token function">previewCode</span><span class="token punctuation">(</span>tableId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span>dataMap<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>导出具体实现 <em>GenTableServiceImpl#previewCode()</em></strong></p> <p>具体填充的数据 , <a href="#">点击跳转</a></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">previewCode</span><span class="token punctuation">(</span><span class="token class-name">Long</span> tableId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> dataMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">LinkedHashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 查询表信息</span>
    <span class="token class-name">GenTable</span> table <span class="token operator">=</span> baseMapper<span class="token punctuation">.</span><span class="token function">selectGenTableById</span><span class="token punctuation">(</span>tableId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> menuIds <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 计算雪花id为生成SQL语句准备的</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">6</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        menuIds<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>identifierGenerator<span class="token punctuation">.</span><span class="token function">nextId</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">longValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    table<span class="token punctuation">.</span><span class="token function">setMenuIds</span><span class="token punctuation">(</span>menuIds<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 设置主子表信息 (在库获取设置)</span>
    <span class="token function">setSubTable</span><span class="token punctuation">(</span>table<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 设置主键列信息</span>
    <span class="token function">setPkColumn</span><span class="token punctuation">(</span>table<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 初始化 .vm解析</span>
    <span class="token class-name">VelocityInitializer</span><span class="token punctuation">.</span><span class="token function">initVelocity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 构建模板上下文(填充数据)</span>
    <span class="token class-name">VelocityContext</span> context <span class="token operator">=</span> <span class="token class-name">VelocityUtils</span><span class="token punctuation">.</span><span class="token function">prepareContext</span><span class="token punctuation">(</span>table<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 获取模板列表</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> templates <span class="token operator">=</span> <span class="token class-name">VelocityUtils</span><span class="token punctuation">.</span><span class="token function">getTemplateList</span><span class="token punctuation">(</span>table<span class="token punctuation">.</span><span class="token function">getTplCategory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> template <span class="token operator">:</span> templates<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 渲染模板</span>
        <span class="token class-name">StringWriter</span> sw <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Template</span> tpl <span class="token operator">=</span> <span class="token class-name">Velocity</span><span class="token punctuation">.</span><span class="token function">getTemplate</span><span class="token punctuation">(</span>template<span class="token punctuation">,</span> <span class="token class-name">Constants</span><span class="token punctuation">.</span><span class="token constant">UTF8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        tpl<span class="token punctuation">.</span><span class="token function">merge</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> sw<span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>template<span class="token punctuation">,</span> sw<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> dataMap<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="生成代码"><a href="#生成代码" class="header-anchor">#</a> 生成代码</h3> <p>生成方式有两种</p> <ul><li>下载zip (推荐)</li> <li>自定义路径生成</li></ul> <h4 id="下载zip"><a href="#下载zip" class="header-anchor">#</a> 下载zip</h4> <p><strong>zip下载接口 <em>GenController#download()</em></strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@SaCheckPermission</span><span class="token punctuation">(</span><span class="token string">&quot;tool:gen:code&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Log</span><span class="token punctuation">(</span>title <span class="token operator">=</span> <span class="token string">&quot;代码生成&quot;</span><span class="token punctuation">,</span> businessType <span class="token operator">=</span> <span class="token class-name">BusinessType</span><span class="token punctuation">.</span><span class="token constant">GENCODE</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/download/{tableName}&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">download</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">&quot;tableName&quot;</span><span class="token punctuation">)</span> <span class="token class-name">String</span> tableName<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    <span class="token comment">// 压缩包流</span>
    <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> data <span class="token operator">=</span> genTableService<span class="token punctuation">.</span><span class="token function">downloadCode</span><span class="token punctuation">(</span>tableName<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">genCode</span><span class="token punctuation">(</span>response<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// ... </span>

<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">genCode</span><span class="token punctuation">(</span><span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> data<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span> <span class="token punctuation">{</span>
    response<span class="token punctuation">.</span><span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    response<span class="token punctuation">.</span><span class="token function">addHeader</span><span class="token punctuation">(</span><span class="token string">&quot;Access-Control-Allow-Origin&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    response<span class="token punctuation">.</span><span class="token function">addHeader</span><span class="token punctuation">(</span><span class="token string">&quot;Access-Control-Expose-Headers&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Content-Disposition&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    response<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Disposition&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;attachment; filename=\&quot;ruoyi.zip\&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    response<span class="token punctuation">.</span><span class="token function">addHeader</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Length&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span> <span class="token operator">+</span> data<span class="token punctuation">.</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>
    response<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">&quot;application/octet-stream; charset=UTF-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">IoUtil</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">getOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>业务下载接口 <em>GenTableServiceImpl#downloadCode()</em></strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">downloadCode</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> tableNames<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">ByteArrayOutputStream</span> outputStream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ByteArrayOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">ZipOutputStream</span> zip <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ZipOutputStream</span><span class="token punctuation">(</span>outputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> tableName <span class="token operator">:</span> tableNames<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">generatorCode</span><span class="token punctuation">(</span>tableName<span class="token punctuation">,</span> zip<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token class-name">IoUtil</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span>zip<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> outputStream<span class="token punctuation">.</span><span class="token function">toByteArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// ...</span>

<span class="token comment">// 和生成预览使用方式一样 , 该方法是将代码写入压缩流</span>
<span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">generatorCode</span><span class="token punctuation">(</span><span class="token class-name">String</span> tableName<span class="token punctuation">,</span> <span class="token class-name">ZipOutputStream</span> zip<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 查询表信息</span>
    <span class="token class-name">GenTable</span> table <span class="token operator">=</span> baseMapper<span class="token punctuation">.</span><span class="token function">selectGenTableByName</span><span class="token punctuation">(</span>tableName<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> menuIds <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">6</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        menuIds<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>identifierGenerator<span class="token punctuation">.</span><span class="token function">nextId</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">longValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    table<span class="token punctuation">.</span><span class="token function">setMenuIds</span><span class="token punctuation">(</span>menuIds<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 设置主子表信息</span>
    <span class="token function">setSubTable</span><span class="token punctuation">(</span>table<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 设置主键列信息</span>
    <span class="token function">setPkColumn</span><span class="token punctuation">(</span>table<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 初始化 .vm解析</span>
    <span class="token class-name">VelocityInitializer</span><span class="token punctuation">.</span><span class="token function">initVelocity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 构建模板上下文(填充数据)</span>
    <span class="token class-name">VelocityContext</span> context <span class="token operator">=</span> <span class="token class-name">VelocityUtils</span><span class="token punctuation">.</span><span class="token function">prepareContext</span><span class="token punctuation">(</span>table<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 获取模板列表</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> templates <span class="token operator">=</span> <span class="token class-name">VelocityUtils</span><span class="token punctuation">.</span><span class="token function">getTemplateList</span><span class="token punctuation">(</span>table<span class="token punctuation">.</span><span class="token function">getTplCategory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> template <span class="token operator">:</span> templates<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 渲染模板</span>
        <span class="token class-name">StringWriter</span> sw <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Template</span> tpl <span class="token operator">=</span> <span class="token class-name">Velocity</span><span class="token punctuation">.</span><span class="token function">getTemplate</span><span class="token punctuation">(</span>template<span class="token punctuation">,</span> <span class="token class-name">Constants</span><span class="token punctuation">.</span><span class="token constant">UTF8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        tpl<span class="token punctuation">.</span><span class="token function">merge</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> sw<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">// 添加到zip</span>
            zip<span class="token punctuation">.</span><span class="token function">putNextEntry</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ZipEntry</span><span class="token punctuation">(</span><span class="token class-name">VelocityUtils</span><span class="token punctuation">.</span><span class="token function">getFileName</span><span class="token punctuation">(</span>template<span class="token punctuation">,</span> table<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">IoUtil</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>zip<span class="token punctuation">,</span> <span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span><span class="token constant">UTF_8</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> sw<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">IoUtil</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span>sw<span class="token punctuation">)</span><span class="token punctuation">;</span>
            zip<span class="token punctuation">.</span><span class="token function">flush</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            zip<span class="token punctuation">.</span><span class="token function">closeEntry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;渲染模板失败，表名：&quot;</span> <span class="token operator">+</span> table<span class="token punctuation">.</span><span class="token function">getTableName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="自定义路径生成"><a href="#自定义路径生成" class="header-anchor">#</a> 自定义路径生成</h4> <p><strong>自定义路径 <em>GenController#genCode()</em></strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@SaCheckPermission</span><span class="token punctuation">(</span><span class="token string">&quot;tool:gen:code&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Log</span><span class="token punctuation">(</span>title <span class="token operator">=</span> <span class="token string">&quot;代码生成&quot;</span><span class="token punctuation">,</span> businessType <span class="token operator">=</span> <span class="token class-name">BusinessType</span><span class="token punctuation">.</span><span class="token constant">GENCODE</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/genCode/{tableName}&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">R</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> <span class="token function">genCode</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">&quot;tableName&quot;</span><span class="token punctuation">)</span> <span class="token class-name">String</span> tableName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    genTableService<span class="token punctuation">.</span><span class="token function">generatorCode</span><span class="token punctuation">(</span>tableName<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>业务下载接口 <em>GenTableServiceImpl#downloadCode()</em></strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">generatorCode</span><span class="token punctuation">(</span><span class="token class-name">String</span> tableName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 查询表信息</span>
    <span class="token class-name">GenTable</span> table <span class="token operator">=</span> baseMapper<span class="token punctuation">.</span><span class="token function">selectGenTableByName</span><span class="token punctuation">(</span>tableName<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 设置主子表信息</span>
    <span class="token function">setSubTable</span><span class="token punctuation">(</span>table<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 设置主键列信息</span>
    <span class="token function">setPkColumn</span><span class="token punctuation">(</span>table<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 初始化 .vm解析</span>
    <span class="token class-name">VelocityInitializer</span><span class="token punctuation">.</span><span class="token function">initVelocity</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 构建模板上下文(填充数据)</span>
    <span class="token class-name">VelocityContext</span> context <span class="token operator">=</span> <span class="token class-name">VelocityUtils</span><span class="token punctuation">.</span><span class="token function">prepareContext</span><span class="token punctuation">(</span>table<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 获取模板列表</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> templates <span class="token operator">=</span> <span class="token class-name">VelocityUtils</span><span class="token punctuation">.</span><span class="token function">getTemplateList</span><span class="token punctuation">(</span>table<span class="token punctuation">.</span><span class="token function">getTplCategory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> template <span class="token operator">:</span> templates<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 排除前端相关代码</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">containsAny</span><span class="token punctuation">(</span>template<span class="token punctuation">,</span> <span class="token string">&quot;sql.vm&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;api.js.vm&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;index.vue.vm&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;index-tree.vue.vm&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 渲染模板</span>
            <span class="token class-name">StringWriter</span> sw <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Template</span> tpl <span class="token operator">=</span> <span class="token class-name">Velocity</span><span class="token punctuation">.</span><span class="token function">getTemplate</span><span class="token punctuation">(</span>template<span class="token punctuation">,</span> <span class="token class-name">Constants</span><span class="token punctuation">.</span><span class="token constant">UTF8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            tpl<span class="token punctuation">.</span><span class="token function">merge</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> sw<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token comment">// 获取自定义目录</span>
                <span class="token class-name">String</span> path <span class="token operator">=</span> <span class="token function">getGenPath</span><span class="token punctuation">(</span>table<span class="token punctuation">,</span> template<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// 写入自定义目录的文件中</span>
                <span class="token class-name">FileUtils</span><span class="token punctuation">.</span><span class="token function">writeUtf8String</span><span class="token punctuation">(</span>sw<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> path<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ServiceException</span><span class="token punctuation">(</span><span class="token string">&quot;渲染模板失败，表名：&quot;</span> <span class="token operator">+</span> table<span class="token punctuation">.</span><span class="token function">getTableName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// ...</span>

<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">getGenPath</span><span class="token punctuation">(</span><span class="token class-name">GenTable</span> table<span class="token punctuation">,</span> <span class="token class-name">String</span> template<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> genPath <span class="token operator">=</span> table<span class="token punctuation">.</span><span class="token function">getGenPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>genPath<span class="token punctuation">,</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">&quot;user.dir&quot;</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token class-name">File</span><span class="token punctuation">.</span>separator <span class="token operator">+</span> <span class="token string">&quot;src&quot;</span> <span class="token operator">+</span> <span class="token class-name">File</span><span class="token punctuation">.</span>separator <span class="token operator">+</span> <span class="token class-name">VelocityUtils</span><span class="token punctuation">.</span><span class="token function">getFileName</span><span class="token punctuation">(</span>template<span class="token punctuation">,</span> table<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> genPath <span class="token operator">+</span> <span class="token class-name">File</span><span class="token punctuation">.</span>separator <span class="token operator">+</span> <span class="token class-name">VelocityUtils</span><span class="token punctuation">.</span><span class="token function">getFileName</span><span class="token punctuation">(</span>template<span class="token punctuation">,</span> table<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="同步生成表"><a href="#同步生成表" class="header-anchor">#</a> 同步生成表</h3> <p><strong>同步接口 <em>GenController#synchDb()</em></strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@SaCheckPermission</span><span class="token punctuation">(</span><span class="token string">&quot;tool:gen:edit&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Log</span><span class="token punctuation">(</span>title <span class="token operator">=</span> <span class="token string">&quot;代码生成&quot;</span><span class="token punctuation">,</span> businessType <span class="token operator">=</span> <span class="token class-name">BusinessType</span><span class="token punctuation">.</span><span class="token constant">UPDATE</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/synchDb/{tableName}&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">R</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Void</span><span class="token punctuation">&gt;</span></span> <span class="token function">synchDb</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span><span class="token punctuation">(</span><span class="token string">&quot;tableName&quot;</span><span class="token punctuation">)</span> <span class="token class-name">String</span> tableName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    genTableService<span class="token punctuation">.</span><span class="token function">synchDb</span><span class="token punctuation">(</span>tableName<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>业务实现 <em>GenTableServiceImpl#synchDb()</em></strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">synchDb</span><span class="token punctuation">(</span><span class="token class-name">String</span> tableName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">GenTable</span> table <span class="token operator">=</span> baseMapper<span class="token punctuation">.</span><span class="token function">selectGenTableByName</span><span class="token punctuation">(</span>tableName<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">GenTableColumn</span><span class="token punctuation">&gt;</span></span> tableColumns <span class="token operator">=</span> table<span class="token punctuation">.</span><span class="token function">getColumns</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Map转化 , key 为 column_name</span>
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">GenTableColumn</span><span class="token punctuation">&gt;</span></span> tableColumnMap <span class="token operator">=</span> <span class="token class-name">StreamUtils</span><span class="token punctuation">.</span><span class="token function">toIdentityMap</span><span class="token punctuation">(</span>tableColumns<span class="token punctuation">,</span> <span class="token class-name">GenTableColumn</span><span class="token operator">::</span><span class="token function">getColumnName</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 查库判断存在</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">GenTableColumn</span><span class="token punctuation">&gt;</span></span> dbTableColumns <span class="token operator">=</span> genTableColumnMapper<span class="token punctuation">.</span><span class="token function">selectDbTableColumnsByName</span><span class="token punctuation">(</span>tableName<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">CollUtil</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>dbTableColumns<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ServiceException</span><span class="token punctuation">(</span><span class="token string">&quot;同步数据失败，原表结构不存在&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 拿到表中的所有字段名</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> dbTableColumnNames <span class="token operator">=</span> <span class="token class-name">StreamUtils</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span>dbTableColumns<span class="token punctuation">,</span> <span class="token class-name">GenTableColumn</span><span class="token operator">::</span><span class="token function">getColumnName</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">GenTableColumn</span><span class="token punctuation">&gt;</span></span> saveColumns <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    dbTableColumns<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>column <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// 初始化字段</span>
        <span class="token class-name">GenUtils</span><span class="token punctuation">.</span><span class="token function">initColumnField</span><span class="token punctuation">(</span>column<span class="token punctuation">,</span> table<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// Map匹配存在字段 (保留原表信息操作)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>tableColumnMap<span class="token punctuation">.</span><span class="token function">containsKey</span><span class="token punctuation">(</span>column<span class="token punctuation">.</span><span class="token function">getColumnName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">GenTableColumn</span> prevColumn <span class="token operator">=</span> tableColumnMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>column<span class="token punctuation">.</span><span class="token function">getColumnName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            column<span class="token punctuation">.</span><span class="token function">setColumnId</span><span class="token punctuation">(</span>prevColumn<span class="token punctuation">.</span><span class="token function">getColumnId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>column<span class="token punctuation">.</span><span class="token function">isList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// 如果是列表，继续保留查询方式/字典类型选项</span>
                column<span class="token punctuation">.</span><span class="token function">setDictType</span><span class="token punctuation">(</span>prevColumn<span class="token punctuation">.</span><span class="token function">getDictType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                column<span class="token punctuation">.</span><span class="token function">setQueryType</span><span class="token punctuation">(</span>prevColumn<span class="token punctuation">.</span><span class="token function">getQueryType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// 如果列是必填且非忽略及父属性，并且在新增/修改中，且是非主键列，则保留之前的必填/显示类型选项</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isNotEmpty</span><span class="token punctuation">(</span>prevColumn<span class="token punctuation">.</span><span class="token function">getIsRequired</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>column<span class="token punctuation">.</span><span class="token function">isPk</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>column<span class="token punctuation">.</span><span class="token function">isInsert</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">||</span> column<span class="token punctuation">.</span><span class="token function">isEdit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>column<span class="token punctuation">.</span><span class="token function">isUsableColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span><span class="token operator">!</span>column<span class="token punctuation">.</span><span class="token function">isSuperColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// 如果是(新增/修改&amp;非主键/非忽略及父属性)，继续保留必填/显示类型选项</span>
                column<span class="token punctuation">.</span><span class="token function">setIsRequired</span><span class="token punctuation">(</span>prevColumn<span class="token punctuation">.</span><span class="token function">getIsRequired</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                column<span class="token punctuation">.</span><span class="token function">setHtmlType</span><span class="token punctuation">(</span>prevColumn<span class="token punctuation">.</span><span class="token function">getHtmlType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        saveColumns<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>column<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">CollUtil</span><span class="token punctuation">.</span><span class="token function">isNotEmpty</span><span class="token punctuation">(</span>saveColumns<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 批量更新</span>
        genTableColumnMapper<span class="token punctuation">.</span><span class="token function">insertOrUpdateBatch</span><span class="token punctuation">(</span>saveColumns<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 删除多余的字段 (将新表不包含的字段进行删除)</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">GenTableColumn</span><span class="token punctuation">&gt;</span></span> delColumns <span class="token operator">=</span> <span class="token class-name">StreamUtils</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>tableColumns<span class="token punctuation">,</span> column <span class="token operator">-&gt;</span>
        <span class="token operator">!</span>dbTableColumnNames<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>column<span class="token punctuation">.</span><span class="token function">getColumnName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">CollUtil</span><span class="token punctuation">.</span><span class="token function">isNotEmpty</span><span class="token punctuation">(</span>delColumns<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> ids <span class="token operator">=</span> <span class="token class-name">StreamUtils</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span>delColumns<span class="token punctuation">,</span> <span class="token class-name">GenTableColumn</span><span class="token operator">::</span><span class="token function">getColumnId</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        genTableColumnMapper<span class="token punctuation">.</span><span class="token function">deleteBatchIds</span><span class="token punctuation">(</span>ids<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="上下文参数-模板"><a href="#上下文参数-模板" class="header-anchor">#</a> 上下文参数&amp;模板</h2> <p>模板仅在代码当中注释补充展示</p> <h3 id="上下文参数"><a href="#上下文参数" class="header-anchor">#</a> 上下文参数</h3> <p><strong>通用上下文参数</strong></p> <table><thead><tr><th style="text-align:center;">上下文参数</th> <th style="text-align:center;">说明</th></tr></thead> <tbody><tr><td style="text-align:center;">author</td> <td style="text-align:center;">作者名</td></tr> <tr><td style="text-align:center;">BusinessName</td> <td style="text-align:center;">生成业务名 , 驼峰处理</td></tr> <tr><td style="text-align:center;">businessName</td> <td style="text-align:center;">生成业务名 , 无驼峰</td></tr> <tr><td style="text-align:center;">basePackage</td> <td style="text-align:center;">包前缀</td></tr> <tr><td style="text-align:center;">ClassName</td> <td style="text-align:center;">类名 , 驼峰处理</td></tr> <tr><td style="text-align:center;">className</td> <td style="text-align:center;">类名 , 无驼峰</td></tr> <tr><td style="text-align:center;">columns</td> <td style="text-align:center;">表所有列字段</td></tr> <tr><td style="text-align:center;">dicts</td> <td style="text-align:center;">字典组 (包含有下拉框 , 单选框 , 复选框和字典名)</td></tr> <tr><td style="text-align:center;">datetime</td> <td style="text-align:center;">生成时间</td></tr> <tr><td style="text-align:center;">functionName</td> <td style="text-align:center;">模块描述 , 功能名</td></tr> <tr><td style="text-align:center;">importList</td> <td style="text-align:center;">外部引列列表</td></tr> <tr><td style="text-align:center;">moduleName</td> <td style="text-align:center;">模块名</td></tr> <tr><td style="text-align:center;">packageName</td> <td style="text-align:center;">包路径</td></tr> <tr><td style="text-align:center;">permissionPrefix</td> <td style="text-align:center;">权限前缀标识 (模块名:业务名)</td></tr> <tr><td style="text-align:center;">pkColumn</td> <td style="text-align:center;">主键字段对象</td></tr> <tr><td style="text-align:center;">tplCategory</td> <td style="text-align:center;">模板类型 (单表 , 树表 , sub主子表)</td></tr> <tr><td style="text-align:center;">table</td> <td style="text-align:center;">表对象</td></tr> <tr><td style="text-align:center;">tableName</td> <td style="text-align:center;">表名</td></tr></tbody></table> <h3 id="java模板"><a href="#java模板" class="header-anchor">#</a> Java模板</h3> <p><strong>实体对象 <em>vm/java/domain.java.vm</em></strong></p> <details class="custom-block details"><summary>点击展开</summary> <div class="language-velocity extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br></div><pre class="language-velocity"><code>package <span class="token variable">$<span class="token punctuation">{</span>packageName<span class="token punctuation">}</span></span>.domain;

import com.baomidou.mybatisplus.annotation.*;
import lombok.Data;
import lombok.EqualsAndHashCode;
import java.io.Serializable;
import java.util.Date;
import java.math.BigDecimal;

<span class="token directive"><span class="token keyword">#foreach</span> <span class="token punctuation">(</span><span class="token variable">$import</span> <span class="token keyword">in</span> <span class="token variable">$importList</span><span class="token punctuation">)</span></span>
import <span class="token variable">$<span class="token punctuation">{</span>import<span class="token punctuation">}</span></span>;
<span class="token directive"><span class="token keyword">#end</span></span>
<span class="token directive"><span class="token keyword">#if</span><span class="token punctuation">(</span><span class="token variable">$table<span class="token punctuation">.</span>crud</span> <span class="token operator">||</span> <span class="token variable">$table<span class="token punctuation">.</span>sub</span><span class="token punctuation">)</span></span>
import com.ruoyi.common.core.domain.BaseEntity;
<span class="token directive"><span class="token keyword">#elseif</span><span class="token punctuation">(</span><span class="token variable">$table<span class="token punctuation">.</span>tree</span><span class="token punctuation">)</span></span>
import com.ruoyi.common.core.domain.TreeEntity;
<span class="token directive"><span class="token keyword">#end</span></span>

/**
 * <span class="token variable">$<span class="token punctuation">{</span>functionName<span class="token punctuation">}</span></span>对象 <span class="token variable">$<span class="token punctuation">{</span>tableName<span class="token punctuation">}</span></span>
 *
 * @author <span class="token variable">$<span class="token punctuation">{</span>author<span class="token punctuation">}</span></span>
 * @date <span class="token variable">$<span class="token punctuation">{</span>datetime<span class="token punctuation">}</span></span>
 */
<span class="token directive"><span class="token keyword">#if</span><span class="token punctuation">(</span><span class="token variable">$table<span class="token punctuation">.</span>crud</span> <span class="token operator">||</span> <span class="token variable">$table<span class="token punctuation">.</span>sub</span><span class="token punctuation">)</span></span>
    <span class="token directive"><span class="token keyword">#set</span><span class="token punctuation">(</span><span class="token variable">$Entity</span><span class="token operator">=</span><span class="token string">&quot;BaseEntity&quot;</span><span class="token punctuation">)</span></span>
<span class="token directive"><span class="token keyword">#elseif</span><span class="token punctuation">(</span><span class="token variable">$table<span class="token punctuation">.</span>tree</span><span class="token punctuation">)</span></span>
    <span class="token directive"><span class="token keyword">#set</span><span class="token punctuation">(</span><span class="token variable">$Entity</span><span class="token operator">=</span><span class="token string">&quot;TreeEntity&lt;${ClassName}&gt;&quot;</span><span class="token punctuation">)</span></span>
<span class="token directive"><span class="token keyword">#end</span></span>
@Data
@EqualsAndHashCode(callSuper = true)
@TableName(&quot;<span class="token variable">$<span class="token punctuation">{</span>tableName<span class="token punctuation">}</span></span>&quot;)
public class <span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span> extends <span class="token variable">$<span class="token punctuation">{</span>Entity<span class="token punctuation">}</span></span> {

    private static final long serialVersionUID=1L;

<span class="token directive"><span class="token keyword">#foreach</span> <span class="token punctuation">(</span><span class="token variable">$column</span> <span class="token keyword">in</span> <span class="token variable">$columns</span><span class="token punctuation">)</span></span>
<span class="token velocity-comment comment">## 方法排除基类Entity字段</span>
<span class="token directive"><span class="token keyword">#if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$table<span class="token punctuation">.</span><span class="token function">isSuperColumn</span><span class="token punctuation">(</span>$column<span class="token punctuation">.</span>javaField<span class="token punctuation">)</span></span><span class="token punctuation">)</span></span>
    /**
     * <span class="token variable">$column<span class="token punctuation">.</span>columnComment</span>
     */
<span class="token velocity-comment comment">## 根据属性标识添加注解</span>
<span class="token directive"><span class="token keyword">#if</span><span class="token punctuation">(</span><span class="token variable">$column<span class="token punctuation">.</span>javaField</span><span class="token operator">==</span><span class="token string">'delFlag'</span><span class="token punctuation">)</span></span>
    @TableLogic
<span class="token directive"><span class="token keyword">#end</span></span>
<span class="token directive"><span class="token keyword">#if</span><span class="token punctuation">(</span><span class="token variable">$column<span class="token punctuation">.</span>javaField</span><span class="token operator">==</span><span class="token string">'version'</span><span class="token punctuation">)</span></span>
    @Version
<span class="token directive"><span class="token keyword">#end</span></span>
<span class="token directive"><span class="token keyword">#if</span><span class="token punctuation">(</span><span class="token variable">$column<span class="token punctuation">.</span>pk</span><span class="token punctuation">)</span></span>
    @TableId(value = &quot;<span class="token variable">$column<span class="token punctuation">.</span>columnName</span>&quot;)
<span class="token directive"><span class="token keyword">#end</span></span>
    private <span class="token variable">$column<span class="token punctuation">.</span>javaType</span> <span class="token variable">$column<span class="token punctuation">.</span>javaField</span>;
<span class="token directive"><span class="token keyword">#end</span></span>
<span class="token directive"><span class="token keyword">#end</span></span>

}
</code></pre></div></details> <p><strong>请求响应类 <em>vm/java/vo.java.vm</em></strong></p> <details class="custom-block details"><summary>点击展开</summary> <div class="language-velocity extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><br><br></div><pre class="language-velocity"><code>package <span class="token variable">$<span class="token punctuation">{</span>packageName<span class="token punctuation">}</span></span>.domain.vo;

<span class="token directive"><span class="token keyword">#foreach</span> <span class="token punctuation">(</span><span class="token variable">$import</span> <span class="token keyword">in</span> <span class="token variable">$importList</span><span class="token punctuation">)</span></span>
import <span class="token variable">$<span class="token punctuation">{</span>import<span class="token punctuation">}</span></span>;
<span class="token directive"><span class="token keyword">#end</span></span>
import com.alibaba.excel.annotation.ExcelIgnoreUnannotated;
import com.alibaba.excel.annotation.ExcelProperty;
import com.ruoyi.common.annotation.ExcelDictFormat;
import com.ruoyi.common.convert.ExcelDictConvert;
import lombok.Data;
import java.util.Date;

import java.io.Serializable;

/**
 * <span class="token variable">$<span class="token punctuation">{</span>functionName<span class="token punctuation">}</span></span>视图对象 <span class="token variable">$<span class="token punctuation">{</span>tableName<span class="token punctuation">}</span></span>
 *
 * @author <span class="token variable">$<span class="token punctuation">{</span>author<span class="token punctuation">}</span></span>
 * @date <span class="token variable">$<span class="token punctuation">{</span>datetime<span class="token punctuation">}</span></span>
 */
@Data
@ExcelIgnoreUnannotated
public class <span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Vo implements Serializable {

    private static final long serialVersionUID = 1L;

<span class="token directive"><span class="token keyword">#foreach</span> <span class="token punctuation">(</span><span class="token variable">$column</span> <span class="token keyword">in</span> <span class="token variable">$columns</span><span class="token punctuation">)</span></span>
<span class="token directive"><span class="token keyword">#if</span><span class="token punctuation">(</span><span class="token variable">$column<span class="token punctuation">.</span>list</span><span class="token punctuation">)</span></span>
    /**
     * <span class="token variable">$column<span class="token punctuation">.</span>columnComment</span>
     */
    <span class="token velocity-comment comment">## 字段内容获取括号中了 , 如果没有则直接显示</span>
    <span class="token directive"><span class="token keyword">#set</span><span class="token punctuation">(</span><span class="token variable">$parentheseIndex</span><span class="token operator">=</span><span class="token variable">$column<span class="token punctuation">.</span>columnComment<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">&quot;（&quot;</span><span class="token punctuation">)</span></span><span class="token punctuation">)</span></span>
    <span class="token directive"><span class="token keyword">#if</span><span class="token punctuation">(</span><span class="token variable">$parentheseIndex</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span></span>
        <span class="token directive"><span class="token keyword">#set</span><span class="token punctuation">(</span><span class="token variable">$comment</span><span class="token operator">=</span><span class="token variable">$column<span class="token punctuation">.</span>columnComment<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> $parentheseIndex<span class="token punctuation">)</span></span><span class="token punctuation">)</span></span>
    <span class="token directive"><span class="token keyword">#else</span></span>
        <span class="token directive"><span class="token keyword">#set</span><span class="token punctuation">(</span><span class="token variable">$comment</span><span class="token operator">=</span><span class="token variable">$column<span class="token punctuation">.</span>columnComment</span><span class="token punctuation">)</span></span>
    <span class="token directive"><span class="token keyword">#end</span></span>
    <span class="token velocity-comment comment">## 导出表格处理</span>
    <span class="token directive"><span class="token keyword">#if</span><span class="token punctuation">(</span><span class="token variable">$<span class="token punctuation">{</span>column<span class="token punctuation">.</span>dictType<span class="token punctuation">}</span></span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$<span class="token punctuation">{</span>column<span class="token punctuation">.</span>dictType<span class="token punctuation">}</span></span> <span class="token operator">!=</span> <span class="token string">''</span><span class="token punctuation">)</span></span>
        <span class="token velocity-comment comment">## 为字典类型 转化处理</span>
    @ExcelProperty(value = &quot;<span class="token variable">$<span class="token punctuation">{</span>comment<span class="token punctuation">}</span></span>&quot; , converter = ExcelDictConvert.class)
    @ExcelDictFormat(dictType = &quot;<span class="token variable">$<span class="token punctuation">{</span>column<span class="token punctuation">.</span>dictType<span class="token punctuation">}</span></span>&quot; )
    <span class="token directive"><span class="token keyword">#elseif</span><span class="token punctuation">(</span><span class="token variable">$parentheseIndex</span> <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span></span>
        <span class="token velocity-comment comment">## 为字典类型处理 (特殊转化处理)</span>
    @ExcelProperty(value = &quot;<span class="token variable">$<span class="token punctuation">{</span>comment<span class="token punctuation">}</span></span>&quot; , converter = ExcelDictConvert.class)
    @ExcelDictFormat(readConverterExp = &quot;<span class="token variable">$column<span class="token punctuation">.</span><span class="token function">readConverterExp</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>&quot; )
    <span class="token directive"><span class="token keyword">#else</span></span>
        <span class="token velocity-comment comment">## 默认 导出不处理 仅做标识</span>
    @ExcelProperty(value = &quot;<span class="token variable">$<span class="token punctuation">{</span>comment<span class="token punctuation">}</span></span>&quot; )
    <span class="token directive"><span class="token keyword">#end</span></span>
    private <span class="token variable">$column<span class="token punctuation">.</span>javaType</span> <span class="token variable">$column<span class="token punctuation">.</span>javaField</span>;

<span class="token directive"><span class="token keyword">#end</span></span>
<span class="token directive"><span class="token keyword">#end</span></span>

}
</code></pre></div></details> <p><strong>请求接收类 <em>vm/java/bo.java.vm</em></strong></p> <details class="custom-block details"><summary>点击展开</summary> <div class="language-velocity extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br></div><pre class="language-velocity"><code>package <span class="token variable">$<span class="token punctuation">{</span>packageName<span class="token punctuation">}</span></span>.domain.bo;

import com.ruoyi.common.core.validate.AddGroup;
import com.ruoyi.common.core.validate.EditGroup;
import lombok.Data;
import lombok.EqualsAndHashCode;

import javax.validation.constraints.*;

import java.util.Date;

<span class="token directive"><span class="token keyword">#foreach</span> <span class="token punctuation">(</span><span class="token variable">$import</span> <span class="token keyword">in</span> <span class="token variable">$importList</span><span class="token punctuation">)</span></span>
import <span class="token variable">$<span class="token punctuation">{</span>import<span class="token punctuation">}</span></span>;
<span class="token directive"><span class="token keyword">#end</span></span>
<span class="token directive"><span class="token keyword">#if</span><span class="token punctuation">(</span><span class="token variable">$table<span class="token punctuation">.</span>crud</span> <span class="token operator">||</span> <span class="token variable">$table<span class="token punctuation">.</span>sub</span><span class="token punctuation">)</span></span>
import com.ruoyi.common.core.domain.BaseEntity;
<span class="token directive"><span class="token keyword">#elseif</span><span class="token punctuation">(</span><span class="token variable">$table<span class="token punctuation">.</span>tree</span><span class="token punctuation">)</span></span>
import com.ruoyi.common.core.domain.TreeEntity;
<span class="token directive"><span class="token keyword">#end</span></span>

/**
 * <span class="token variable">$<span class="token punctuation">{</span>functionName<span class="token punctuation">}</span></span>业务对象 <span class="token variable">$<span class="token punctuation">{</span>tableName<span class="token punctuation">}</span></span>
 *
 * @author <span class="token variable">$<span class="token punctuation">{</span>author<span class="token punctuation">}</span></span>
 * @date <span class="token variable">$<span class="token punctuation">{</span>datetime<span class="token punctuation">}</span></span>
 */
<span class="token directive"><span class="token keyword">#if</span><span class="token punctuation">(</span><span class="token variable">$table<span class="token punctuation">.</span>crud</span> <span class="token operator">||</span> <span class="token variable">$table<span class="token punctuation">.</span>sub</span><span class="token punctuation">)</span></span>
    <span class="token directive"><span class="token keyword">#set</span><span class="token punctuation">(</span><span class="token variable">$Entity</span><span class="token operator">=</span><span class="token string">&quot;BaseEntity&quot;</span><span class="token punctuation">)</span></span>
<span class="token directive"><span class="token keyword">#elseif</span><span class="token punctuation">(</span><span class="token variable">$table<span class="token punctuation">.</span>tree</span><span class="token punctuation">)</span></span>
    <span class="token directive"><span class="token keyword">#set</span><span class="token punctuation">(</span><span class="token variable">$Entity</span><span class="token operator">=</span><span class="token string">&quot;TreeEntity&lt;${ClassName}Bo&gt;&quot;</span><span class="token punctuation">)</span></span>
<span class="token directive"><span class="token keyword">#end</span></span>

@Data
@EqualsAndHashCode(callSuper = true)
public class <span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Bo extends <span class="token variable">$<span class="token punctuation">{</span>Entity<span class="token punctuation">}</span></span> {

    <span class="token directive"><span class="token keyword">#foreach</span> <span class="token punctuation">(</span><span class="token variable">$column</span> <span class="token keyword">in</span> <span class="token variable">$columns</span><span class="token punctuation">)</span></span>
        <span class="token velocity-comment comment">## 额外判断请求参数非空处理</span>
        <span class="token directive"><span class="token keyword">#if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$table<span class="token punctuation">.</span><span class="token function">isSuperColumn</span><span class="token punctuation">(</span>$column<span class="token punctuation">.</span>javaField<span class="token punctuation">)</span></span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token variable">$column<span class="token punctuation">.</span>query</span> <span class="token operator">||</span> <span class="token variable">$column<span class="token punctuation">.</span>insert</span> <span class="token operator">||</span> <span class="token variable">$column<span class="token punctuation">.</span>edit</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span>
            /**
             * <span class="token variable">$column<span class="token punctuation">.</span>columnComment</span>
             */
            <span class="token velocity-comment comment">## 判断含有的操作组控制非空校验</span>
            <span class="token directive"><span class="token keyword">#if</span><span class="token punctuation">(</span><span class="token variable">$column<span class="token punctuation">.</span>insert</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$column<span class="token punctuation">.</span>edit</span><span class="token punctuation">)</span></span>
                <span class="token directive"><span class="token keyword">#set</span><span class="token punctuation">(</span><span class="token variable">$Group</span><span class="token operator">=</span><span class="token string">&quot;AddGroup.class, EditGroup.class&quot;</span><span class="token punctuation">)</span></span>
            <span class="token directive"><span class="token keyword">#elseif</span><span class="token punctuation">(</span><span class="token variable">$column<span class="token punctuation">.</span>insert</span><span class="token punctuation">)</span></span>
                <span class="token directive"><span class="token keyword">#set</span><span class="token punctuation">(</span><span class="token variable">$Group</span><span class="token operator">=</span><span class="token string">&quot;AddGroup.class&quot;</span><span class="token punctuation">)</span></span>
            <span class="token directive"><span class="token keyword">#elseif</span><span class="token punctuation">(</span><span class="token variable">$column<span class="token punctuation">.</span>edit</span><span class="token punctuation">)</span></span>
                <span class="token directive"><span class="token keyword">#set</span><span class="token punctuation">(</span><span class="token variable">$Group</span><span class="token operator">=</span><span class="token string">&quot;EditGroup.class&quot;</span><span class="token punctuation">)</span></span>
            <span class="token directive"><span class="token keyword">#end</span></span>
            <span class="token directive"><span class="token keyword">#if</span><span class="token punctuation">(</span><span class="token variable">$column<span class="token punctuation">.</span>required</span><span class="token punctuation">)</span></span>
                <span class="token velocity-comment comment">## 区分对象字符串处理</span>
                <span class="token directive"><span class="token keyword">#if</span><span class="token punctuation">(</span><span class="token variable">$column<span class="token punctuation">.</span>javaType</span> <span class="token operator">==</span> <span class="token string">'String'</span><span class="token punctuation">)</span></span>
        @NotBlank(message = &quot;<span class="token variable">$column<span class="token punctuation">.</span>columnComment</span>不能为空&quot; , groups = { <span class="token variable">$Group</span> })
                <span class="token directive"><span class="token keyword">#else</span></span>
        @NotNull(message = &quot;<span class="token variable">$column<span class="token punctuation">.</span>columnComment</span>不能为空&quot; , groups = { <span class="token variable">$Group</span> })
                <span class="token directive"><span class="token keyword">#end</span></span>
            <span class="token directive"><span class="token keyword">#end</span></span>
        private <span class="token variable">$column<span class="token punctuation">.</span>javaType</span> <span class="token variable">$column<span class="token punctuation">.</span>javaField</span>;

        <span class="token directive"><span class="token keyword">#end</span></span>
    <span class="token directive"><span class="token keyword">#end</span></span>

}
</code></pre></div></details> <p><strong>业务接口 <em>vm/java/service.java.vm</em></strong> (无核心业务代码)</p> <details class="custom-block details"><summary>点击展开</summary> <div class="language-velocity extra-class"><pre class="language-velocity"><code>package <span class="token variable">$<span class="token punctuation">{</span>packageName<span class="token punctuation">}</span></span>.service;

import <span class="token variable">$<span class="token punctuation">{</span>packageName<span class="token punctuation">}</span></span>.domain.<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>;
import <span class="token variable">$<span class="token punctuation">{</span>packageName<span class="token punctuation">}</span></span>.domain.vo.<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Vo;
import <span class="token variable">$<span class="token punctuation">{</span>packageName<span class="token punctuation">}</span></span>.domain.bo.<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Bo;
    <span class="token directive"><span class="token keyword">#if</span><span class="token punctuation">(</span><span class="token variable">$table<span class="token punctuation">.</span>crud</span> <span class="token operator">||</span> <span class="token variable">$table<span class="token punctuation">.</span>sub</span><span class="token punctuation">)</span></span>
    import com.ruoyi.common.core.page.TableDataInfo;
    import com.ruoyi.common.core.domain.PageQuery;
    <span class="token directive"><span class="token keyword">#end</span></span>

import java.util.Collection;
import java.util.List;

/**
 * <span class="token variable">$<span class="token punctuation">{</span>functionName<span class="token punctuation">}</span></span>Service接口
 *
 * @author <span class="token variable">$<span class="token punctuation">{</span>author<span class="token punctuation">}</span></span>
 * @date <span class="token variable">$<span class="token punctuation">{</span>datetime<span class="token punctuation">}</span></span>
 */
public interface I<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Service {

    /**
     * 查询<span class="token variable">$<span class="token punctuation">{</span>functionName<span class="token punctuation">}</span></span>
     */
        <span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Vo queryById(<span class="token variable">$<span class="token punctuation">{</span>pkColumn<span class="token punctuation">.</span>javaType<span class="token punctuation">}</span></span> <span class="token variable">$<span class="token punctuation">{</span>pkColumn<span class="token punctuation">.</span>javaField<span class="token punctuation">}</span></span>);

    <span class="token directive"><span class="token keyword">#if</span><span class="token punctuation">(</span><span class="token variable">$table<span class="token punctuation">.</span>crud</span> <span class="token operator">||</span> <span class="token variable">$table<span class="token punctuation">.</span>sub</span><span class="token punctuation">)</span></span>
        /**
         * 查询<span class="token variable">$<span class="token punctuation">{</span>functionName<span class="token punctuation">}</span></span>列表
         */
        TableDataInfo&lt;<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Vo&gt; queryPageList(<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Bo bo, PageQuery pageQuery);
    <span class="token directive"><span class="token keyword">#end</span></span>

    /**
     * 查询<span class="token variable">$<span class="token punctuation">{</span>functionName<span class="token punctuation">}</span></span>列表
     */
    List&lt;<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Vo&gt; queryList(<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Bo bo);

    /**
     * 新增<span class="token variable">$<span class="token punctuation">{</span>functionName<span class="token punctuation">}</span></span>
     */
    Boolean insertByBo(<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Bo bo);

    /**
     * 修改<span class="token variable">$<span class="token punctuation">{</span>functionName<span class="token punctuation">}</span></span>
     */
    Boolean updateByBo(<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Bo bo);

    /**
     * 校验并批量删除<span class="token variable">$<span class="token punctuation">{</span>functionName<span class="token punctuation">}</span></span>信息
     */
    Boolean deleteWithValidByIds(Collection&lt;<span class="token variable">$<span class="token punctuation">{</span>pkColumn<span class="token punctuation">.</span>javaType<span class="token punctuation">}</span></span>&gt; ids, Boolean isValid);
}
</code></pre></div></details> <p><strong>业务实现类 <em>vm/java/serviceImpl.java.vm</em></strong></p> <details class="custom-block details"><summary>点击展开</summary> <p>主要业务还嘚是 buildQueryWrapper()方法 , 约束查询的构建</p> <div class="language-velocity extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-velocity"><code>package <span class="token variable">$<span class="token punctuation">{</span>packageName<span class="token punctuation">}</span></span>.service.impl;

import cn.hutool.core.bean.BeanUtil;
import com.ruoyi.common.utils.StringUtils;
    <span class="token directive"><span class="token keyword">#if</span><span class="token punctuation">(</span><span class="token variable">$table<span class="token punctuation">.</span>crud</span> <span class="token operator">||</span> <span class="token variable">$table<span class="token punctuation">.</span>sub</span><span class="token punctuation">)</span></span>
    import com.ruoyi.common.core.page.TableDataInfo;
    import com.ruoyi.common.core.domain.PageQuery;
    import com.baomidou.mybatisplus.extension.plugins.pagination.Page;
    <span class="token directive"><span class="token keyword">#end</span></span>
import com.baomidou.mybatisplus.core.conditions.query.LambdaQueryWrapper;
import com.baomidou.mybatisplus.core.toolkit.Wrappers;
import lombok.RequiredArgsConstructor;
import org.springframework.stereotype.Service;
import <span class="token variable">$<span class="token punctuation">{</span>packageName<span class="token punctuation">}</span></span>.domain.bo.<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Bo;
import <span class="token variable">$<span class="token punctuation">{</span>packageName<span class="token punctuation">}</span></span>.domain.vo.<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Vo;
import <span class="token variable">$<span class="token punctuation">{</span>packageName<span class="token punctuation">}</span></span>.domain.<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>;
import <span class="token variable">$<span class="token punctuation">{</span>packageName<span class="token punctuation">}</span></span>.mapper.<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Mapper;
import <span class="token variable">$<span class="token punctuation">{</span>packageName<span class="token punctuation">}</span></span>.service.I<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Service;

import java.util.List;
import java.util.Map;
import java.util.Collection;

/**
 * <span class="token variable">$<span class="token punctuation">{</span>functionName<span class="token punctuation">}</span></span>Service业务层处理
 *
 * @author <span class="token variable">$<span class="token punctuation">{</span>author<span class="token punctuation">}</span></span>
 * @date <span class="token variable">$<span class="token punctuation">{</span>datetime<span class="token punctuation">}</span></span>
 */
@RequiredArgsConstructor
@Service
public class <span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>ServiceImpl implements I<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Service {

    private final <span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Mapper baseMapper;

    /**
     * 查询<span class="token variable">$<span class="token punctuation">{</span>functionName<span class="token punctuation">}</span></span>
     */
    @Override
    public <span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Vo queryById(<span class="token variable">$<span class="token punctuation">{</span>pkColumn<span class="token punctuation">.</span>javaType<span class="token punctuation">}</span></span> <span class="token variable">$<span class="token punctuation">{</span>pkColumn<span class="token punctuation">.</span>javaField<span class="token punctuation">}</span></span>) {
        return baseMapper.selectVoById(<span class="token variable">$<span class="token punctuation">{</span>pkColumn<span class="token punctuation">.</span>javaField<span class="token punctuation">}</span></span>);
    }

    <span class="token directive"><span class="token keyword">#if</span><span class="token punctuation">(</span><span class="token variable">$table<span class="token punctuation">.</span>crud</span> <span class="token operator">||</span> <span class="token variable">$table<span class="token punctuation">.</span>sub</span><span class="token punctuation">)</span></span>
        /**
         * 查询<span class="token variable">$<span class="token punctuation">{</span>functionName<span class="token punctuation">}</span></span>列表
         */
        @Override
        public TableDataInfo&lt;<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Vo&gt; queryPageList(<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Bo bo, PageQuery pageQuery) {
            LambdaQueryWrapper&lt;<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>&gt; lqw = buildQueryWrapper(bo);
            Page&lt;<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Vo&gt; result = baseMapper.selectVoPage(pageQuery.build(), lqw);
            return TableDataInfo.build(result);
        }
    <span class="token directive"><span class="token keyword">#end</span></span>

    /**
     * 查询<span class="token variable">$<span class="token punctuation">{</span>functionName<span class="token punctuation">}</span></span>列表
     */
    @Override
    public List&lt;<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Vo&gt; queryList(<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Bo bo) {
        LambdaQueryWrapper&lt;<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>&gt; lqw = buildQueryWrapper(bo); return baseMapper.selectVoList(lqw);
    }

    <span class="token velocity-comment comment">## 构建查询条件</span>
    private LambdaQueryWrapper&lt;<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>&gt; buildQueryWrapper(<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Bo bo) {
        Map<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>String,</span> <span class="token attr-name">Object</span><span class="token punctuation">&gt;</span></span> params = bo.getParams();
        LambdaQueryWrapper&lt;<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>&gt; lqw = Wrappers.lambdaQuery();
        <span class="token directive"><span class="token keyword">#foreach</span><span class="token punctuation">(</span><span class="token variable">$column</span> <span class="token keyword">in</span> <span class="token variable">$columns</span><span class="token punctuation">)</span></span>
            <span class="token directive"><span class="token keyword">#if</span><span class="token punctuation">(</span><span class="token variable">$column<span class="token punctuation">.</span>query</span><span class="token punctuation">)</span></span>
                <span class="token directive"><span class="token keyword">#set</span><span class="token punctuation">(</span><span class="token variable">$queryType</span><span class="token operator">=</span><span class="token variable">$column<span class="token punctuation">.</span>queryType</span><span class="token punctuation">)</span></span>
                <span class="token directive"><span class="token keyword">#set</span><span class="token punctuation">(</span><span class="token variable">$javaField</span><span class="token operator">=</span><span class="token variable">$column<span class="token punctuation">.</span>javaField</span><span class="token punctuation">)</span></span>
                <span class="token directive"><span class="token keyword">#set</span><span class="token punctuation">(</span><span class="token variable">$javaType</span><span class="token operator">=</span><span class="token variable">$column<span class="token punctuation">.</span>javaType</span><span class="token punctuation">)</span></span>
                <span class="token directive"><span class="token keyword">#set</span><span class="token punctuation">(</span><span class="token variable">$columnName</span><span class="token operator">=</span><span class="token variable">$column<span class="token punctuation">.</span>columnName</span><span class="token punctuation">)</span></span>
                <span class="token directive"><span class="token keyword">#set</span><span class="token punctuation">(</span><span class="token variable">$AttrName</span><span class="token operator">=</span><span class="token variable">$column<span class="token punctuation">.</span>javaField<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span> <span class="token operator">+</span> <span class="token variable">$<span class="token punctuation">{</span>column<span class="token punctuation">.</span>javaField<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span></span>
                <span class="token directive"><span class="token keyword">#set</span><span class="token punctuation">(</span><span class="token variable">$mpMethod</span><span class="token operator">=</span><span class="token variable">$column<span class="token punctuation">.</span>queryType<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token punctuation">)</span></span>
                <span class="token directive"><span class="token keyword">#if</span><span class="token punctuation">(</span><span class="token variable">$queryType</span> <span class="token operator">!=</span> <span class="token string">'BETWEEN'</span><span class="token punctuation">)</span></span>
                    <span class="token velocity-comment comment">## 查询判空</span>
                    <span class="token directive"><span class="token keyword">#if</span><span class="token punctuation">(</span><span class="token variable">$javaType</span> <span class="token operator">==</span> <span class="token string">'String'</span><span class="token punctuation">)</span></span>
                        <span class="token directive"><span class="token keyword">#set</span></span>(<span class="token variable">$condition</span>='StringUtils.isNotBlank(bo.get'+<span class="token variable">$AttrName</span>+'())')
                    <span class="token directive"><span class="token keyword">#else</span></span>
                        <span class="token directive"><span class="token keyword">#set</span><span class="token punctuation">(</span><span class="token variable">$condition</span><span class="token operator">=</span><span class="token string">'bo.get'</span><span class="token operator">+</span><span class="token variable">$AttrName</span><span class="token operator">+</span><span class="token string">'() != null'</span><span class="token punctuation">)</span></span>
                    <span class="token directive"><span class="token keyword">#end</span></span>
                    lqw.<span class="token variable">$<span class="token function">mpMethod</span><span class="token punctuation">(</span>$condition<span class="token punctuation">,</span> $<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span><span class="token punctuation">:</span><span class="token punctuation">:</span>get$AttrName<span class="token punctuation">,</span> bo<span class="token punctuation">.</span>get$AttrName<span class="token punctuation">(</span><span class="token punctuation">)</span></span>);
                <span class="token directive"><span class="token keyword">#else</span></span>
                    <span class="token velocity-comment comment">## 日期范围单独处理</span>
                    lqw.between(params.get(&quot;begin<span class="token variable">$AttrName</span>&quot; ) != null &amp;&amp; params.get(&quot;end<span class="token variable">$AttrName</span>&quot; ) != null,
                        <span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>::get<span class="token variable">$AttrName</span> , params.get(&quot;begin<span class="token variable">$AttrName</span>&quot; ), params.get(&quot;end<span class="token variable">$AttrName</span>&quot; ));
                <span class="token directive"><span class="token keyword">#end</span></span>
            <span class="token directive"><span class="token keyword">#end</span></span>
        <span class="token directive"><span class="token keyword">#end</span></span>
        return lqw;
    }

    /**
     * 新增<span class="token variable">$<span class="token punctuation">{</span>functionName<span class="token punctuation">}</span></span>
     */
    @Override
    public Boolean insertByBo(<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Bo bo) {
        <span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span> add = BeanUtil.toBean(bo, <span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>. class);
        validEntityBeforeSave(add);
        boolean flag = baseMapper.insert(add) &gt; 0;
        <span class="token directive"><span class="token keyword">#set</span><span class="token punctuation">(</span><span class="token variable">$pk</span><span class="token operator">=</span><span class="token variable">$pkColumn<span class="token punctuation">.</span>javaField<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span> <span class="token operator">+</span> <span class="token variable">$<span class="token punctuation">{</span>pkColumn<span class="token punctuation">.</span>javaField<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">)</span></span>
        if (flag) {
            bo.set<span class="token variable">$<span class="token function">pk</span><span class="token punctuation">(</span>add<span class="token punctuation">.</span>get$<span class="token function">pk</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>);
        }
        return flag;
    }

    /**
     * 修改<span class="token variable">$<span class="token punctuation">{</span>functionName<span class="token punctuation">}</span></span>
     */
    @Override
    public Boolean updateByBo(<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Bo bo) {
        <span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span> update = BeanUtil.toBean(bo, <span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>. class);
        validEntityBeforeSave(update);
        return baseMapper.updateById(update) &gt; 0;
    }

    /**
     * 保存前的数据校验
     */
    private void validEntityBeforeSave(<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span> entity) {
        //TODO 做一些数据校验,如唯一约束
    }

    /**
     * 批量删除<span class="token variable">$<span class="token punctuation">{</span>functionName<span class="token punctuation">}</span></span>
     */
    @Override
    public Boolean deleteWithValidByIds(Collection&lt;<span class="token variable">$<span class="token punctuation">{</span>pkColumn<span class="token punctuation">.</span>javaType<span class="token punctuation">}</span></span>&gt; ids, Boolean isValid) {
        if (isValid) {
            //TODO 做一些业务上的校验,判断是否需要校验
        }
        return baseMapper.deleteBatchIds(ids) &gt; 0;
    }
}
</code></pre></div></details> <p><em><strong>vm/java/controller.java.vm</strong></em> (无核心业务代码)</p> <details class="custom-block details"><summary>点击展开</summary> <div class="language-velocity extra-class"><pre class="language-velocity"><code>package <span class="token variable">$<span class="token punctuation">{</span>packageName<span class="token punctuation">}</span></span>.controller;

import java.util.List;
import java.util.Arrays;
import java.util.concurrent.TimeUnit;

import lombok.RequiredArgsConstructor;

import javax.servlet.http.HttpServletResponse;
import javax.validation.constraints.*;

import cn.dev33.satoken.annotation.SaCheckPermission;
import org.springframework.web.bind.annotation.*;
import org.springframework.validation.annotation.Validated;
import com.ruoyi.common.annotation.RepeatSubmit;
import com.ruoyi.common.annotation.Log;
import com.ruoyi.common.core.controller.BaseController;
import com.ruoyi.common.core.domain.PageQuery;
import com.ruoyi.common.core.domain.R;
import com.ruoyi.common.core.validate.AddGroup;
import com.ruoyi.common.core.validate.EditGroup;
import com.ruoyi.common.core.validate.QueryGroup;
import com.ruoyi.common.enums.BusinessType;
import com.ruoyi.common.utils.poi.ExcelUtil;
import <span class="token variable">$<span class="token punctuation">{</span>packageName<span class="token punctuation">}</span></span>.domain.vo.<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Vo;
import <span class="token variable">$<span class="token punctuation">{</span>packageName<span class="token punctuation">}</span></span>.domain.bo.<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Bo;
import <span class="token variable">$<span class="token punctuation">{</span>packageName<span class="token punctuation">}</span></span>.service.I<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Service;
<span class="token directive"><span class="token keyword">#if</span><span class="token punctuation">(</span><span class="token variable">$table<span class="token punctuation">.</span>crud</span> <span class="token operator">||</span> <span class="token variable">$table<span class="token punctuation">.</span>sub</span><span class="token punctuation">)</span></span>
import com.ruoyi.common.core.page.TableDataInfo;
<span class="token directive"><span class="token keyword">#elseif</span><span class="token punctuation">(</span><span class="token variable">$table<span class="token punctuation">.</span>tree</span><span class="token punctuation">)</span></span>
<span class="token directive"><span class="token keyword">#end</span></span>

/**
 * <span class="token variable">$<span class="token punctuation">{</span>functionName<span class="token punctuation">}</span></span>
 *
 * @author <span class="token variable">$<span class="token punctuation">{</span>author<span class="token punctuation">}</span></span>
 * @date <span class="token variable">$<span class="token punctuation">{</span>datetime<span class="token punctuation">}</span></span>
 */
@Validated
@RequiredArgsConstructor
@RestController
@RequestMapping(&quot;/<span class="token variable">$<span class="token punctuation">{</span>moduleName<span class="token punctuation">}</span></span>/<span class="token variable">$<span class="token punctuation">{</span>businessName<span class="token punctuation">}</span></span>&quot; )
public class <span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Controller extends BaseController {

    private final I<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Service i<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Service;

/**
 * 查询<span class="token variable">$<span class="token punctuation">{</span>functionName<span class="token punctuation">}</span></span>列表
 */
@SaCheckPermission(&quot;<span class="token variable">$<span class="token punctuation">{</span>permissionPrefix<span class="token punctuation">}</span></span>:list&quot; )
@GetMapping(&quot;/list&quot; )
    <span class="token directive"><span class="token keyword">#if</span><span class="token punctuation">(</span><span class="token variable">$table<span class="token punctuation">.</span>crud</span> <span class="token operator">||</span> <span class="token variable">$table<span class="token punctuation">.</span>sub</span><span class="token punctuation">)</span></span>
    public TableDataInfo&lt;<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Vo&gt; list(<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Bo bo, PageQuery pageQuery) {
        return i<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Service.queryPageList(bo, pageQuery);
    }
    <span class="token directive"><span class="token keyword">#elseif</span><span class="token punctuation">(</span><span class="token variable">$table<span class="token punctuation">.</span>tree</span><span class="token punctuation">)</span></span>
        public R&lt;List&lt;<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Vo&gt;&gt; list(<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Bo bo) {
            List&lt;<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Vo&gt; list = i<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Service.queryList(bo);
            return R.ok(list);
        }
    <span class="token directive"><span class="token keyword">#end</span></span>

    /**
     * 导出<span class="token variable">$<span class="token punctuation">{</span>functionName<span class="token punctuation">}</span></span>列表
     */
    @SaCheckPermission(&quot;<span class="token variable">$<span class="token punctuation">{</span>permissionPrefix<span class="token punctuation">}</span></span>:export&quot; )
    @Log(title = &quot;<span class="token variable">$<span class="token punctuation">{</span>functionName<span class="token punctuation">}</span></span>&quot; , businessType = BusinessType.EXPORT)
    @PostMapping(&quot;/export&quot; )
    public void export(<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Bo bo, HttpServletResponse response) {
        List&lt;<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Vo&gt; list = i<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Service.queryList(bo);
        ExcelUtil.exportExcel(list, &quot;<span class="token variable">$<span class="token punctuation">{</span>functionName<span class="token punctuation">}</span></span>&quot; , <span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Vo.class, response);
    }

    /**
     * 获取<span class="token variable">$<span class="token punctuation">{</span>functionName<span class="token punctuation">}</span></span>详细信息
     *
     * @param <span class="token variable">$<span class="token punctuation">{</span>pkColumn<span class="token punctuation">.</span>javaField<span class="token punctuation">}</span></span> 主键
     */
    @SaCheckPermission(&quot;<span class="token variable">$<span class="token punctuation">{</span>permissionPrefix<span class="token punctuation">}</span></span>:query&quot; )
    @GetMapping(&quot;/{<span class="token variable">$<span class="token punctuation">{</span>pkColumn<span class="token punctuation">.</span>javaField<span class="token punctuation">}</span></span>}&quot; )
    public R&lt;<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Vo&gt; getInfo(@NotNull(message = &quot;主键不能为空&quot; ) @PathVariable <span class="token variable">$<span class="token punctuation">{</span>pkColumn<span class="token punctuation">.</span>javaType<span class="token punctuation">}</span></span> <span class="token variable">$<span class="token punctuation">{</span>pkColumn<span class="token punctuation">.</span>javaField<span class="token punctuation">}</span></span>) {
        return R.ok(i<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Service.queryById(<span class="token variable">$<span class="token punctuation">{</span>pkColumn<span class="token punctuation">.</span>javaField<span class="token punctuation">}</span></span>));
    }

    /**
     * 新增<span class="token variable">$<span class="token punctuation">{</span>functionName<span class="token punctuation">}</span></span>
     */
    @SaCheckPermission(&quot;<span class="token variable">$<span class="token punctuation">{</span>permissionPrefix<span class="token punctuation">}</span></span>:add&quot; )
    @Log(title = &quot;<span class="token variable">$<span class="token punctuation">{</span>functionName<span class="token punctuation">}</span></span>&quot; , businessType = BusinessType.INSERT)
    @RepeatSubmit()
    @PostMapping()
    public R<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Void</span><span class="token punctuation">&gt;</span></span> add(@Validated(AddGroup.class) @RequestBody <span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Bo bo) {
        return toAjax(i<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Service.insertByBo(bo));
    }

    /**
     * 修改<span class="token variable">$<span class="token punctuation">{</span>functionName<span class="token punctuation">}</span></span>
     */
    @SaCheckPermission(&quot;<span class="token variable">$<span class="token punctuation">{</span>permissionPrefix<span class="token punctuation">}</span></span>:edit&quot; )
    @Log(title = &quot;<span class="token variable">$<span class="token punctuation">{</span>functionName<span class="token punctuation">}</span></span>&quot; , businessType = BusinessType.UPDATE)
    @RepeatSubmit()
    @PutMapping()
    public R<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Void</span><span class="token punctuation">&gt;</span></span> edit(@Validated(EditGroup.class) @RequestBody <span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Bo bo) {
        return toAjax(i<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Service.updateByBo(bo));
    }

    /**
     * 删除<span class="token variable">$<span class="token punctuation">{</span>functionName<span class="token punctuation">}</span></span>
     *
     * @param <span class="token variable">$<span class="token punctuation">{</span>pkColumn<span class="token punctuation">.</span>javaField<span class="token punctuation">}</span></span>s 主键串
     */
    @SaCheckPermission(&quot;<span class="token variable">$<span class="token punctuation">{</span>permissionPrefix<span class="token punctuation">}</span></span>:remove&quot; )
    @Log(title = &quot;<span class="token variable">$<span class="token punctuation">{</span>functionName<span class="token punctuation">}</span></span>&quot; , businessType = BusinessType.DELETE)
    @DeleteMapping(&quot;/{<span class="token variable">$<span class="token punctuation">{</span>pkColumn<span class="token punctuation">.</span>javaField<span class="token punctuation">}</span></span>s}&quot; )
    public R<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Void</span><span class="token punctuation">&gt;</span></span> remove(@NotEmpty(message = &quot;主键不能为空&quot; ) @PathVariable <span class="token variable">$<span class="token punctuation">{</span>pkColumn<span class="token punctuation">.</span>javaType<span class="token punctuation">}</span></span>[] <span class="token variable">$<span class="token punctuation">{</span>pkColumn<span class="token punctuation">.</span>javaField<span class="token punctuation">}</span></span>s) {
        return toAjax(i<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Service.deleteWithValidByIds(Arrays.asList(<span class="token variable">$<span class="token punctuation">{</span>pkColumn<span class="token punctuation">.</span>javaField<span class="token punctuation">}</span></span>s), true));
    }
}
</code></pre></div></details> <h3 id="xml模块"><a href="#xml模块" class="header-anchor">#</a> XML模块</h3> <p><em><strong>vm/java/mapper.java.vm</strong></em> (无核心业务代码)</p> <details class="custom-block details"><summary>点击展开</summary> <div class="language-velocity extra-class"><pre class="language-velocity"><code>package <span class="token variable">$<span class="token punctuation">{</span>packageName<span class="token punctuation">}</span></span>.mapper;

import <span class="token variable">$<span class="token punctuation">{</span>packageName<span class="token punctuation">}</span></span>.domain.<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>;
import <span class="token variable">$<span class="token punctuation">{</span>packageName<span class="token punctuation">}</span></span>.domain.vo.<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Vo;
import com.ruoyi.common.core.mapper.BaseMapperPlus;

/**
 * <span class="token variable">$<span class="token punctuation">{</span>functionName<span class="token punctuation">}</span></span>Mapper接口
 *
 * @author <span class="token variable">$<span class="token punctuation">{</span>author<span class="token punctuation">}</span></span>
 * @date <span class="token variable">$<span class="token punctuation">{</span>datetime<span class="token punctuation">}</span></span>
 */
public interface <span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Mapper extends BaseMapperPlus&lt;<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Mapper, <span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>, <span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Vo&gt; {

}
</code></pre></div></details> <p><em><strong>vm/xml/mapper.xml.vm</strong></em> (无核心业务代码)</p> <details class="custom-block details"><summary>点击展开</summary> <div class="language-velocity extra-class"><pre class="language-velocity"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">mapper</span>
    <span class="token name">PUBLIC</span> <span class="token string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span>
    <span class="token string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">namespace</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token variable">$<span class="token punctuation">{</span>packageName<span class="token punctuation">}</span></span>.mapper.<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Mapper<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resultMap</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token variable">$<span class="token punctuation">{</span>packageName<span class="token punctuation">}</span></span>.domain.<span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token variable">$<span class="token punctuation">{</span>ClassName<span class="token punctuation">}</span></span>Result<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token directive"><span class="token keyword">#foreach</span> <span class="token punctuation">(</span><span class="token variable">$column</span> <span class="token keyword">in</span> <span class="token variable">$columns</span><span class="token punctuation">)</span></span>
    	<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token variable">$<span class="token punctuation">{</span>column<span class="token punctuation">.</span>javaField<span class="token punctuation">}</span></span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token variable">$<span class="token punctuation">{</span>column<span class="token punctuation">.</span>columnName<span class="token punctuation">}</span></span><span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token directive"><span class="token keyword">#end</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resultMap</span><span class="token punctuation">&gt;</span></span>


<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mapper</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></details> <h3 id="sql模板"><a href="#sql模板" class="header-anchor">#</a> SQL模板</h3> <p><em><strong>vm/sql/sql.vm</strong></em></p> <details class="custom-block details"><summary>点击展开</summary> <div class="language-velocity extra-class"><pre class="language-velocity"><code>-- 菜单 SQL
insert into sys_menu (menu_id, menu_name, parent_id, order_num, path, component, is_frame, is_cache, menu_type, visible, status, perms, icon, create_by, create_time, update_by, update_time, remark)
values(<span class="token variable">$<span class="token punctuation">{</span>table<span class="token punctuation">.</span>menuIds<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span>, '<span class="token variable">$<span class="token punctuation">{</span>functionName<span class="token punctuation">}</span></span>', '<span class="token variable">$<span class="token punctuation">{</span>parentMenuId<span class="token punctuation">}</span></span>', '1', '<span class="token variable">$<span class="token punctuation">{</span>businessName<span class="token punctuation">}</span></span>', '<span class="token variable">$<span class="token punctuation">{</span>moduleName<span class="token punctuation">}</span></span>/<span class="token variable">$<span class="token punctuation">{</span>businessName<span class="token punctuation">}</span></span>/index', 1, 0, 'C', '0', '0', '<span class="token variable">$<span class="token punctuation">{</span>permissionPrefix<span class="token punctuation">}</span></span>:list', '#', 'admin', sysdate(), '', null, '<span class="token variable">$<span class="token punctuation">{</span>functionName<span class="token punctuation">}</span></span>菜单');

-- 按钮 SQL
insert into sys_menu (menu_id, menu_name, parent_id, order_num, path, component, is_frame, is_cache, menu_type, visible, status, perms, icon, create_by, create_time, update_by, update_time, remark)
values(<span class="token variable">$<span class="token punctuation">{</span>table<span class="token punctuation">.</span>menuIds<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span>, '<span class="token variable">$<span class="token punctuation">{</span>functionName<span class="token punctuation">}</span></span>查询', <span class="token variable">$<span class="token punctuation">{</span>table<span class="token punctuation">.</span>menuIds<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span>, '1',  '#', '', 1, 0, 'F', '0', '0', '<span class="token variable">$<span class="token punctuation">{</span>permissionPrefix<span class="token punctuation">}</span></span>:query',        '#', 'admin', sysdate(), '', null, '');

insert into sys_menu (menu_id, menu_name, parent_id, order_num, path, component, is_frame, is_cache, menu_type, visible, status, perms, icon, create_by, create_time, update_by, update_time, remark)
values(<span class="token variable">$<span class="token punctuation">{</span>table<span class="token punctuation">.</span>menuIds<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span>, '<span class="token variable">$<span class="token punctuation">{</span>functionName<span class="token punctuation">}</span></span>新增', <span class="token variable">$<span class="token punctuation">{</span>table<span class="token punctuation">.</span>menuIds<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span>, '2',  '#', '', 1, 0, 'F', '0', '0', '<span class="token variable">$<span class="token punctuation">{</span>permissionPrefix<span class="token punctuation">}</span></span>:add',          '#', 'admin', sysdate(), '', null, '');

insert into sys_menu (menu_id, menu_name, parent_id, order_num, path, component, is_frame, is_cache, menu_type, visible, status, perms, icon, create_by, create_time, update_by, update_time, remark)
values(<span class="token variable">$<span class="token punctuation">{</span>table<span class="token punctuation">.</span>menuIds<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span>, '<span class="token variable">$<span class="token punctuation">{</span>functionName<span class="token punctuation">}</span></span>修改', <span class="token variable">$<span class="token punctuation">{</span>table<span class="token punctuation">.</span>menuIds<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span>, '3',  '#', '', 1, 0, 'F', '0', '0', '<span class="token variable">$<span class="token punctuation">{</span>permissionPrefix<span class="token punctuation">}</span></span>:edit',         '#', 'admin', sysdate(), '', null, '');

insert into sys_menu (menu_id, menu_name, parent_id, order_num, path, component, is_frame, is_cache, menu_type, visible, status, perms, icon, create_by, create_time, update_by, update_time, remark)
values(<span class="token variable">$<span class="token punctuation">{</span>table<span class="token punctuation">.</span>menuIds<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span>, '<span class="token variable">$<span class="token punctuation">{</span>functionName<span class="token punctuation">}</span></span>删除', <span class="token variable">$<span class="token punctuation">{</span>table<span class="token punctuation">.</span>menuIds<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span>, '4',  '#', '', 1, 0, 'F', '0', '0', '<span class="token variable">$<span class="token punctuation">{</span>permissionPrefix<span class="token punctuation">}</span></span>:remove',       '#', 'admin', sysdate(), '', null, '');

insert into sys_menu (menu_id, menu_name, parent_id, order_num, path, component, is_frame, is_cache, menu_type, visible, status, perms, icon, create_by, create_time, update_by, update_time, remark)
values(<span class="token variable">$<span class="token punctuation">{</span>table<span class="token punctuation">.</span>menuIds<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span>, '<span class="token variable">$<span class="token punctuation">{</span>functionName<span class="token punctuation">}</span></span>导出', <span class="token variable">$<span class="token punctuation">{</span>table<span class="token punctuation">.</span>menuIds<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">}</span></span>, '5',  '#', '', 1, 0, 'F', '0', '0', '<span class="token variable">$<span class="token punctuation">{</span>permissionPrefix<span class="token punctuation">}</span></span>:export',       '#', 'admin', sysdate(), '', null, '');

</code></pre></div></details> <p>其他数据源无关键逻辑代码省略..</p></div></div>  <div class="page-edit"><!----> <div class="tags"><a href="/tags/?tag=ruoyi-vue-plus" title="标签">#ruoyi-vue-plus</a><a href="/tags/?tag=%E4%BB%A3%E7%A0%81%E7%94%9F%E6%88%90" title="标签">#代码生成</a></div> <!----></div> <div class="page-nav-wapper"><!----> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/ruoyi-vue-plus/7/" class="prev">ruoyi-vue-plus-OSS功能</a></span> <span class="next"><a href="/ruoyi-vue-plus/9/">ruoyi-vue-plus-多数据源</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/ruoyi-vue-plus/17/"><div>
            ruoyi-vue-plus-数据加密
            <!----></div></a> <span class="date">05-01</span></dt></dl><dl><dd>02</dd> <dt><a href="/ruoyi-vue-plus/18/"><div>
            ruoyi-vue-plus-单元测试
            <!----></div></a> <span class="date">05-01</span></dt></dl><dl><dd>03</dd> <dt><a href="/ruoyi-vue-plus/97/"><div>
            ruoyi-vue-plus-工具篇
            <!----></div></a> <span class="date">04-21</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="Bozhu12" title="联系" target="_blank" class="iconfont icon-weixin"></a><a href="https://github.com/Bozhu12" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/user/home?id=448156561" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2019-2024
    <span> | <a href="https://beian.miit.gov.cn/">桂ICP备2022009417号-1</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <div class="body-bg" style="background:url() center center / cover no-repeat;opacity:0.5;"></div> <!----> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.d9970b58.js" defer></script><script src="/assets/js/2.b26d2d6f.js" defer></script><script src="/assets/js/108.047f07cd.js" defer></script>
  </body>
</html>
