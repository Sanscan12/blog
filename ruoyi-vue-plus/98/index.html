<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ruoyi-vue-plus-框架篇 | 柏竹</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="https://image.bozhu12.cc/myblog/Essay/favicon.ico">
    <script language="javascript" type="text/javascript" src="/js/pgmanor-self.js"></script>
    <script language="javascript" type="text/javascript" src="/js/echarts.min.js"></script>
    <meta name="description" content="学习足迹 , 记录生活!">
    <meta name="Sasncan12" content="柏竹博客, 个人技术博客, 前后端端 , 技术文档">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#bd93f9">
    
    <link rel="preload" href="/assets/css/0.styles.b41e82d5.css" as="style"><link rel="preload" href="/assets/js/app.59868afa.js" as="script"><link rel="preload" href="/assets/js/2.b26d2d6f.js" as="script"><link rel="preload" href="/assets/js/121.4d431d9c.js" as="script"><link rel="prefetch" href="/assets/js/10.40fa2b9f.js"><link rel="prefetch" href="/assets/js/100.e799b182.js"><link rel="prefetch" href="/assets/js/101.623403a0.js"><link rel="prefetch" href="/assets/js/102.bc3ab65d.js"><link rel="prefetch" href="/assets/js/103.302a4635.js"><link rel="prefetch" href="/assets/js/104.c6257ace.js"><link rel="prefetch" href="/assets/js/105.f35cc49f.js"><link rel="prefetch" href="/assets/js/106.400ec2b2.js"><link rel="prefetch" href="/assets/js/107.03e97ae6.js"><link rel="prefetch" href="/assets/js/108.d1d9a8b0.js"><link rel="prefetch" href="/assets/js/109.b04ead8b.js"><link rel="prefetch" href="/assets/js/11.b2bdd9db.js"><link rel="prefetch" href="/assets/js/110.f7e91174.js"><link rel="prefetch" href="/assets/js/111.62d4e75b.js"><link rel="prefetch" href="/assets/js/112.507dbf5e.js"><link rel="prefetch" href="/assets/js/113.04105445.js"><link rel="prefetch" href="/assets/js/114.04856557.js"><link rel="prefetch" href="/assets/js/115.3cc042b6.js"><link rel="prefetch" href="/assets/js/116.e985fcfc.js"><link rel="prefetch" href="/assets/js/117.a82b7a02.js"><link rel="prefetch" href="/assets/js/118.3864ee93.js"><link rel="prefetch" href="/assets/js/119.739cc195.js"><link rel="prefetch" href="/assets/js/12.f37270a3.js"><link rel="prefetch" href="/assets/js/120.8c0377db.js"><link rel="prefetch" href="/assets/js/122.5d236ac4.js"><link rel="prefetch" href="/assets/js/123.1453a96c.js"><link rel="prefetch" href="/assets/js/124.c187f9d3.js"><link rel="prefetch" href="/assets/js/125.c9cbdf8a.js"><link rel="prefetch" href="/assets/js/126.6e873349.js"><link rel="prefetch" href="/assets/js/127.f3b1ebde.js"><link rel="prefetch" href="/assets/js/128.1a2b8f60.js"><link rel="prefetch" href="/assets/js/129.98f67914.js"><link rel="prefetch" href="/assets/js/13.ff3bdc87.js"><link rel="prefetch" href="/assets/js/130.40cb1628.js"><link rel="prefetch" href="/assets/js/131.6acfdd64.js"><link rel="prefetch" href="/assets/js/132.118b5d70.js"><link rel="prefetch" href="/assets/js/133.c4de4cd5.js"><link rel="prefetch" href="/assets/js/134.69a22950.js"><link rel="prefetch" href="/assets/js/135.97a74579.js"><link rel="prefetch" href="/assets/js/136.3c7b99a9.js"><link rel="prefetch" href="/assets/js/137.8cbdc266.js"><link rel="prefetch" href="/assets/js/138.b4651a05.js"><link rel="prefetch" href="/assets/js/139.1efbac73.js"><link rel="prefetch" href="/assets/js/14.7e6d262f.js"><link rel="prefetch" href="/assets/js/140.2c901cba.js"><link rel="prefetch" href="/assets/js/141.9abd3dff.js"><link rel="prefetch" href="/assets/js/142.8024256b.js"><link rel="prefetch" href="/assets/js/143.e3ff19de.js"><link rel="prefetch" href="/assets/js/144.11967947.js"><link rel="prefetch" href="/assets/js/145.c7ea3574.js"><link rel="prefetch" href="/assets/js/146.4ae295ea.js"><link rel="prefetch" href="/assets/js/147.5c5a558a.js"><link rel="prefetch" href="/assets/js/148.cb24856a.js"><link rel="prefetch" href="/assets/js/149.e2c945a2.js"><link rel="prefetch" href="/assets/js/15.2e4f8cc2.js"><link rel="prefetch" href="/assets/js/150.f0a983f1.js"><link rel="prefetch" href="/assets/js/151.d1eaa2f0.js"><link rel="prefetch" href="/assets/js/152.658f7b6e.js"><link rel="prefetch" href="/assets/js/153.6bb29f46.js"><link rel="prefetch" href="/assets/js/154.44296cf7.js"><link rel="prefetch" href="/assets/js/155.29dcc552.js"><link rel="prefetch" href="/assets/js/156.7675d284.js"><link rel="prefetch" href="/assets/js/157.a5bd6128.js"><link rel="prefetch" href="/assets/js/158.6e1cf4e5.js"><link rel="prefetch" href="/assets/js/159.2d87ab7e.js"><link rel="prefetch" href="/assets/js/16.18b4c084.js"><link rel="prefetch" href="/assets/js/160.a5eb764e.js"><link rel="prefetch" href="/assets/js/161.d41eafb0.js"><link rel="prefetch" href="/assets/js/17.e2c44745.js"><link rel="prefetch" href="/assets/js/18.8388e865.js"><link rel="prefetch" href="/assets/js/19.f2139465.js"><link rel="prefetch" href="/assets/js/20.6802ce4f.js"><link rel="prefetch" href="/assets/js/21.f37f1ef1.js"><link rel="prefetch" href="/assets/js/22.cd5b0f4c.js"><link rel="prefetch" href="/assets/js/23.bba433ed.js"><link rel="prefetch" href="/assets/js/24.ce5d291d.js"><link rel="prefetch" href="/assets/js/25.48031560.js"><link rel="prefetch" href="/assets/js/26.468456c3.js"><link rel="prefetch" href="/assets/js/27.3cbd695a.js"><link rel="prefetch" href="/assets/js/28.8d873306.js"><link rel="prefetch" href="/assets/js/29.f5506360.js"><link rel="prefetch" href="/assets/js/3.be234d5b.js"><link rel="prefetch" href="/assets/js/30.5fecd315.js"><link rel="prefetch" href="/assets/js/31.4e81dcd5.js"><link rel="prefetch" href="/assets/js/32.1aabf060.js"><link rel="prefetch" href="/assets/js/33.7a2226f1.js"><link rel="prefetch" href="/assets/js/34.42421005.js"><link rel="prefetch" href="/assets/js/35.ee91ee76.js"><link rel="prefetch" href="/assets/js/36.47833f09.js"><link rel="prefetch" href="/assets/js/37.c5a09ae5.js"><link rel="prefetch" href="/assets/js/38.c948d014.js"><link rel="prefetch" href="/assets/js/39.a78540e1.js"><link rel="prefetch" href="/assets/js/4.5017c5ca.js"><link rel="prefetch" href="/assets/js/40.1b706b50.js"><link rel="prefetch" href="/assets/js/41.11ef63c0.js"><link rel="prefetch" href="/assets/js/42.00e110e9.js"><link rel="prefetch" href="/assets/js/43.e21776c9.js"><link rel="prefetch" href="/assets/js/44.255279ff.js"><link rel="prefetch" href="/assets/js/45.ef371806.js"><link rel="prefetch" href="/assets/js/46.c2867450.js"><link rel="prefetch" href="/assets/js/47.33f2d7e7.js"><link rel="prefetch" href="/assets/js/48.94d8abb8.js"><link rel="prefetch" href="/assets/js/49.bc8d702d.js"><link rel="prefetch" href="/assets/js/5.9c242416.js"><link rel="prefetch" href="/assets/js/50.a4c45e68.js"><link rel="prefetch" href="/assets/js/51.157514fb.js"><link rel="prefetch" href="/assets/js/52.4badcde4.js"><link rel="prefetch" href="/assets/js/53.a34ff845.js"><link rel="prefetch" href="/assets/js/54.3b99dd22.js"><link rel="prefetch" href="/assets/js/55.4f92ff2a.js"><link rel="prefetch" href="/assets/js/56.4eea5408.js"><link rel="prefetch" href="/assets/js/57.571dec1f.js"><link rel="prefetch" href="/assets/js/58.41cced1f.js"><link rel="prefetch" href="/assets/js/59.dee18dbb.js"><link rel="prefetch" href="/assets/js/6.20f6982a.js"><link rel="prefetch" href="/assets/js/60.8d1b8c5c.js"><link rel="prefetch" href="/assets/js/61.fba48ca4.js"><link rel="prefetch" href="/assets/js/62.9daf74ad.js"><link rel="prefetch" href="/assets/js/63.12e3cce7.js"><link rel="prefetch" href="/assets/js/64.5038c472.js"><link rel="prefetch" href="/assets/js/65.3e66e287.js"><link rel="prefetch" href="/assets/js/66.1ada48f0.js"><link rel="prefetch" href="/assets/js/67.7097ddc6.js"><link rel="prefetch" href="/assets/js/68.b81ad9cb.js"><link rel="prefetch" href="/assets/js/69.9acdaf69.js"><link rel="prefetch" href="/assets/js/7.c22f1339.js"><link rel="prefetch" href="/assets/js/70.830f0c74.js"><link rel="prefetch" href="/assets/js/71.9c4c3fdf.js"><link rel="prefetch" href="/assets/js/72.75e15070.js"><link rel="prefetch" href="/assets/js/73.049631e7.js"><link rel="prefetch" href="/assets/js/74.09204a44.js"><link rel="prefetch" href="/assets/js/75.de485637.js"><link rel="prefetch" href="/assets/js/76.3d610017.js"><link rel="prefetch" href="/assets/js/77.c5b4cdd8.js"><link rel="prefetch" href="/assets/js/78.4c50028c.js"><link rel="prefetch" href="/assets/js/79.737fdd97.js"><link rel="prefetch" href="/assets/js/8.a8e2447d.js"><link rel="prefetch" href="/assets/js/80.3ee2ea53.js"><link rel="prefetch" href="/assets/js/81.3dd7d268.js"><link rel="prefetch" href="/assets/js/82.4ad91f36.js"><link rel="prefetch" href="/assets/js/83.262783ec.js"><link rel="prefetch" href="/assets/js/84.16d2e181.js"><link rel="prefetch" href="/assets/js/85.5ca1bc34.js"><link rel="prefetch" href="/assets/js/86.a8bf2d59.js"><link rel="prefetch" href="/assets/js/87.3e285b84.js"><link rel="prefetch" href="/assets/js/88.d4514ef5.js"><link rel="prefetch" href="/assets/js/89.d7221e19.js"><link rel="prefetch" href="/assets/js/9.674ab0b1.js"><link rel="prefetch" href="/assets/js/90.5779624f.js"><link rel="prefetch" href="/assets/js/91.09482f61.js"><link rel="prefetch" href="/assets/js/92.11e3f66e.js"><link rel="prefetch" href="/assets/js/93.0f3b183b.js"><link rel="prefetch" href="/assets/js/94.ba40a568.js"><link rel="prefetch" href="/assets/js/95.766806b4.js"><link rel="prefetch" href="/assets/js/96.8aef4890.js"><link rel="prefetch" href="/assets/js/97.c40078bd.js"><link rel="prefetch" href="/assets/js/98.b63fa585.js"><link rel="prefetch" href="/assets/js/99.e0705a4f.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b41e82d5.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu have-body-img"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="https://image.bozhu12.cc/myblog/Essay/hendImage01.jpg" alt="柏竹" class="logo"> <span class="site-name can-hide">柏竹</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/backend/" class="nav-link">后端</a></div><div class="nav-item"><a href="/web/" class="nav-link">前端</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/other/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/Amway/" class="nav-link">应用推荐</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/friendLink/" class="nav-link">友链</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://image.bozhu12.cc/myblog/Essay/favicon.ico"> <div class="blogger-info"><h3>柏竹</h3> <span>奋斗柏竹</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/backend/" class="nav-link">后端</a></div><div class="nav-item"><a href="/web/" class="nav-link">前端</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/other/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/Amway/" class="nav-link">应用推荐</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/friendLink/" class="nav-link">友链</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Java基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JavaWeb</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>拓展技术</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>框架技术</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据库</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据结构</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Spring</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>SpringMVC</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>SpringBoot</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>SpringClound</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Ruoyi-Vue-Plus</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/ruoyi-vue-plus/1/" class="sidebar-link">ruoyi-vue-plus-基础功能</a></li><li><a href="/ruoyi-vue-plus/2/" class="sidebar-link">ruoyi-vue-plus-权限控制</a></li><li><a href="/ruoyi-vue-plus/3/" class="sidebar-link">ruoyi-vue-plus-表格操作</a></li><li><a href="/ruoyi-vue-plus/4/" class="sidebar-link">ruoyi-vue-plus-缓存功能</a></li><li><a href="/ruoyi-vue-plus/5/" class="sidebar-link">ruoyi-vue-plus-日志功能</a></li><li><a href="/ruoyi-vue-plus/6/" class="sidebar-link">ruoyi-vue-plus-线程相关</a></li><li><a href="/ruoyi-vue-plus/7/" class="sidebar-link">ruoyi-vue-plus-OSS功能</a></li><li><a href="/ruoyi-vue-plus/8/" class="sidebar-link">ruoyi-vue-plus-代码生成功能</a></li><li><a href="/ruoyi-vue-plus/9/" class="sidebar-link">ruoyi-vue-plus-多数据源</a></li><li><a href="/ruoyi-vue-plus/10/" class="sidebar-link">ruoyi-vue-plus-任务调度</a></li><li><a href="/ruoyi-vue-plus/11/" class="sidebar-link">ruoyi-vue-plus-监控功能</a></li><li><a href="/ruoyi-vue-plus/12/" class="sidebar-link">ruoyi-vue-plus-国际化</a></li><li><a href="/ruoyi-vue-plus/13/" class="sidebar-link">ruoyi-vue-plus-XSS功能</a></li><li><a href="/ruoyi-vue-plus/14/" class="sidebar-link">ruoyi-vue-plus-防重幂&amp;限流 功能</a></li><li><a href="/ruoyi-vue-plus/15/" class="sidebar-link">ruoyi-vue-plus-推送功能</a></li><li><a href="/ruoyi-vue-plus/16/" class="sidebar-link">ruoyi-vue-plus-序列化功能</a></li><li><a href="/ruoyi-vue-plus/17/" class="sidebar-link">ruoyi-vue-plus-数据加密</a></li><li><a href="/ruoyi-vue-plus/18/" class="sidebar-link">ruoyi-vue-plus-单元测试</a></li><li><a href="/ruoyi-vue-plus/96/" class="sidebar-link">ruoyi-vue-plus-前端篇</a></li><li><a href="/ruoyi-vue-plus/97/" class="sidebar-link">ruoyi-vue-plus-工具篇</a></li><li><a href="/ruoyi-vue-plus/98/" aria-current="page" class="active sidebar-link">ruoyi-vue-plus-框架篇</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/ruoyi-vue-plus/98/#整合-mybaits-plus" class="sidebar-link">整合 MyBaits Plus</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/ruoyi-vue-plus/98/#元数据自动填充" class="sidebar-link">元数据自动填充</a></li><li class="sidebar-sub-header level3"><a href="/ruoyi-vue-plus/98/#逻辑删除" class="sidebar-link">逻辑删除</a></li><li class="sidebar-sub-header level3"><a href="/ruoyi-vue-plus/98/#乐观锁" class="sidebar-link">乐观锁</a></li><li class="sidebar-sub-header level3"><a href="/ruoyi-vue-plus/98/#条件构造器" class="sidebar-link">条件构造器</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/ruoyi-vue-plus/98/#整合-redis" class="sidebar-link">整合 Redis</a></li><li class="sidebar-sub-header level2"><a href="/ruoyi-vue-plus/98/#整合-sa-token" class="sidebar-link">整合 Sa-Token</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/ruoyi-vue-plus/98/#拦截器注册" class="sidebar-link">拦截器注册</a></li><li class="sidebar-sub-header level3"><a href="/ruoyi-vue-plus/98/#排除拦截" class="sidebar-link">排除拦截</a></li><li class="sidebar-sub-header level3"><a href="/ruoyi-vue-plus/98/#用户权限管理" class="sidebar-link">用户权限管理</a></li><li class="sidebar-sub-header level3"><a href="/ruoyi-vue-plus/98/#dao缓存" class="sidebar-link">Dao缓存</a></li><li class="sidebar-sub-header level3"><a href="/ruoyi-vue-plus/98/#拦截原理" class="sidebar-link">拦截原理</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/ruoyi-vue-plus/98/#整合-日志监听" class="sidebar-link">整合 日志监听</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/ruoyi-vue-plus/98/#slf4j" class="sidebar-link">Slf4j</a></li><li class="sidebar-sub-header level3"><a href="/ruoyi-vue-plus/98/#p6spy" class="sidebar-link">p6spy</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/ruoyi-vue-plus/98/#整合-undertow" class="sidebar-link">整合 Undertow</a></li><li class="sidebar-sub-header level2"><a href="/ruoyi-vue-plus/98/#整合-openapi" class="sidebar-link">整合 OpenApi</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/ruoyi-vue-plus/98/#源码" class="sidebar-link">源码</a></li><li class="sidebar-sub-header level3"><a href="/ruoyi-vue-plus/98/#重写功能" class="sidebar-link">重写功能</a></li><li class="sidebar-sub-header level3"><a href="/ruoyi-vue-plus/98/#使用方式" class="sidebar-link">使用方式</a></li><li class="sidebar-sub-header level4"><a href="/ruoyi-vue-plus/98/#初始应用" class="sidebar-link">初始应用</a></li><li class="sidebar-sub-header level4"><a href="/ruoyi-vue-plus/98/#模块引用" class="sidebar-link">模块引用</a></li><li class="sidebar-sub-header level4"><a href="/ruoyi-vue-plus/98/#apifox自动导入" class="sidebar-link">apifox自动导入</a></li></ul></li></ul></li><li><a href="/ruoyi-vue-plus/99/" class="sidebar-link">ruoyi-vue-plus-问题解决</a></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper bg-style-1"><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/backend/#后端" data-v-06225672>后端</a></li><li data-v-06225672><a href="/backend/#Ruoyi-Vue-Plus" data-v-06225672>Ruoyi-Vue-Plus</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="javascript:;" data-v-06225672>柏竹</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2023-11-14</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">ruoyi-vue-plus-框架篇<!----></h1>  <div class="theme-vdoing-content content__default"><h2 id="整合-mybaits-plus"><a href="#整合-mybaits-plus" class="header-anchor">#</a> 整合 MyBaits Plus</h2> <p><strong>官方文档 :</strong> <a href="https://baomidou.com/pages/223848/#tablename" target="_blank" rel="noopener noreferrer">MyBaits Plus<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="元数据自动填充"><a href="#元数据自动填充" class="header-anchor">#</a> 元数据自动填充</h3> <p><strong>实体类 @TableField(fill = FieldFill.xxx) 填充策略</strong></p> <p>通过 <code>CreateAndUpdateMetaObjectHandler</code>类 实现元数据操作填充策略 , 重写 插入/更新 方法实现</p> <ul><li>insertFill()</li> <li>updateFill()</li></ul> <details class="custom-block details"><summary>点击代码展开</summary> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CreateAndUpdateMetaObjectHandler</span> <span class="token keyword">implements</span> <span class="token class-name">MetaObjectHandler</span> <span class="token punctuation">{</span>

   <span class="token annotation punctuation">@Override</span>
   <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">insertFill</span><span class="token punctuation">(</span><span class="token class-name">MetaObject</span> metaObject<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">try</span> <span class="token punctuation">{</span>
           <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">ObjectUtil</span><span class="token punctuation">.</span><span class="token function">isNotNull</span><span class="token punctuation">(</span>metaObject<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> metaObject<span class="token punctuation">.</span><span class="token function">getOriginalObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">instanceof</span> <span class="token class-name">BaseEntity</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
               <span class="token class-name">BaseEntity</span> baseEntity <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">BaseEntity</span><span class="token punctuation">)</span> metaObject<span class="token punctuation">.</span><span class="token function">getOriginalObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
               <span class="token class-name">Date</span> current <span class="token operator">=</span> <span class="token class-name">ObjectUtil</span><span class="token punctuation">.</span><span class="token function">isNotNull</span><span class="token punctuation">(</span>baseEntity<span class="token punctuation">.</span><span class="token function">getCreateTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                   <span class="token operator">?</span> baseEntity<span class="token punctuation">.</span><span class="token function">getCreateTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
               baseEntity<span class="token punctuation">.</span><span class="token function">setCreateTime</span><span class="token punctuation">(</span>current<span class="token punctuation">)</span><span class="token punctuation">;</span>
               baseEntity<span class="token punctuation">.</span><span class="token function">setUpdateTime</span><span class="token punctuation">(</span>current<span class="token punctuation">)</span><span class="token punctuation">;</span>
               <span class="token class-name">String</span> username <span class="token operator">=</span> <span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isNotBlank</span><span class="token punctuation">(</span>baseEntity<span class="token punctuation">.</span><span class="token function">getCreateBy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                   <span class="token operator">?</span> baseEntity<span class="token punctuation">.</span><span class="token function">getCreateBy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token function">getLoginUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
               <span class="token comment">// 当前已登录 且 创建人为空 则填充</span>
               baseEntity<span class="token punctuation">.</span><span class="token function">setCreateBy</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>
               <span class="token comment">// 当前已登录 且 更新人为空 则填充</span>
               baseEntity<span class="token punctuation">.</span><span class="token function">setUpdateBy</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>
           <span class="token punctuation">}</span>
       <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
           <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ServiceException</span><span class="token punctuation">(</span><span class="token string">&quot;自动注入异常 =&gt; &quot;</span> <span class="token operator">+</span> e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">HttpStatus</span><span class="token punctuation">.</span><span class="token constant">HTTP_UNAUTHORIZED</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>

   <span class="token annotation punctuation">@Override</span>
   <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">updateFill</span><span class="token punctuation">(</span><span class="token class-name">MetaObject</span> metaObject<span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token keyword">try</span> <span class="token punctuation">{</span>
           <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">ObjectUtil</span><span class="token punctuation">.</span><span class="token function">isNotNull</span><span class="token punctuation">(</span>metaObject<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> metaObject<span class="token punctuation">.</span><span class="token function">getOriginalObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">instanceof</span> <span class="token class-name">BaseEntity</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
               <span class="token class-name">BaseEntity</span> baseEntity <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">BaseEntity</span><span class="token punctuation">)</span> metaObject<span class="token punctuation">.</span><span class="token function">getOriginalObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
               <span class="token class-name">Date</span> current <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
               <span class="token comment">// 更新时间填充(不管为不为空)</span>
               baseEntity<span class="token punctuation">.</span><span class="token function">setUpdateTime</span><span class="token punctuation">(</span>current<span class="token punctuation">)</span><span class="token punctuation">;</span>
               <span class="token class-name">String</span> username <span class="token operator">=</span> <span class="token function">getLoginUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
               <span class="token comment">// 当前已登录 更新人填充(不管为不为空)</span>
               <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isNotBlank</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                   baseEntity<span class="token punctuation">.</span><span class="token function">setUpdateBy</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>
               <span class="token punctuation">}</span>
           <span class="token punctuation">}</span>
       <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
           <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ServiceException</span><span class="token punctuation">(</span><span class="token string">&quot;自动注入异常 =&gt; &quot;</span> <span class="token operator">+</span> e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">HttpStatus</span><span class="token punctuation">.</span><span class="token constant">HTTP_UNAUTHORIZED</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>

   <span class="token comment">/**
    * 获取登录用户名
    */</span>
   <span class="token keyword">private</span> <span class="token class-name">String</span> <span class="token function">getLoginUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
       <span class="token class-name">LoginUser</span> loginUser<span class="token punctuation">;</span>
       <span class="token keyword">try</span> <span class="token punctuation">{</span>
           loginUser <span class="token operator">=</span> <span class="token class-name">LoginHelper</span><span class="token punctuation">.</span><span class="token function">getLoginUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
           log<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">&quot;自动注入警告 =&gt; 用户未登录&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
           <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
       <span class="token punctuation">}</span>
       <span class="token keyword">return</span> <span class="token class-name">ObjectUtil</span><span class="token punctuation">.</span><span class="token function">isNotNull</span><span class="token punctuation">(</span>loginUser<span class="token punctuation">)</span> <span class="token operator">?</span> loginUser<span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
   <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div></details> <h3 id="逻辑删除"><a href="#逻辑删除" class="header-anchor">#</a> 逻辑删除</h3> <p>自行 在库添加 删除标识字段 , 对象实体类 删除成员变量 需要 <code>@TableLogic</code>注解 生效</p> <p>官方文档 : <a href="https://baomidou.com/pages/6b03c5/#%E6%AD%A5%E9%AA%A4-1-%E9%85%8D%E7%BD%AEcom-baomidou-mybatisplus-core-config-globalconfig-dbconfig" target="_blank" rel="noopener noreferrer">MyBaits Plus 逻辑删除<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="乐观锁"><a href="#乐观锁" class="header-anchor">#</a> 乐观锁</h3> <p>乐观锁根据 库字段进行判断是否修改 , 每次修改仅一个线程操作</p> <p>官方文档 : <a href="https://baomidou.com/pages/0d93c0/#optimisticlockerinnerinterceptor" target="_blank" rel="noopener noreferrer">MyBatis Plus 乐观锁<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><strong>应用</strong></p> <ol><li><p>添加配置插件 , <code>MybatisPlusConfig</code>配置类</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Bean</span>
<span class="token keyword">public</span> <span class="token class-name">MybatisPlusInterceptor</span> <span class="token function">mybatisPlusInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">MybatisPlusInterceptor</span> interceptor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MybatisPlusInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 数据权限处理</span>
    interceptor<span class="token punctuation">.</span><span class="token function">addInnerInterceptor</span><span class="token punctuation">(</span><span class="token function">dataPermissionInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 分页插件</span>
    interceptor<span class="token punctuation">.</span><span class="token function">addInnerInterceptor</span><span class="token punctuation">(</span><span class="token function">paginationInnerInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 乐观锁插件</span>
    interceptor<span class="token punctuation">.</span><span class="token function">addInnerInterceptor</span><span class="token punctuation">(</span><span class="token function">optimisticLockerInnerInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> interceptor<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * 乐观锁插件
 */</span>
<span class="token keyword">public</span> <span class="token class-name">OptimisticLockerInnerInterceptor</span> <span class="token function">optimisticLockerInnerInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">OptimisticLockerInnerInterceptor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p>自行 在库添加 版本标识字段 , 对象实体类 版本成员变量 需要 <code>@Version</code>注解 生效</p></li></ol> <h3 id="条件构造器"><a href="#条件构造器" class="header-anchor">#</a> 条件构造器</h3> <p>执行SQL 可以根据约束得到预期想要的结果 , MyBatis Plus 提供了如下两个约束的类 :</p> <ul><li>QueryWrapper&lt;T&gt;</li> <li>LambdaQueryWrapper&lt;T&gt;</li></ul> <blockquote><p>两者用法差不多 , 但唯独不同的就是 , 指定约束字段的参数 , LambdaQueryWrapper可根据 实体类的方法指定 , 而另一个通过 库字段名 指定 , 剩下的懂得都懂</p></blockquote> <p>官方文档 : <a href="https://baomidou.com/pages/10c804/#abstractwrapper" target="_blank" rel="noopener noreferrer">MyBatis Plus 条件构造器<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><strong>对象属性</strong></p> <ul><li>SqlSegmet (SQL约束片段)</li> <li>TargetSql (简写 目标SQL)</li> <li>ParamAlias (参数别名)</li> <li>ParamNameValuePairs (参数变量&amp;变量值)</li> <li>CustomSqlSegment (完整SQL)</li></ul> <p><strong>条件构造器转化</strong></p> <p>有些情况 LambdaQueryWrapper 不能满足更多功能的应用 , 因此采用 QueryWrapper , 可以通过以下方式 两种混合应用</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">QueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> qw <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">QueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token class-name">LambdaQueryWrapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> law <span class="token operator">=</span> qw<span class="token punctuation">.</span><span class="token function">lambda</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>自定义Select拓展</strong></p> <p>在默认情况下查询仅查询实体类 , select 拓展其他字段应用则会查不到 , 解决方案 :</p> <ul><li>在实体类添加成员变量 , 且SQL字段的 别名和该类的成员变量名一致</li> <li>采用Maps形式查询接收变量 , 但要自行解决对象转化环节</li></ul> <h2 id="整合-redis"><a href="#整合-redis" class="header-anchor">#</a> 整合 Redis</h2> <p>采用Redisson通信 , 其优点就不用多说了</p> <p><strong>依赖</strong></p> <ul><li>redisson-spring-boot-starter</li> <li>lock4j-redisson-spring-boot-starter</li> <li>redisson-spring-data-27</li></ul> <p><strong>配置</strong></p> <p>映射配置文件 : <code>RedissonProperties</code></p> <p>配置类 : <code>RedisConfig</code></p> <p>应用 :</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token class-name">RedissonClient</span> <span class="token constant">CLIENT</span> <span class="token operator">=</span> <span class="token class-name">SpringUtils</span><span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token class-name">RedissonClient</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>工具类 : <a href="#RedisUtils"><code>RedisUtils</code></a> (应用实例点击跳转)</p> <p><strong>监听</strong></p> <p>订阅监听 生效 需要修改 Reids配置 <code>notify-keyspace-events</code> , 其配置值 :</p> <ol><li><strong>K</strong>: 开启键空间事件通知 , 发布在<code>__keyspace@&lt;db&gt;__:*</code>频道上</li> <li><strong>E</strong>: 开启键事件事件通知 , 发布在<code>__keyevent@&lt;db&gt;__:*</code>频道上</li> <li><strong>g</strong>: 开启一般命令事件通知, 通常是不指定对象类型的命令 , 例如<strong>DEL</strong> , <strong>RENAME</strong>等等</li> <li><strong>$</strong>: 开启操作字符串命令事件通知</li> <li><strong>l</strong>: 开启操作列表对象事件通知</li> <li><strong>s</strong>: 开启操作集合对象事件通知</li> <li><strong>h</strong>: 开启操作散列对象事件通知</li> <li><strong>z</strong>: 开启操作有序集合对象事件通知</li> <li><strong>x</strong>: 开启键的过期事件通知</li> <li><strong>e</strong>: 开启键的淘汰事件通知</li> <li><strong>A</strong>: 等价于<code>g$lshzxe</code> , 如果<code>notify-keyspace-events</code>被设置为<strong>AKE</strong>事件 , 则意味着开启所有键以及所有事件的通知。</li></ol> <blockquote><p>修改配置后需要重启Reids服务生效配置</p></blockquote> <h2 id="整合-sa-token"><a href="#整合-sa-token" class="header-anchor">#</a> 整合 Sa-Token</h2> <p>身份权限认证 等...</p> <p>官方文档 : <a href="https://sa-token.cc/doc.html#/" target="_blank" rel="noopener noreferrer">https://sa-token.cc<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="拦截器注册"><a href="#拦截器注册" class="header-anchor">#</a> 拦截器注册</h3> <p><code>com.ruoyi.framework.config.SaTokenConfig</code></p> <p>对所有接口都进行登录拦截校验</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@RequiredArgsConstructor</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SaTokenConfig</span> <span class="token keyword">implements</span> <span class="token class-name">WebMvcConfigurer</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">SecurityProperties</span> securityProperties<span class="token punctuation">;</span>

    <span class="token comment">/**
     * 注册sa-token的拦截器
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addInterceptors</span><span class="token punctuation">(</span><span class="token class-name">InterceptorRegistry</span> registry<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 注册路由拦截器，自定义验证规则</span>
        registry<span class="token punctuation">.</span><span class="token function">addInterceptor</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">SaInterceptor</span><span class="token punctuation">(</span>handler <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token class-name">AllUrlHandler</span> allUrlHandler <span class="token operator">=</span> <span class="token class-name">SpringUtils</span><span class="token punctuation">.</span><span class="token function">getBean</span><span class="token punctuation">(</span><span class="token class-name">AllUrlHandler</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// 登录验证 -- 排除多个路径</span>
            <span class="token class-name">SaRouter</span>
                <span class="token comment">// 获取所有的</span>
                <span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>allUrlHandler<span class="token punctuation">.</span><span class="token function">getUrls</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token comment">// 对未排除的路径进行检查</span>
                <span class="token punctuation">.</span><span class="token function">check</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
                    <span class="token comment">// 检查是否登录 是否有token</span>
                    <span class="token class-name">StpUtil</span><span class="token punctuation">.</span><span class="token function">checkLogin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addPathPatterns</span><span class="token punctuation">(</span><span class="token string">&quot;/**&quot;</span><span class="token punctuation">)</span>
            <span class="token comment">// 排除不需要拦截的路径</span>
            <span class="token punctuation">.</span><span class="token function">excludePathPatterns</span><span class="token punctuation">(</span>securityProperties<span class="token punctuation">.</span><span class="token function">getExcludes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>重写 saTokenDao 应用Bean , 优化缓存 , 改为Redis</p></blockquote> <h3 id="排除拦截"><a href="#排除拦截" class="header-anchor">#</a> 排除拦截</h3> <p>指定路径不受认证权限相关约束 , 配置类中 指定排除拦截 <em>securityProperties.getExcludes()</em></p> <p><code>application.yml</code> 配置文件</p> <div class="language-yml extra-class"><pre class="language-yml"><code><span class="token key atrule">security</span><span class="token punctuation">:</span>
  <span class="token comment"># 排除路径</span>
  <span class="token key atrule">excludes</span><span class="token punctuation">:</span>
    <span class="token comment"># 静态资源</span>
    <span class="token punctuation">-</span> /<span class="token important">*.html</span>
    <span class="token punctuation">-</span> /<span class="token important">**/*.html</span>
    <span class="token punctuation">-</span> /<span class="token important">**/*.css</span>
    <span class="token punctuation">-</span> /<span class="token important">**/*.js</span>
    <span class="token comment"># 公共路径</span>
    <span class="token punctuation">-</span> /favicon.ico
    <span class="token punctuation">-</span> /error
    <span class="token comment"># swagger 文档配置</span>
    <span class="token punctuation">-</span> /<span class="token important">*/api-docs</span>
    <span class="token punctuation">-</span> /<span class="token important">*/api-docs/**</span>
    <span class="token comment"># actuator 监控配置</span>
    <span class="token punctuation">-</span> /actuator
    <span class="token punctuation">-</span> /actuator/<span class="token important">**</span>
</code></pre></div><h3 id="用户权限管理"><a href="#用户权限管理" class="header-anchor">#</a> 用户权限管理</h3> <p>Sa-Token根据 重写 <code>StpInterface</code>类 , 获取用户的权限信息 <em>菜单权限标识 / 角色权限</em>  , 以便在注解中校验使用</p> <p>官方文档 : <a href="https://sa-token.cc/doc.html#/use/jur-auth" target="_blank" rel="noopener noreferrer">https://sa-token.cc/doc.html#/use/jur-auth<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <details class="custom-block details"><summary>点击代码展开</summary> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SaPermissionImpl</span> <span class="token keyword">implements</span> <span class="token class-name">StpInterface</span> <span class="token punctuation">{</span>

    <span class="token comment">/**
     * 获取菜单权限列表
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">getPermissionList</span><span class="token punctuation">(</span><span class="token class-name">Object</span> loginId<span class="token punctuation">,</span> <span class="token class-name">String</span> loginType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">LoginUser</span> loginUser <span class="token operator">=</span> <span class="token class-name">LoginHelper</span><span class="token punctuation">.</span><span class="token function">getLoginUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">UserType</span> userType <span class="token operator">=</span> <span class="token class-name">UserType</span><span class="token punctuation">.</span><span class="token function">getUserType</span><span class="token punctuation">(</span>loginUser<span class="token punctuation">.</span><span class="token function">getUserType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>userType <span class="token operator">==</span> <span class="token class-name">UserType</span><span class="token punctuation">.</span><span class="token constant">SYS_USER</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>loginUser<span class="token punctuation">.</span><span class="token function">getMenuPermission</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>userType <span class="token operator">==</span> <span class="token class-name">UserType</span><span class="token punctuation">.</span><span class="token constant">APP_USER</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 其他端 自行根据业务编写</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 获取角色权限列表
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">getRoleList</span><span class="token punctuation">(</span><span class="token class-name">Object</span> loginId<span class="token punctuation">,</span> <span class="token class-name">String</span> loginType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">LoginUser</span> loginUser <span class="token operator">=</span> <span class="token class-name">LoginHelper</span><span class="token punctuation">.</span><span class="token function">getLoginUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">UserType</span> userType <span class="token operator">=</span> <span class="token class-name">UserType</span><span class="token punctuation">.</span><span class="token function">getUserType</span><span class="token punctuation">(</span>loginUser<span class="token punctuation">.</span><span class="token function">getUserType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>userType <span class="token operator">==</span> <span class="token class-name">UserType</span><span class="token punctuation">.</span><span class="token constant">SYS_USER</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>loginUser<span class="token punctuation">.</span><span class="token function">getRolePermission</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>userType <span class="token operator">==</span> <span class="token class-name">UserType</span><span class="token punctuation">.</span><span class="token constant">APP_USER</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 其他端 自行根据业务编写</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></details> <h3 id="dao缓存"><a href="#dao缓存" class="header-anchor">#</a> Dao缓存</h3> <p>Sa-Token 持久层缓存是基于 本机内存Map存储 , 一旦重启宕机则会丢失数据</p> <p>因此整合了 Redis缓存应用</p> <details class="custom-block details"><summary>点击代码展开</summary> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PlusSaTokenDao</span> <span class="token keyword">implements</span> <span class="token class-name">SaTokenDao</span> <span class="token punctuation">{</span>

    <span class="token comment">/**
     * 获取Value，如无返空
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">RedisUtils</span><span class="token punctuation">.</span><span class="token function">getCacheObject</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 写入Value，并设定存活时间 (单位: 秒)
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">set</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">String</span> value<span class="token punctuation">,</span> <span class="token keyword">long</span> timeout<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>timeout <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> timeout <span class="token operator">&lt;=</span> <span class="token class-name">SaTokenDao</span><span class="token punctuation">.</span><span class="token constant">NOT_VALUE_EXPIRE</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 判断是否为永不过期</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>timeout <span class="token operator">==</span> <span class="token class-name">SaTokenDao</span><span class="token punctuation">.</span><span class="token constant">NEVER_EXPIRE</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">RedisUtils</span><span class="token punctuation">.</span><span class="token function">setCacheObject</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token class-name">RedisUtils</span><span class="token punctuation">.</span><span class="token function">setCacheObject</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> <span class="token class-name">Duration</span><span class="token punctuation">.</span><span class="token function">ofSeconds</span><span class="token punctuation">(</span>timeout<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 修修改指定key-value键值对 (过期时间不变)
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">String</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">long</span> expire <span class="token operator">=</span> <span class="token function">getTimeout</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// -2 = 无此键</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>expire <span class="token operator">==</span> <span class="token class-name">SaTokenDao</span><span class="token punctuation">.</span><span class="token constant">NOT_VALUE_EXPIRE</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> expire<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 删除Value
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">delete</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">RedisUtils</span><span class="token punctuation">.</span><span class="token function">deleteObject</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 获取Value的剩余存活时间 (单位: 秒)
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">long</span> <span class="token function">getTimeout</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">long</span> timeout <span class="token operator">=</span> <span class="token class-name">RedisUtils</span><span class="token punctuation">.</span><span class="token function">getTimeToLive</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> timeout <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">?</span> timeout <span class="token operator">:</span> timeout <span class="token operator">/</span> <span class="token number">1000</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 修改Value的剩余存活时间 (单位: 秒)
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">updateTimeout</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token keyword">long</span> timeout<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 判断是否想要设置为永久</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>timeout <span class="token operator">==</span> <span class="token class-name">SaTokenDao</span><span class="token punctuation">.</span><span class="token constant">NEVER_EXPIRE</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">long</span> expire <span class="token operator">=</span> <span class="token function">getTimeout</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>expire <span class="token operator">==</span> <span class="token class-name">SaTokenDao</span><span class="token punctuation">.</span><span class="token constant">NEVER_EXPIRE</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// 如果其已经被设置为永久，则不作任何处理</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token comment">// 如果尚未被设置为永久，那么再次set一次</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">,</span> timeout<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">RedisUtils</span><span class="token punctuation">.</span><span class="token function">expire</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token class-name">Duration</span><span class="token punctuation">.</span><span class="token function">ofSeconds</span><span class="token punctuation">(</span>timeout<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token comment">/**
     * 获取Object，如无返空
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Object</span> <span class="token function">getObject</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">RedisUtils</span><span class="token punctuation">.</span><span class="token function">getCacheObject</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 写入Object，并设定存活时间 (单位: 秒)
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setObject</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">Object</span> object<span class="token punctuation">,</span> <span class="token keyword">long</span> timeout<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>timeout <span class="token operator">==</span> <span class="token number">0</span> <span class="token operator">||</span> timeout <span class="token operator">&lt;=</span> <span class="token class-name">SaTokenDao</span><span class="token punctuation">.</span><span class="token constant">NOT_VALUE_EXPIRE</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 判断是否为永不过期</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>timeout <span class="token operator">==</span> <span class="token class-name">SaTokenDao</span><span class="token punctuation">.</span><span class="token constant">NEVER_EXPIRE</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">RedisUtils</span><span class="token punctuation">.</span><span class="token function">setCacheObject</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> object<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token class-name">RedisUtils</span><span class="token punctuation">.</span><span class="token function">setCacheObject</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> object<span class="token punctuation">,</span> <span class="token class-name">Duration</span><span class="token punctuation">.</span><span class="token function">ofSeconds</span><span class="token punctuation">(</span>timeout<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 更新Object (过期时间不变)
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">updateObject</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">Object</span> object<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">long</span> expire <span class="token operator">=</span> <span class="token function">getObjectTimeout</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// -2 = 无此键</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>expire <span class="token operator">==</span> <span class="token class-name">SaTokenDao</span><span class="token punctuation">.</span><span class="token constant">NOT_VALUE_EXPIRE</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setObject</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> object<span class="token punctuation">,</span> expire<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 删除Object
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">deleteObject</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">RedisUtils</span><span class="token punctuation">.</span><span class="token function">deleteObject</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 获取Object的剩余存活时间 (单位: 秒)
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">long</span> <span class="token function">getObjectTimeout</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">long</span> timeout <span class="token operator">=</span> <span class="token class-name">RedisUtils</span><span class="token punctuation">.</span><span class="token function">getTimeToLive</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> timeout <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">?</span> timeout <span class="token operator">:</span> timeout <span class="token operator">/</span> <span class="token number">1000</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 修改Object的剩余存活时间 (单位: 秒)
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">updateObjectTimeout</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token keyword">long</span> timeout<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 判断是否想要设置为永久</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>timeout <span class="token operator">==</span> <span class="token class-name">SaTokenDao</span><span class="token punctuation">.</span><span class="token constant">NEVER_EXPIRE</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">long</span> expire <span class="token operator">=</span> <span class="token function">getObjectTimeout</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>expire <span class="token operator">==</span> <span class="token class-name">SaTokenDao</span><span class="token punctuation">.</span><span class="token constant">NEVER_EXPIRE</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">// 如果其已经被设置为永久，则不作任何处理</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token comment">// 如果尚未被设置为永久，那么再次set一次</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setObject</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getObject</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">,</span> timeout<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">RedisUtils</span><span class="token punctuation">.</span><span class="token function">expire</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token class-name">Duration</span><span class="token punctuation">.</span><span class="token function">ofSeconds</span><span class="token punctuation">(</span>timeout<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token comment">/**
     * 搜索数据
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">searchData</span><span class="token punctuation">(</span><span class="token class-name">String</span> prefix<span class="token punctuation">,</span> <span class="token class-name">String</span> keyword<span class="token punctuation">,</span> <span class="token keyword">int</span> start<span class="token punctuation">,</span> <span class="token keyword">int</span> size<span class="token punctuation">,</span> <span class="token keyword">boolean</span> sortType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> keys <span class="token operator">=</span> <span class="token class-name">RedisUtils</span><span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>prefix <span class="token operator">+</span> <span class="token string">&quot;*&quot;</span> <span class="token operator">+</span> keyword <span class="token operator">+</span> <span class="token string">&quot;*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>keys<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">SaFoxUtil</span><span class="token punctuation">.</span><span class="token function">searchList</span><span class="token punctuation">(</span>list<span class="token punctuation">,</span> start<span class="token punctuation">,</span> size<span class="token punctuation">,</span> sortType<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></details> <h3 id="拦截原理"><a href="#拦截原理" class="header-anchor">#</a> 拦截原理</h3> <p>首先分析接口请求被拦截的过程 : (仅展示核心部分)</p> <ol><li>进入前置拦截器 <em>SaInterceptor.preHandle()</em></li> <li>判断方法是否注解了 <code>@SaIgnore</code> (跳过整个Sa-Token拦截)
<em>SaStrategy.instance.isAnnotationPresent.apply(method, SaIgnore.class)</em></li> <li>鉴权权限注解 (所有相关注解校验)
<em>SaStrategy.instance.checkMethodAnnotation.accept(method);</em> <ol><li>对 类/方法 的所有相关注解校验</li> <li>逐个判断注解对象是否存在 , 存在则进行响应的注解校验</li></ol></li> <li>最后校验 <em>auth.run(handler);</em> , 此方法会调用会 <code>SaInterceptor.auth</code>(构造方法中的lambda表达式)</li> <li>获取所有路径 <em>AllUrlHandler.getUrls()</em> (在Bean中调取) 并匹配当中获取的路径</li> <li>校验是否有token <em>StpUtil.checkLogin();</em></li></ol> <p>Sa-Token 自定义拦截类<code>cn.dev33.satoken.interceptor.SaInterceptor</code></p> <details class="custom-block details"><summary>点击代码展开</summary> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SaInterceptor</span> <span class="token keyword">implements</span> <span class="token class-name">HandlerInterceptor</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token class-name">SaInterceptor</span><span class="token punctuation">(</span><span class="token class-name">SaParamFunction</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> auth<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>auth <span class="token operator">=</span> auth<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
    
	<span class="token comment">/**
	 * 每次请求之前触发的方法 
	 */</span>
	<span class="token annotation punctuation">@Override</span>
	<span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token string">&quot;all&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">preHandle</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">Object</span> handler<span class="token punctuation">)</span>
			<span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>

		<span class="token keyword">try</span> <span class="token punctuation">{</span>

			<span class="token comment">// 这里必须确保 handler 是 HandlerMethod 类型时，才能进行注解鉴权</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>isAnnotation <span class="token operator">&amp;&amp;</span> handler <span class="token keyword">instanceof</span> <span class="token class-name">HandlerMethod</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				
				<span class="token comment">// 获取此请求对应的 Method 处理函数 </span>
				<span class="token class-name">Method</span> method <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">HandlerMethod</span><span class="token punctuation">)</span> handler<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

				<span class="token comment">// 如果此 Method 或其所属 Class 标注了 @SaIgnore，则忽略掉鉴权</span>
				<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token class-name">SaStrategy</span><span class="token punctuation">.</span>instance<span class="token punctuation">.</span>isAnnotationPresent<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>method<span class="token punctuation">,</span> <span class="token class-name">SaIgnore</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token comment">// 注意这里直接就退出整个鉴权了，最底部的 auth.run() 路由拦截鉴权也被跳出了</span>
					<span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>

				<span class="token comment">// 执行注解鉴权</span>
				<span class="token class-name">SaStrategy</span><span class="token punctuation">.</span>instance<span class="token punctuation">.</span>checkMethodAnnotation<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span>method<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
			
			<span class="token comment">// Auth 路由拦截鉴权校验</span>
			auth<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>handler<span class="token punctuation">)</span><span class="token punctuation">;</span>
			
		<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">StopMatchException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token comment">// StopMatchException 异常代表：停止匹配，进入Controller</span>

		<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">BackResultException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token comment">// BackResultException 异常代表：停止匹配，向前端输出结果</span>
			<span class="token comment">// 		请注意此处默认 Content-Type 为 text/plain，如果需要返回 JSON 信息，需要在 back 前自行设置 Content-Type 为 application/json</span>
			<span class="token comment">// 		例如：SaHolder.getResponse().setHeader(&quot;Content-Type&quot;, &quot;application/json;charset=UTF-8&quot;);</span>
			<span class="token keyword">if</span><span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">getContentType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
				response<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">&quot;text/plain; charset=utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
			<span class="token punctuation">}</span>
			response<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
		
		<span class="token comment">// 通过验证 </span>
		<span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></details> <p>Sa-Token 策略对象 <code>cn.dev33.satoken.strategy.SaStrategy</code></p> <ol><li>鉴定注解主要入口
<em>SaStrategy.instance.checkMethodAnnotation.accept(method);</em></li> <li>分别校验 类 和 方法 (类能够对当前Controller中的所有接口校验生效)</li> <li>调用 checkElementAnnotation 进行处理不同的校验类型</li> <li>...</li></ol> <details class="custom-block details"><summary>点击代码展开</summary> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">SaStrategy</span> <span class="token punctuation">{</span>
	
    <span class="token comment">/**
	 * 获取 SaStrategy 对象的单例引用
	 */</span>
	<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">SaStrategy</span> instance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SaStrategy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
	<span class="token comment">/**
	 * 对一个 [Method] 对象进行注解校验 （注解鉴权内部实现）
	 */</span>
	<span class="token keyword">public</span> <span class="token class-name">SaCheckMethodAnnotationFunction</span> checkMethodAnnotation <span class="token operator">=</span> <span class="token punctuation">(</span>method<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>

		<span class="token comment">// 先校验 Method 所属 Class 上的注解</span>
		instance<span class="token punctuation">.</span>checkElementAnnotation<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span>method<span class="token punctuation">.</span><span class="token function">getDeclaringClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 再校验 Method 上的注解</span>
		instance<span class="token punctuation">.</span>checkElementAnnotation<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span>method<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>

	<span class="token comment">/**
	 * 对一个 [元素] 对象进行注解校验 （注解鉴权内部实现）
	 */</span>
	<span class="token keyword">public</span> <span class="token class-name">SaCheckElementAnnotationFunction</span> checkElementAnnotation <span class="token operator">=</span> <span class="token punctuation">(</span>element<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>

		<span class="token comment">// 校验 @SaCheckLogin 注解</span>
		<span class="token class-name">SaCheckLogin</span> checkLogin <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">SaCheckLogin</span><span class="token punctuation">)</span> <span class="token class-name">SaStrategy</span><span class="token punctuation">.</span>instance<span class="token punctuation">.</span>getAnnotation<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>element<span class="token punctuation">,</span> <span class="token class-name">SaCheckLogin</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>checkLogin <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token class-name">SaManager</span><span class="token punctuation">.</span><span class="token function">getStpLogic</span><span class="token punctuation">(</span>checkLogin<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">checkByAnnotation</span><span class="token punctuation">(</span>checkLogin<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token comment">// 校验 @SaCheckRole 注解</span>
		<span class="token class-name">SaCheckRole</span> checkRole <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">SaCheckRole</span><span class="token punctuation">)</span> <span class="token class-name">SaStrategy</span><span class="token punctuation">.</span>instance<span class="token punctuation">.</span>getAnnotation<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>element<span class="token punctuation">,</span> <span class="token class-name">SaCheckRole</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>checkRole <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token class-name">SaManager</span><span class="token punctuation">.</span><span class="token function">getStpLogic</span><span class="token punctuation">(</span>checkRole<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">checkByAnnotation</span><span class="token punctuation">(</span>checkRole<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token comment">// 校验 @SaCheckPermission 注解</span>
		<span class="token class-name">SaCheckPermission</span> checkPermission <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">SaCheckPermission</span><span class="token punctuation">)</span> <span class="token class-name">SaStrategy</span><span class="token punctuation">.</span>instance<span class="token punctuation">.</span>getAnnotation<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>element<span class="token punctuation">,</span> <span class="token class-name">SaCheckPermission</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>checkPermission <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token class-name">SaManager</span><span class="token punctuation">.</span><span class="token function">getStpLogic</span><span class="token punctuation">(</span>checkPermission<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">checkByAnnotation</span><span class="token punctuation">(</span>checkPermission<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token comment">// 校验 @SaCheckSafe 注解</span>
		<span class="token class-name">SaCheckSafe</span> checkSafe <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">SaCheckSafe</span><span class="token punctuation">)</span> <span class="token class-name">SaStrategy</span><span class="token punctuation">.</span>instance<span class="token punctuation">.</span>getAnnotation<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>element<span class="token punctuation">,</span> <span class="token class-name">SaCheckSafe</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>checkSafe <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token class-name">SaManager</span><span class="token punctuation">.</span><span class="token function">getStpLogic</span><span class="token punctuation">(</span>checkSafe<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">checkByAnnotation</span><span class="token punctuation">(</span>checkSafe<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token comment">// 校验 @SaCheckDisable 注解</span>
		<span class="token class-name">SaCheckDisable</span> checkDisable <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">SaCheckDisable</span><span class="token punctuation">)</span> <span class="token class-name">SaStrategy</span><span class="token punctuation">.</span>instance<span class="token punctuation">.</span>getAnnotation<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>element<span class="token punctuation">,</span> <span class="token class-name">SaCheckDisable</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>checkDisable <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token class-name">SaManager</span><span class="token punctuation">.</span><span class="token function">getStpLogic</span><span class="token punctuation">(</span>checkDisable<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">checkByAnnotation</span><span class="token punctuation">(</span>checkDisable<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token comment">// 校验 @SaCheckBasic 注解</span>
		<span class="token class-name">SaCheckBasic</span> checkBasic <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">SaCheckBasic</span><span class="token punctuation">)</span> <span class="token class-name">SaStrategy</span><span class="token punctuation">.</span>instance<span class="token punctuation">.</span>getAnnotation<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>element<span class="token punctuation">,</span> <span class="token class-name">SaCheckBasic</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>checkBasic <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token class-name">SaBasicUtil</span><span class="token punctuation">.</span><span class="token function">check</span><span class="token punctuation">(</span>checkBasic<span class="token punctuation">.</span><span class="token function">realm</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> checkBasic<span class="token punctuation">.</span><span class="token function">account</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>

		<span class="token comment">// 校验 @SaCheckOr 注解</span>
		<span class="token class-name">SaCheckOr</span> checkOr <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">SaCheckOr</span><span class="token punctuation">)</span> <span class="token class-name">SaStrategy</span><span class="token punctuation">.</span>instance<span class="token punctuation">.</span>getAnnotation<span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>element<span class="token punctuation">,</span> <span class="token class-name">SaCheckOr</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">if</span><span class="token punctuation">(</span>checkOr <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
			<span class="token class-name">SaStrategy</span><span class="token punctuation">.</span>instance<span class="token punctuation">.</span>checkOrAnnotation<span class="token punctuation">.</span><span class="token function">accept</span><span class="token punctuation">(</span>checkOr<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></details> <h2 id="整合-日志监听"><a href="#整合-日志监听" class="header-anchor">#</a> 整合 日志监听</h2> <h3 id="slf4j"><a href="#slf4j" class="header-anchor">#</a> Slf4j</h3> <p><strong>SLF4j官方文档 :</strong></p> <ul><li><a href="https://springdoc.cn/spring-boot/features#features.logging" target="_blank" rel="noopener noreferrer">https://springdoc.cn/spring-boot/features#features.logging<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.slf4j.org/manual.html" target="_blank" rel="noopener noreferrer">https://www.slf4j.org/manual.html<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.slf4j.org/apidocs/index.html" target="_blank" rel="noopener noreferrer">https://www.slf4j.org/apidocs/index.html<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p><strong>Maven依赖</strong></p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.18.30<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><strong>日志配置</strong></p> <div class="language-yaml extra-class"><pre class="language-yaml"><code><span class="token comment"># 日志配置</span>
<span class="token key atrule">logging</span><span class="token punctuation">:</span>
  <span class="token key atrule">level</span><span class="token punctuation">:</span>
    <span class="token key atrule">com.ruoyi</span><span class="token punctuation">:</span> @logging.level@
    <span class="token key atrule">org.springframework</span><span class="token punctuation">:</span> warn
    <span class="token key atrule">com.bozhu</span><span class="token punctuation">:</span> trace
  <span class="token key atrule">config</span><span class="token punctuation">:</span> classpath<span class="token punctuation">:</span>logback<span class="token punctuation">-</span>plus.xml
</code></pre></div><p><strong>环境变量配置</strong></p> <details class="custom-block details"><summary>点击展开 **pom.xml**</summary> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token comment">&lt;!-- 其他省略 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>profiles</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>profile</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span>local<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
            <span class="token comment">&lt;!-- 环境标识，需要与配置文件的名称相对应 --&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>profiles.active</span><span class="token punctuation">&gt;</span></span>local<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>profiles.active</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logging.level</span><span class="token punctuation">&gt;</span></span>debug<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>logging.level</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>profile</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>profile</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span>dev<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
            <span class="token comment">&lt;!-- 环境标识，需要与配置文件的名称相对应 --&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>profiles.active</span><span class="token punctuation">&gt;</span></span>dev<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>profiles.active</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logging.level</span><span class="token punctuation">&gt;</span></span>debug<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>logging.level</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>activation</span><span class="token punctuation">&gt;</span></span>
            <span class="token comment">&lt;!-- 默认环境 --&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>activeByDefault</span><span class="token punctuation">&gt;</span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>activeByDefault</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>activation</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>profile</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>profile</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">&gt;</span></span>prod<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>profiles.active</span><span class="token punctuation">&gt;</span></span>prod<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>profiles.active</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logging.level</span><span class="token punctuation">&gt;</span></span>warn<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>logging.level</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>profile</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>profiles</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></details> <p><strong>日志打印样式 , 以及文件存储路径</strong></p> <details class="custom-block details"><summary>点击展开 **resources/logback-plus.xml**</summary> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 存储路径 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>log.path<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>./logs<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token comment">&lt;!-- 红色日期 绿色线程 高亮级别(5个字符空间) 洋红色类名 日志信息 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>console.log.pattern<span class="token punctuation">&quot;</span></span>
              <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>%red(%d{yyyy-MM-dd HH:mm:ss}) %green([%thread]) %highlight(%-5level) %boldMagenta(%logger{36}%n) - %msg%n<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token comment">&lt;!-- 去掉高亮颜色 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>log.pattern<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>

    <span class="token comment">&lt;!-- appender日志输出组件 --&gt;</span>
    <span class="token comment">&lt;!-- 控制台输出 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>console<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ch.qos.logback.core.ConsoleAppender<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- 控制台输出格式(引用上面格式) --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoder</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">&gt;</span></span>${console.log.pattern}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>charset</span><span class="token punctuation">&gt;</span></span>utf-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>charset</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoder</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- 控制台输出 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>file_console<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ch.qos.logback.core.rolling.RollingFileAppender<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>file</span><span class="token punctuation">&gt;</span></span>${log.path}/sys-console.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>file</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rollingPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ch.qos.logback.core.rolling.TimeBasedRollingPolicy<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token comment">&lt;!-- 日志文件名格式 --&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fileNamePattern</span><span class="token punctuation">&gt;</span></span>${log.path}/sys-console.%d{yyyy-MM-dd}.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fileNamePattern</span><span class="token punctuation">&gt;</span></span>
            <span class="token comment">&lt;!-- 日志最大 1天 --&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxHistory</span><span class="token punctuation">&gt;</span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxHistory</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rollingPolicy</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoder</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">&gt;</span></span>${log.pattern}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>charset</span><span class="token punctuation">&gt;</span></span>utf-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>charset</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoder</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ch.qos.logback.classic.filter.ThresholdFilter<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token comment">&lt;!-- 过滤的级别 --&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>level</span><span class="token punctuation">&gt;</span></span>INFO<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>level</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- 系统日志输出 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>file_info<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ch.qos.logback.core.rolling.RollingFileAppender<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>file</span><span class="token punctuation">&gt;</span></span>${log.path}/sys-info.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>file</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- 循环政策：基于时间创建日志文件 --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rollingPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ch.qos.logback.core.rolling.TimeBasedRollingPolicy<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token comment">&lt;!-- 日志文件名格式 --&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fileNamePattern</span><span class="token punctuation">&gt;</span></span>${log.path}/sys-info.%d{yyyy-MM-dd}.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fileNamePattern</span><span class="token punctuation">&gt;</span></span>
            <span class="token comment">&lt;!-- 日志最大的历史 60天 --&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxHistory</span><span class="token punctuation">&gt;</span></span>60<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxHistory</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rollingPolicy</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoder</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">&gt;</span></span>${log.pattern}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoder</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ch.qos.logback.classic.filter.LevelFilter<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token comment">&lt;!-- 过滤的级别 --&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>level</span><span class="token punctuation">&gt;</span></span>INFO<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>level</span><span class="token punctuation">&gt;</span></span>
            <span class="token comment">&lt;!-- 匹配时的操作：接收（记录） --&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onMatch</span><span class="token punctuation">&gt;</span></span>ACCEPT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onMatch</span><span class="token punctuation">&gt;</span></span>
            <span class="token comment">&lt;!-- 不匹配时的操作：拒绝（不记录） --&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onMismatch</span><span class="token punctuation">&gt;</span></span>DENY<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onMismatch</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>file_error<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ch.qos.logback.core.rolling.RollingFileAppender<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>file</span><span class="token punctuation">&gt;</span></span>${log.path}/sys-error.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>file</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- 循环政策：基于时间创建日志文件 --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>rollingPolicy</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ch.qos.logback.core.rolling.TimeBasedRollingPolicy<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token comment">&lt;!-- 日志文件名格式 --&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>fileNamePattern</span><span class="token punctuation">&gt;</span></span>${log.path}/sys-error.%d{yyyy-MM-dd}.log<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>fileNamePattern</span><span class="token punctuation">&gt;</span></span>
            <span class="token comment">&lt;!-- 日志最大的历史 60天 --&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>maxHistory</span><span class="token punctuation">&gt;</span></span>60<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>maxHistory</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>rollingPolicy</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoder</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pattern</span><span class="token punctuation">&gt;</span></span>${log.pattern}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pattern</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoder</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>filter</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ch.qos.logback.classic.filter.LevelFilter<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token comment">&lt;!-- 过滤的级别 --&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>level</span><span class="token punctuation">&gt;</span></span>ERROR<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>level</span><span class="token punctuation">&gt;</span></span>
            <span class="token comment">&lt;!-- 匹配时的操作：接收（记录） --&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onMatch</span><span class="token punctuation">&gt;</span></span>ACCEPT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onMatch</span><span class="token punctuation">&gt;</span></span>
            <span class="token comment">&lt;!-- 不匹配时的操作：拒绝（不记录） --&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>onMismatch</span><span class="token punctuation">&gt;</span></span>DENY<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>onMismatch</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>filter</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- info异步打印追加日志 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>async_info<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ch.qos.logback.classic.AsyncAppender<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- 不丢失日志.默认的,如果队列的80%已满,则会丢弃TRACT、DEBUG、INFO级别的日志 --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>discardingThreshold</span><span class="token punctuation">&gt;</span></span>0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>discardingThreshold</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- 更改默认的队列的深度,该值会影响性能.默认值为256 --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>queueSize</span><span class="token punctuation">&gt;</span></span>512<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>queueSize</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- 添加附加的appender,最多只能添加一个 --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>file_info<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- error异步打印追加日志 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>async_error<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ch.qos.logback.classic.AsyncAppender<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- 不丢失日志.默认的,如果队列的80%已满,则会丢弃TRACT、DEBUG、INFO级别的日志 --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>discardingThreshold</span><span class="token punctuation">&gt;</span></span>0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>discardingThreshold</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- 更改默认的队列的深度,该值会影响性能.默认值为256 --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>queueSize</span><span class="token punctuation">&gt;</span></span>512<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>queueSize</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- 添加附加的appender,最多只能添加一个 --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>file_error<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appender</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- 整合 skywalking 控制台输出 tid --&gt;</span>
<span class="token comment">&lt;!--    &lt;appender name=&quot;console&quot; class=&quot;ch.qos.logback.core.ConsoleAppender&quot;&gt;--&gt;</span>
<span class="token comment">&lt;!--        &lt;encoder class=&quot;ch.qos.logback.core.encoder.LayoutWrappingEncoder&quot;&gt;--&gt;</span>
<span class="token comment">&lt;!--            &lt;layout class=&quot;org.apache.skywalking.apm.toolkit.log.logback.v1.x.TraceIdPatternLogbackLayout&quot;&gt;--&gt;</span>
<span class="token comment">&lt;!--                &lt;pattern&gt;[%tid] ${console.log.pattern}&lt;/pattern&gt;--&gt;</span>
<span class="token comment">&lt;!--            &lt;/layout&gt;--&gt;</span>
<span class="token comment">&lt;!--            &lt;charset&gt;utf-8&lt;/charset&gt;--&gt;</span>
<span class="token comment">&lt;!--        &lt;/encoder&gt;--&gt;</span>
<span class="token comment">&lt;!--    &lt;/appender&gt;--&gt;</span>

    <span class="token comment">&lt;!-- 整合 skywalking 推送采集日志 --&gt;</span>
<span class="token comment">&lt;!--    &lt;appender name=&quot;sky_log&quot; class=&quot;org.apache.skywalking.apm.toolkit.log.logback.v1.x.log.GRPCLogClientAppender&quot;&gt;--&gt;</span>
<span class="token comment">&lt;!--        &lt;encoder class=&quot;ch.qos.logback.core.encoder.LayoutWrappingEncoder&quot;&gt;--&gt;</span>
<span class="token comment">&lt;!--            &lt;layout class=&quot;org.apache.skywalking.apm.toolkit.log.logback.v1.x.TraceIdPatternLogbackLayout&quot;&gt;--&gt;</span>
<span class="token comment">&lt;!--                &lt;pattern&gt;[%tid] ${console.log.pattern}&lt;/pattern&gt;--&gt;</span>
<span class="token comment">&lt;!--            &lt;/layout&gt;--&gt;</span>
<span class="token comment">&lt;!--            &lt;charset&gt;utf-8&lt;/charset&gt;--&gt;</span>
<span class="token comment">&lt;!--        &lt;/encoder&gt;--&gt;</span>
<span class="token comment">&lt;!--    &lt;/appender&gt;--&gt;</span>

    <span class="token comment">&lt;!--系统操作日志--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>root</span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>info<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- 分别引用上面的日志输出组件 --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>console<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>async_info<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>async_error<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>file_console<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token comment">&lt;!--        &lt;appender-ref ref=&quot;sky_log&quot;/&gt;--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>root</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>

</code></pre></div></details> <h3 id="p6spy"><a href="#p6spy" class="header-anchor">#</a> p6spy</h3> <p>日志打印通过 p6spy实现日志打印 , 通过数据源层级进行代理监听SQL , 代理驱动 <code>com.mysql.cj.jdbc.Driver</code></p> <p><strong>maven依赖</strong></p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>p6spy<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>p6spy<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.9.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><strong>配置</strong></p> <p>数据源配置 <em>spring.datasource.dynamic.p6spy</em> 设置为 <code>true</code> (生产环境不建议启用该功能)</p> <p>更多细节配置  spy.properties配置文件</p> <details class="custom-block details"><summary>点击展开</summary> <div class="language-properties extra-class"><pre class="language-properties"><code><span class="token comment"># p6spy 性能分析插件配置文件</span>
<span class="token comment"># mybatis-plus 也实现了支持p6spy的日志打印</span>
<span class="token key attr-name">modulelist</span><span class="token punctuation">=</span><span class="token value attr-value">com.baomidou.mybatisplus.extension.p6spy.MybatisPlusLogFactory,com.p6spy.engine.outage.P6OutageFactory</span>
<span class="token comment"># 自定义日志打印</span>
<span class="token key attr-name">logMessageFormat</span><span class="token punctuation">=</span><span class="token value attr-value">com.baomidou.mybatisplus.extension.p6spy.P6SpyLogger</span>
<span class="token comment"># 日志输出到控制台</span>
<span class="token key attr-name">appender</span><span class="token punctuation">=</span><span class="token value attr-value">com.baomidou.mybatisplus.extension.p6spy.StdoutLogger</span>
<span class="token comment"># 使用日志系统记录 sql</span>
<span class="token comment">#appender=com.p6spy.engine.spy.appender.Slf4JLogger</span>
<span class="token comment"># 设置 p6spy driver 代理</span>
<span class="token comment">#deregisterdrivers=true</span>
<span class="token comment"># 取消JDBC URL前缀</span>
<span class="token key attr-name">useprefix</span><span class="token punctuation">=</span><span class="token value attr-value">true</span>
<span class="token comment"># 配置记录 Log 例外,可去掉的结果集有error,info,batch,debug,statement,commit,rollback,result,resultset.</span>
<span class="token key attr-name">excludecategories</span><span class="token punctuation">=</span><span class="token value attr-value">info,debug,result,commit,resultset</span>
<span class="token comment"># 日期格式</span>
<span class="token key attr-name">dateformat</span><span class="token punctuation">=</span><span class="token value attr-value">yyyy-MM-dd HH:mm:ss</span>
<span class="token comment"># SQL语句打印时间格式</span>
<span class="token key attr-name">databaseDialectTimestampFormat</span><span class="token punctuation">=</span><span class="token value attr-value">yyyy-MM-dd HH:mm:ss</span>
<span class="token comment"># 实际驱动可多个</span>
<span class="token comment">#driverlist=org.h2.Driver</span>
<span class="token comment"># 是否开启慢SQL记录 (超过2秒记录问题)</span>
<span class="token key attr-name">outagedetection</span><span class="token punctuation">=</span><span class="token value attr-value">true</span>
<span class="token comment"># 慢SQL记录标准 2 秒</span>
<span class="token key attr-name">outagedetectioninterval</span><span class="token punctuation">=</span><span class="token value attr-value">2</span>
<span class="token comment"># 是否过滤 Log</span>
<span class="token key attr-name">filter</span><span class="token punctuation">=</span><span class="token value attr-value">true</span>
<span class="token comment"># 过滤 Log 时所排除的 sql 关键字，以逗号分隔 (排除检测数据库存活的SQL)</span>
<span class="token key attr-name">exclude</span><span class="token punctuation">=</span><span class="token value attr-value">SELECT 1</span>
</code></pre></div></details> <h2 id="整合-undertow"><a href="#整合-undertow" class="header-anchor">#</a> 整合 Undertow</h2> <p>Undertow是Java开发的高性能Web容器 , SpringBoot框架内置有Web容器 (默认采用的是 Tomcat)</p> <p><strong>Undertow对比文章 :</strong> <a href="https://cloud.tencent.com/developer/article/1699803" target="_blank" rel="noopener noreferrer">https://cloud.tencent.com<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><strong>引入依赖</strong></p> <p>依赖排除 Tomcat , 并且引入 undertow 依赖</p> <p><strong>ruoyi-framework模块中的 <code>pom.xml</code></strong></p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token comment">&lt;!-- SpringBoot Web容器 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusions</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclusion</span><span class="token punctuation">&gt;</span></span>
             <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-tomcat<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
             <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusion</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclusions</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- web 容器使用 undertow 性能更强 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-undertow<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><strong>配置</strong></p> <p><strong>ruoyi-admin模块中的 <code>application.yml</code></strong></p> <div class="language-yml extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br></div><pre class="language-yml"><code><span class="token comment"># 开发环境配置</span>
<span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token comment"># 服务器的HTTP端口，默认为8080</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>sys.port<span class="token punctuation">:</span><span class="token number">8080</span><span class="token punctuation">}</span>
  <span class="token key atrule">servlet</span><span class="token punctuation">:</span>
    <span class="token comment"># 应用的访问路径</span>
    <span class="token key atrule">context-path</span><span class="token punctuation">:</span> /
  <span class="token comment"># undertow 配置</span>
  <span class="token key atrule">undertow</span><span class="token punctuation">:</span>
    <span class="token comment"># HTTP post内容的最大大小。当值为-1时，默认值为大小是无限的</span>
    <span class="token key atrule">max-http-post-size</span><span class="token punctuation">:</span> <span class="token number">-1</span>
    <span class="token comment"># 以下的配置会影响buffer,这些buffer会用于服务器连接的IO操作,有点类似netty的池化内存管理</span>
    <span class="token comment"># 每块buffer的空间大小,越小的空间被利用越充分</span>
    <span class="token key atrule">buffer-size</span><span class="token punctuation">:</span> <span class="token number">512</span>
    <span class="token comment"># 是否分配的直接内存</span>
    <span class="token key atrule">direct-buffers</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
    <span class="token key atrule">threads</span><span class="token punctuation">:</span>
      <span class="token comment"># 设置IO线程数, 它主要执行非阻塞的任务,它们会负责多个连接, 默认设置每个CPU核心一个线程</span>
      <span class="token key atrule">io</span><span class="token punctuation">:</span> <span class="token number">8</span>
      <span class="token comment"># 阻塞任务线程池, 当执行类似servlet请求阻塞操作, undertow会从这个线程池中取得线程,它的值设置取决于系统的负载</span>
      <span class="token key atrule">worker</span><span class="token punctuation">:</span> <span class="token number">256</span>
</code></pre></div><p><strong>ruoyi-framework模块中的 <code>UndertowConfig</code>配置类</strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UndertowConfig</span> <span class="token keyword">implements</span> <span class="token class-name">WebServerFactoryCustomizer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UndertowServletWebServerFactory</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

    <span class="token comment">/**
     * 设置 Undertow 的 websocket 缓冲池
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">customize</span><span class="token punctuation">(</span><span class="token class-name">UndertowServletWebServerFactory</span> factory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 默认不直接分配内存 如果项目中使用了 websocket 建议直接分配</span>
        factory<span class="token punctuation">.</span><span class="token function">addDeploymentInfoCustomizers</span><span class="token punctuation">(</span>deploymentInfo <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token class-name">WebSocketDeploymentInfo</span> webSocketDeploymentInfo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WebSocketDeploymentInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            webSocketDeploymentInfo<span class="token punctuation">.</span><span class="token function">setBuffers</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">DefaultByteBufferPool</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token number">512</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            deploymentInfo<span class="token punctuation">.</span><span class="token function">addServletContextAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;io.undertow.websockets.jsr.WebSocketDeploymentInfo&quot;</span><span class="token punctuation">,</span> webSocketDeploymentInfo<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><h2 id="整合-openapi"><a href="#整合-openapi" class="header-anchor">#</a> 整合 OpenApi</h2> <p>采用 SpringDoc框架 , 以 OpenAPI规范生成接口信息 , 基于 Javadoc无注解形式实现</p> <p><strong>OpenAPI文档 :</strong> <a href="https://openapi.apifox.cn/" target="_blank" rel="noopener noreferrer">https://openapi.apifox.cn<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><strong>SpringDoc文档 :</strong> <a href="https://springdoc.org/" target="_blank" rel="noopener noreferrer">https://springdoc.org/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><strong>若依文档 :</strong> <a href="https://plus-doc.dromara.org/#/ruoyi-vue-plus/framework/association/doc" target="_blank" rel="noopener noreferrer">https://plus-doc.dromara.org<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><strong>javadoc使用方式</strong> (基础应用注释即可 , 更多功能注解实现)</p> <table><thead><tr><th>springdoc</th> <th>javadoc</th></tr></thead> <tbody><tr><td>@Tag(name = &quot;xxx&quot;)</td> <td>java类注释第一行</td></tr> <tr><td>@Tag(description= &quot;xxx&quot;)</td> <td>java类注释</td></tr> <tr><td>@Operation</td> <td>java方法注释</td></tr> <tr><td>@Hidden</td> <td>无</td></tr> <tr><td>@Parameter</td> <td>java方法@param参数注释</td></tr> <tr><td>@Parameter</td> <td>java方法@param参数注释</td></tr> <tr><td>@Parameters</td> <td>多个@param参数注释</td></tr> <tr><td>@Schema</td> <td>java实体类注释</td></tr> <tr><td>@Schema</td> <td>java属性注释</td></tr> <tr><td>@Schema(accessMode = READ_ONLY)</td> <td>无</td></tr> <tr><td>@ApiResponse</td> <td>java方法@return返回值注释</td></tr></tbody></table> <h3 id="源码"><a href="#源码" class="header-anchor">#</a> 源码</h3> <p><strong>涉及类</strong></p> <table><thead><tr><th>类</th> <th>说明</th></tr></thead> <tbody><tr><td>SpringDocProperties / SpringDocConfigProperties</td> <td>配置属性类 (重叠配置)</td></tr> <tr><td>SpringDocConfig</td> <td>配置类</td></tr> <tr><td>OpenApiHandler</td> <td>自定义OpenAPI处理</td></tr></tbody></table> <p><code>pom.xml</code>依赖</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token comment">&lt;!-- 核心依赖 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springdoc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>springdoc-openapi-webmvc-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.6.15<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- 注释生成文档 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springdoc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>springdoc-openapi-javadoc<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.6.15<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p><code>pom.xml</code>插件处理</p> <details class="custom-block details"><summary>点击展开</summary> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.maven.plugins<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>maven-compiler-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.9.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>source</span><span class="token punctuation">&gt;</span></span>${java.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>source</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>target</span><span class="token punctuation">&gt;</span></span>${java.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>target</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>encoding</span><span class="token punctuation">&gt;</span></span>${project.build.sourceEncoding}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>encoding</span><span class="token punctuation">&gt;</span></span>
            <span class="token comment">&lt;!-- 注解处理路径 (一旦使用上 annotationProcessorPaths 就一定要为引用中写上 , 如:lombok) --&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>annotationProcessorPaths</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.github.therapi<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>therapi-runtime-javadoc-scribe<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>0.15.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>path</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${lombok.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>path</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-configuration-processor<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${spring-boot.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>path</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>annotationProcessorPaths</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">&gt;</span></span>
    <span class="token comment">&lt;!-- 单元测试使用 --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.maven.plugins<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>maven-surefire-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.22.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>argLine</span><span class="token punctuation">&gt;</span></span>-Dfile.encoding=UTF-8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>argLine</span><span class="token punctuation">&gt;</span></span>
            <span class="token comment">&lt;!-- 根据打包环境执行对应的@Tag测试方法 --&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groups</span><span class="token punctuation">&gt;</span></span>${profiles.active}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groups</span><span class="token punctuation">&gt;</span></span>
            <span class="token comment">&lt;!-- 排除标签 --&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>excludedGroups</span><span class="token punctuation">&gt;</span></span>exclude<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>excludedGroups</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">&gt;</span></span>
</code></pre></div></details> <p><code>application.yml</code>配置文件</p> <p>属性对应的类属性是重叠两个类使用 : <code>SpringDocProperties</code>、<code>SpringDocConfigProperties</code></p> <details class="custom-block details"><summary>点击展开</summary> <div class="language-yml extra-class"><pre class="language-yml"><code><span class="token key atrule">springdoc</span><span class="token punctuation">:</span>
  <span class="token key atrule">api-docs</span><span class="token punctuation">:</span>
    <span class="token comment"># 是否开启接口文档</span>
    <span class="token key atrule">enabled</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
<span class="token comment">#  swagger-ui:</span>
<span class="token comment">#    # 持久化认证数据</span>
<span class="token comment">#    persistAuthorization: true</span>
  <span class="token key atrule">info</span><span class="token punctuation">:</span>
    <span class="token comment"># 标题</span>
    <span class="token key atrule">title</span><span class="token punctuation">:</span> <span class="token string">'标题：${ruoyi.name}后台管理系统_接口文档'</span>
    <span class="token comment"># 描述</span>
    <span class="token key atrule">description</span><span class="token punctuation">:</span> <span class="token string">'描述：用于管理集团旗下公司的人员信息,具体包括XXX,XXX模块...'</span>
    <span class="token comment"># 版本</span>
    <span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">'版本号: ${ruoyi-vue-plus.version}'</span>
    <span class="token comment"># 作者信息</span>
    <span class="token key atrule">contact</span><span class="token punctuation">:</span>
      <span class="token key atrule">name</span><span class="token punctuation">:</span> Lion Li
      <span class="token key atrule">email</span><span class="token punctuation">:</span> crazylionli@163.com
      <span class="token key atrule">url</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//gitee.com/dromara/RuoYi<span class="token punctuation">-</span>Vue<span class="token punctuation">-</span>Plus
  <span class="token key atrule">components</span><span class="token punctuation">:</span>
    <span class="token comment"># 鉴权方式配置</span>
    <span class="token key atrule">security-schemes</span><span class="token punctuation">:</span>
      <span class="token key atrule">apiKey</span><span class="token punctuation">:</span>
        <span class="token key atrule">type</span><span class="token punctuation">:</span> APIKEY
        <span class="token key atrule">in</span><span class="token punctuation">:</span> HEADER
        <span class="token key atrule">name</span><span class="token punctuation">:</span> $<span class="token punctuation">{</span>sa<span class="token punctuation">-</span>token.token<span class="token punctuation">-</span>name<span class="token punctuation">}</span>
  <span class="token comment">#这里定义了两个分组，可定义多个，也可以不定义</span>
  <span class="token key atrule">group-configs</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">group</span><span class="token punctuation">:</span> 1.演示模块
      <span class="token key atrule">packages-to-scan</span><span class="token punctuation">:</span> com.ruoyi.demo
    <span class="token punctuation">-</span> <span class="token key atrule">group</span><span class="token punctuation">:</span> 2.系统模块
      <span class="token key atrule">packages-to-scan</span><span class="token punctuation">:</span> com.ruoyi.web
    <span class="token punctuation">-</span> <span class="token key atrule">group</span><span class="token punctuation">:</span> 3.代码生成模块
      <span class="token key atrule">packages-to-scan</span><span class="token punctuation">:</span> com.ruoyi.generator
</code></pre></div></details> <p><code>SpringDocCqonfig</code>配置类</p> <details class="custom-block details"><summary>点击展开</summary> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@RequiredArgsConstructor</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@AutoConfigureBefore</span><span class="token punctuation">(</span><span class="token class-name">SpringDocConfiguration</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ConditionalOnProperty</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;springdoc.api-docs.enabled&quot;</span><span class="token punctuation">,</span> havingValue <span class="token operator">=</span> <span class="token string">&quot;true&quot;</span><span class="token punctuation">,</span> matchIfMissing <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SpringDocConfig</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">ServerProperties</span> serverProperties<span class="token punctuation">;</span>

    <span class="token comment">/**
     * 注册 OpenAPI Bean
     * @param properties 参数注入Bean
     */</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token annotation punctuation">@ConditionalOnMissingBean</span><span class="token punctuation">(</span><span class="token class-name">OpenAPI</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">OpenAPI</span> <span class="token function">openApi</span><span class="token punctuation">(</span><span class="token class-name">SpringDocProperties</span> properties<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">OpenAPI</span> openApi <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">OpenAPI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 设置 文档基本信息</span>
        <span class="token class-name">SpringDocProperties<span class="token punctuation">.</span>InfoProperties</span> infoProperties <span class="token operator">=</span> properties<span class="token punctuation">.</span><span class="token function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Info</span> info <span class="token operator">=</span> <span class="token function">convertInfo</span><span class="token punctuation">(</span>infoProperties<span class="token punctuation">)</span><span class="token punctuation">;</span>
        openApi<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>info<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 设置 扩展文档信息</span>
        openApi<span class="token punctuation">.</span><span class="token function">externalDocs</span><span class="token punctuation">(</span>properties<span class="token punctuation">.</span><span class="token function">getExternalDocs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        openApi<span class="token punctuation">.</span><span class="token function">tags</span><span class="token punctuation">(</span>properties<span class="token punctuation">.</span><span class="token function">getTags</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        openApi<span class="token punctuation">.</span><span class="token function">paths</span><span class="token punctuation">(</span>properties<span class="token punctuation">.</span><span class="token function">getPaths</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        openApi<span class="token punctuation">.</span><span class="token function">components</span><span class="token punctuation">(</span>properties<span class="token punctuation">.</span><span class="token function">getComponents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 设置 安全信息</span>
        <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> keySet <span class="token operator">=</span> properties<span class="token punctuation">.</span><span class="token function">getComponents</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSecuritySchemes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">keySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SecurityRequirement</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">SecurityRequirement</span> securityRequirement <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SecurityRequirement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        keySet<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>securityRequirement<span class="token operator">::</span><span class="token function">addList</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>securityRequirement<span class="token punctuation">)</span><span class="token punctuation">;</span>
        openApi<span class="token punctuation">.</span><span class="token function">security</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> openApi<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token class-name">Info</span> <span class="token function">convertInfo</span><span class="token punctuation">(</span><span class="token class-name">SpringDocProperties<span class="token punctuation">.</span>InfoProperties</span> infoProperties<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Info</span> info <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        info<span class="token punctuation">.</span><span class="token function">setTitle</span><span class="token punctuation">(</span>infoProperties<span class="token punctuation">.</span><span class="token function">getTitle</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        info<span class="token punctuation">.</span><span class="token function">setDescription</span><span class="token punctuation">(</span>infoProperties<span class="token punctuation">.</span><span class="token function">getDescription</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        info<span class="token punctuation">.</span><span class="token function">setContact</span><span class="token punctuation">(</span>infoProperties<span class="token punctuation">.</span><span class="token function">getContact</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        info<span class="token punctuation">.</span><span class="token function">setLicense</span><span class="token punctuation">(</span>infoProperties<span class="token punctuation">.</span><span class="token function">getLicense</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        info<span class="token punctuation">.</span><span class="token function">setVersion</span><span class="token punctuation">(</span>infoProperties<span class="token punctuation">.</span><span class="token function">getVersion</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> info<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 自定义 openapi 处理器
     */</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">OpenAPIService</span> <span class="token function">openApiBuilder</span><span class="token punctuation">(</span><span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">OpenAPI</span><span class="token punctuation">&gt;</span></span> openAPI<span class="token punctuation">,</span>
                                         <span class="token class-name">SecurityService</span> securityParser<span class="token punctuation">,</span>
                                         <span class="token class-name">SpringDocConfigProperties</span> springDocConfigProperties<span class="token punctuation">,</span>
                                         <span class="token class-name">PropertyResolverUtils</span> propertyResolverUtils<span class="token punctuation">,</span>
                                         <span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">OpenApiBuilderCustomizer</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> openApiBuilderCustomisers<span class="token punctuation">,</span>
                                         <span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">ServerBaseUrlCustomizer</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> serverBaseUrlCustomisers<span class="token punctuation">,</span>
                                         <span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">JavadocProvider</span><span class="token punctuation">&gt;</span></span> javadocProvider<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">OpenApiHandler</span><span class="token punctuation">(</span>openAPI<span class="token punctuation">,</span> securityParser<span class="token punctuation">,</span> springDocConfigProperties<span class="token punctuation">,</span> propertyResolverUtils<span class="token punctuation">,</span> openApiBuilderCustomisers<span class="token punctuation">,</span> serverBaseUrlCustomisers<span class="token punctuation">,</span> javadocProvider<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 对已经生成好的 OpenApi 进行自定义操作
     * 对含有前缀的路径进行拼接处理
     */</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">OpenApiCustomiser</span> <span class="token function">openApiCustomiser</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 获取 server.servlet.context-path 配置指</span>
        <span class="token class-name">String</span> contextPath <span class="token operator">=</span> serverProperties<span class="token punctuation">.</span><span class="token function">getServlet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getContextPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> finalContextPath<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isBlank</span><span class="token punctuation">(</span>contextPath<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>contextPath<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            finalContextPath <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            finalContextPath <span class="token operator">=</span> contextPath<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// 对所有路径增加前置上下文路径</span>
        <span class="token keyword">return</span> openApi <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            <span class="token class-name">Paths</span> oldPaths <span class="token operator">=</span> openApi<span class="token punctuation">.</span><span class="token function">getPaths</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>oldPaths <span class="token keyword">instanceof</span> <span class="token class-name">PlusPaths</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token class-name">PlusPaths</span> newPaths <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PlusPaths</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            oldPaths<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span>v<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> newPaths<span class="token punctuation">.</span><span class="token function">addPathItem</span><span class="token punctuation">(</span>finalContextPath <span class="token operator">+</span> k<span class="token punctuation">,</span> v<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            openApi<span class="token punctuation">.</span><span class="token function">setPaths</span><span class="token punctuation">(</span>newPaths<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * 单独使用一个类便于判断 解决springdoc路径拼接重复问题
     *
     * @author Lion Li
     */</span>
    <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">PlusPaths</span> <span class="token keyword">extends</span> <span class="token class-name">Paths</span> <span class="token punctuation">{</span>

        <span class="token keyword">public</span> <span class="token class-name">PlusPaths</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div></details> <h3 id="重写功能"><a href="#重写功能" class="header-anchor">#</a> 重写功能</h3> <p><strong>问题 :</strong> 导出的接口信息 , 默认采用当前类名进行作为标识名称 . 在一些情况下查阅会显得费劲</p> <p><strong>解决思路 :</strong> 继承类并重写方法 <code>OpenAPIService#buildTags()</code> , 替换默认形式的名称即可</p> <p><code>OpenApiHandler</code>类</p> <details class="custom-block details"><summary>点击展开</summary> <div class="language-java extra-class"><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><div class="highlighted"> </div><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre class="language-java"><code><span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token string">&quot;all&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OpenApiHandler</span> <span class="token keyword">extends</span> <span class="token class-name">OpenAPIService</span> <span class="token punctuation">{</span>

    <span class="token comment">/**
     * The constant LOGGER.
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Logger</span> <span class="token constant">LOGGER</span> <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">OpenAPIService</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * The Context.
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">ApplicationContext</span> context<span class="token punctuation">;</span>

    <span class="token comment">/**
     * The Security parser.
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">SecurityService</span> securityParser<span class="token punctuation">;</span>

    <span class="token comment">/**
     * The Mappings map.
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> mappingsMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * The Springdoc tags.
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">HandlerMethod</span><span class="token punctuation">,</span> <span class="token class-name"><span class="token namespace">io<span class="token punctuation">.</span>swagger<span class="token punctuation">.</span>v3<span class="token punctuation">.</span>oas<span class="token punctuation">.</span>models<span class="token punctuation">.</span>tags<span class="token punctuation">.</span></span>Tag</span><span class="token punctuation">&gt;</span></span> springdocTags <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * The Open api builder customisers.
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">OpenApiBuilderCustomizer</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> openApiBuilderCustomisers<span class="token punctuation">;</span>

    <span class="token comment">/**
     * The server base URL customisers.
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">ServerBaseUrlCustomizer</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> serverBaseUrlCustomizers<span class="token punctuation">;</span>

    <span class="token comment">/**
     * The Spring doc config properties.
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">SpringDocConfigProperties</span> springDocConfigProperties<span class="token punctuation">;</span>

    <span class="token comment">/**
     * The Open api.
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">OpenAPI</span> openAPI<span class="token punctuation">;</span>

    <span class="token comment">/**
     * The Cached open api map.
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">OpenAPI</span><span class="token punctuation">&gt;</span></span> cachedOpenAPI <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * The Is servers present.
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">boolean</span> isServersPresent<span class="token punctuation">;</span>

    <span class="token comment">/**
     * The Server base url.
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> serverBaseUrl<span class="token punctuation">;</span>

    <span class="token comment">/**
     * The Property resolver utils.
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">PropertyResolverUtils</span> propertyResolverUtils<span class="token punctuation">;</span>

    <span class="token comment">/**
     * The javadoc provider.
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">JavadocProvider</span><span class="token punctuation">&gt;</span></span> javadocProvider<span class="token punctuation">;</span>

    <span class="token comment">/**
     * The Basic error controller.
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> basicErrorController<span class="token punctuation">;</span>

    <span class="token keyword">static</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">//spring-boot 2</span>
            basicErrorController <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">&quot;org.springframework.boot.autoconfigure.web.servlet.error.BasicErrorController&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ClassNotFoundException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//spring-boot 1</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                basicErrorController <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">&quot;org.springframework.boot.autoconfigure.web.BasicErrorController&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ClassNotFoundException</span> classNotFoundException<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">//Basic error controller class not found</span>
                <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">trace</span><span class="token punctuation">(</span>classNotFoundException<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * Instantiates a new Open api builder.
     *
     * @param openAPI                   the open api
     * @param securityParser            the security parser
     * @param springDocConfigProperties the spring doc config properties
     * @param propertyResolverUtils     the property resolver utils
     * @param openApiBuilderCustomizers the open api builder customisers
     * @param serverBaseUrlCustomizers  the server base url customizers
     * @param javadocProvider           the javadoc provider
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">OpenApiHandler</span><span class="token punctuation">(</span><span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">OpenAPI</span><span class="token punctuation">&gt;</span></span> openAPI<span class="token punctuation">,</span> <span class="token class-name">SecurityService</span> securityParser<span class="token punctuation">,</span>
                          <span class="token class-name">SpringDocConfigProperties</span> springDocConfigProperties<span class="token punctuation">,</span> <span class="token class-name">PropertyResolverUtils</span> propertyResolverUtils<span class="token punctuation">,</span>
                          <span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">OpenApiBuilderCustomizer</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> openApiBuilderCustomizers<span class="token punctuation">,</span>
                          <span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">ServerBaseUrlCustomizer</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> serverBaseUrlCustomizers<span class="token punctuation">,</span>
                          <span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">JavadocProvider</span><span class="token punctuation">&gt;</span></span> javadocProvider<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 保留父类具有的信息</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>openAPI<span class="token punctuation">,</span> securityParser<span class="token punctuation">,</span> springDocConfigProperties<span class="token punctuation">,</span> propertyResolverUtils<span class="token punctuation">,</span> openApiBuilderCustomizers<span class="token punctuation">,</span> serverBaseUrlCustomizers<span class="token punctuation">,</span> javadocProvider<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>openAPI<span class="token punctuation">.</span><span class="token function">isPresent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>openAPI <span class="token operator">=</span> openAPI<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>openAPI<span class="token punctuation">.</span><span class="token function">getComponents</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>openAPI<span class="token punctuation">.</span><span class="token function">setComponents</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Components</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>openAPI<span class="token punctuation">.</span><span class="token function">getPaths</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>openAPI<span class="token punctuation">.</span><span class="token function">setPaths</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Paths</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">CollectionUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>openAPI<span class="token punctuation">.</span><span class="token function">getServers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span>isServersPresent <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>propertyResolverUtils <span class="token operator">=</span> propertyResolverUtils<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>securityParser <span class="token operator">=</span> securityParser<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>springDocConfigProperties <span class="token operator">=</span> springDocConfigProperties<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>openApiBuilderCustomisers <span class="token operator">=</span> openApiBuilderCustomizers<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>serverBaseUrlCustomizers <span class="token operator">=</span> serverBaseUrlCustomizers<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>javadocProvider <span class="token operator">=</span> javadocProvider<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>springDocConfigProperties<span class="token punctuation">.</span><span class="token function">isUseFqn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token class-name">TypeNameResolver</span><span class="token punctuation">.</span>std<span class="token punctuation">.</span><span class="token function">setUseFqn</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Operation</span> <span class="token function">buildTags</span><span class="token punctuation">(</span><span class="token class-name">HandlerMethod</span> handlerMethod<span class="token punctuation">,</span> <span class="token class-name">Operation</span> operation<span class="token punctuation">,</span> <span class="token class-name">OpenAPI</span> openAPI<span class="token punctuation">,</span> <span class="token class-name">Locale</span> locale<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Tag</span><span class="token punctuation">&gt;</span></span> tags <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> tagsStr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token function">buildTagsFromMethod</span><span class="token punctuation">(</span>handlerMethod<span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> tags<span class="token punctuation">,</span> tagsStr<span class="token punctuation">,</span> locale<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">buildTagsFromClass</span><span class="token punctuation">(</span>handlerMethod<span class="token punctuation">.</span><span class="token function">getBeanType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> tags<span class="token punctuation">,</span> tagsStr<span class="token punctuation">,</span> locale<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">CollectionUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>tagsStr<span class="token punctuation">)</span><span class="token punctuation">)</span>
            tagsStr <span class="token operator">=</span> tagsStr<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>str <span class="token operator">-&gt;</span> propertyResolverUtils<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> locale<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>springdocTags<span class="token punctuation">.</span><span class="token function">containsKey</span><span class="token punctuation">(</span>handlerMethod<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name"><span class="token namespace">io<span class="token punctuation">.</span>swagger<span class="token punctuation">.</span>v3<span class="token punctuation">.</span>oas<span class="token punctuation">.</span>models<span class="token punctuation">.</span>tags<span class="token punctuation">.</span></span>Tag</span> tag <span class="token operator">=</span> springdocTags<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>handlerMethod<span class="token punctuation">)</span><span class="token punctuation">;</span>
            tagsStr<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>tag<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>openAPI<span class="token punctuation">.</span><span class="token function">getTags</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> <span class="token operator">!</span>openAPI<span class="token punctuation">.</span><span class="token function">getTags</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>tag<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                openAPI<span class="token punctuation">.</span><span class="token function">addTagsItem</span><span class="token punctuation">(</span>tag<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">CollectionUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>tagsStr<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">CollectionUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>operation<span class="token punctuation">.</span><span class="token function">getTags</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                operation<span class="token punctuation">.</span><span class="token function">setTags</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>tagsStr<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> operationTagsSet <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>operation<span class="token punctuation">.</span><span class="token function">getTags</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                operationTagsSet<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>tagsStr<span class="token punctuation">)</span><span class="token punctuation">;</span>
                operation<span class="token punctuation">.</span><span class="token function">getTags</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                operation<span class="token punctuation">.</span><span class="token function">getTags</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>operationTagsSet<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isAutoTagClasses</span><span class="token punctuation">(</span>operation<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>javadocProvider<span class="token punctuation">.</span><span class="token function">isPresent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">String</span> description <span class="token operator">=</span> javadocProvider<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getClassJavadoc</span><span class="token punctuation">(</span>handlerMethod<span class="token punctuation">.</span><span class="token function">getBeanType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isNotBlank</span><span class="token punctuation">(</span>description<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token class-name"><span class="token namespace">io<span class="token punctuation">.</span>swagger<span class="token punctuation">.</span>v3<span class="token punctuation">.</span>oas<span class="token punctuation">.</span>models<span class="token punctuation">.</span>tags<span class="token punctuation">.</span></span>Tag</span> tag <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token namespace">io<span class="token punctuation">.</span>swagger<span class="token punctuation">.</span>v3<span class="token punctuation">.</span>oas<span class="token punctuation">.</span>models<span class="token punctuation">.</span>tags<span class="token punctuation">.</span></span>Tag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

                    <span class="token comment">// 自定义部分 修改使用java注释当tag名</span>
                    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token class-name">IoUtil</span><span class="token punctuation">.</span><span class="token function">readLines</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StringReader</span><span class="token punctuation">(</span>description<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">// tag.setName(tagAutoName);</span>
                    <span class="token comment">// 类中的第一行作为方法的tag</span>
                    tag<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span>list<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    operation<span class="token punctuation">.</span><span class="token function">addTagsItem</span><span class="token punctuation">(</span>list<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment">// 描述信息全部保留</span>
                    tag<span class="token punctuation">.</span><span class="token function">setDescription</span><span class="token punctuation">(</span>description<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>openAPI<span class="token punctuation">.</span><span class="token function">getTags</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> <span class="token operator">!</span>openAPI<span class="token punctuation">.</span><span class="token function">getTags</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>tag<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        openAPI<span class="token punctuation">.</span><span class="token function">addTagsItem</span><span class="token punctuation">(</span>tag<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token class-name">String</span> tagAutoName <span class="token operator">=</span> <span class="token function">splitCamelCase</span><span class="token punctuation">(</span>handlerMethod<span class="token punctuation">.</span><span class="token function">getBeanType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getSimpleName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                operation<span class="token punctuation">.</span><span class="token function">addTagsItem</span><span class="token punctuation">(</span>tagAutoName<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">CollectionUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>tags<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// Existing tags</span>
            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name"><span class="token namespace">io<span class="token punctuation">.</span>swagger<span class="token punctuation">.</span>v3<span class="token punctuation">.</span>oas<span class="token punctuation">.</span>models<span class="token punctuation">.</span>tags<span class="token punctuation">.</span></span>Tag</span><span class="token punctuation">&gt;</span></span> openApiTags <span class="token operator">=</span> openAPI<span class="token punctuation">.</span><span class="token function">getTags</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">CollectionUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>openApiTags<span class="token punctuation">)</span><span class="token punctuation">)</span>
                tags<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>openApiTags<span class="token punctuation">)</span><span class="token punctuation">;</span>
            openAPI<span class="token punctuation">.</span><span class="token function">setTags</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>tags<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// Handle SecurityRequirement at operation level</span>
        <span class="token class-name"><span class="token namespace">io<span class="token punctuation">.</span>swagger<span class="token punctuation">.</span>v3<span class="token punctuation">.</span>oas<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span>security<span class="token punctuation">.</span></span>SecurityRequirement</span><span class="token punctuation">[</span><span class="token punctuation">]</span> securityRequirements <span class="token operator">=</span> securityParser
            <span class="token punctuation">.</span><span class="token function">getSecurityRequirements</span><span class="token punctuation">(</span>handlerMethod<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>securityRequirements <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>securityRequirements<span class="token punctuation">.</span>length <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
                operation<span class="token punctuation">.</span><span class="token function">setSecurity</span><span class="token punctuation">(</span><span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">emptyList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">else</span>
                securityParser<span class="token punctuation">.</span><span class="token function">buildSecurityRequirement</span><span class="token punctuation">(</span>securityRequirements<span class="token punctuation">,</span> operation<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">return</span> operation<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">buildTagsFromMethod</span><span class="token punctuation">(</span><span class="token class-name">Method</span> method<span class="token punctuation">,</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name"><span class="token namespace">io<span class="token punctuation">.</span>swagger<span class="token punctuation">.</span>v3<span class="token punctuation">.</span>oas<span class="token punctuation">.</span>models<span class="token punctuation">.</span>tags<span class="token punctuation">.</span></span>Tag</span><span class="token punctuation">&gt;</span></span> tags<span class="token punctuation">,</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> tagsStr<span class="token punctuation">,</span> <span class="token class-name">Locale</span> locale<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// method tags</span>
        <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Tags</span><span class="token punctuation">&gt;</span></span> tagsSet <span class="token operator">=</span> <span class="token class-name">AnnotatedElementUtils</span>
            <span class="token punctuation">.</span><span class="token function">findAllMergedAnnotations</span><span class="token punctuation">(</span>method<span class="token punctuation">,</span> <span class="token class-name">Tags</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name"><span class="token namespace">io<span class="token punctuation">.</span>swagger<span class="token punctuation">.</span>v3<span class="token punctuation">.</span>oas<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span>tags<span class="token punctuation">.</span></span>Tag</span><span class="token punctuation">&gt;</span></span> methodTags <span class="token operator">=</span> tagsSet<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">flatMap</span><span class="token punctuation">(</span>x <span class="token operator">-&gt;</span> <span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        methodTags<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span><span class="token class-name">AnnotatedElementUtils</span><span class="token punctuation">.</span><span class="token function">findAllMergedAnnotations</span><span class="token punctuation">(</span>method<span class="token punctuation">,</span> <span class="token class-name"><span class="token namespace">io<span class="token punctuation">.</span>swagger<span class="token punctuation">.</span>v3<span class="token punctuation">.</span>oas<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span>tags<span class="token punctuation">.</span></span>Tag</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">CollectionUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>methodTags<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            tagsStr<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>methodTags<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>tag <span class="token operator">-&gt;</span> propertyResolverUtils<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>tag<span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> locale<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name"><span class="token namespace">io<span class="token punctuation">.</span>swagger<span class="token punctuation">.</span>v3<span class="token punctuation">.</span>oas<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span>tags<span class="token punctuation">.</span></span>Tag</span><span class="token punctuation">&gt;</span></span> allTags <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>methodTags<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">addTags</span><span class="token punctuation">(</span>allTags<span class="token punctuation">,</span> tags<span class="token punctuation">,</span> locale<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">addTags</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name"><span class="token namespace">io<span class="token punctuation">.</span>swagger<span class="token punctuation">.</span>v3<span class="token punctuation">.</span>oas<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span>tags<span class="token punctuation">.</span></span>Tag</span><span class="token punctuation">&gt;</span></span> sourceTags<span class="token punctuation">,</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name"><span class="token namespace">io<span class="token punctuation">.</span>swagger<span class="token punctuation">.</span>v3<span class="token punctuation">.</span>oas<span class="token punctuation">.</span>models<span class="token punctuation">.</span>tags<span class="token punctuation">.</span></span>Tag</span><span class="token punctuation">&gt;</span></span> tags<span class="token punctuation">,</span> <span class="token class-name">Locale</span> locale<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Set</span><span class="token punctuation">&lt;</span><span class="token class-name"><span class="token namespace">io<span class="token punctuation">.</span>swagger<span class="token punctuation">.</span>v3<span class="token punctuation">.</span>oas<span class="token punctuation">.</span>models<span class="token punctuation">.</span>tags<span class="token punctuation">.</span></span>Tag</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> optionalTagSet <span class="token operator">=</span> <span class="token class-name">AnnotationsUtils</span>
            <span class="token punctuation">.</span><span class="token function">getTags</span><span class="token punctuation">(</span>sourceTags<span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name"><span class="token namespace">io<span class="token punctuation">.</span>swagger<span class="token punctuation">.</span>v3<span class="token punctuation">.</span>oas<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span>tags<span class="token punctuation">.</span></span>Tag</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        optionalTagSet<span class="token punctuation">.</span><span class="token function">ifPresent</span><span class="token punctuation">(</span>tagsSet <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            tagsSet<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>tag <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
                tag<span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span>propertyResolverUtils<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>tag<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> locale<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                tag<span class="token punctuation">.</span><span class="token function">description</span><span class="token punctuation">(</span>propertyResolverUtils<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>tag<span class="token punctuation">.</span><span class="token function">getDescription</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> locale<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>tags<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">noneMatch</span><span class="token punctuation">(</span>t <span class="token operator">-&gt;</span> t<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>tag<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    tags<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>tag<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div></details> <h3 id="使用方式"><a href="#使用方式" class="header-anchor">#</a> 使用方式</h3> <h4 id="初始应用"><a href="#初始应用" class="header-anchor">#</a> 初始应用</h4> <p><strong>大致流程</strong></p> <ol><li><a href="#%E6%BA%90%E7%A0%81">引入依赖</a></li> <li><a href="#%E6%BA%90%E7%A0%81">配置基础信息</a></li> <li>启用访问 <a href="https://localhost:8080/v3/api-docs" target="_blank" rel="noopener noreferrer">https://localhost:8080/v3/api-docs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ol> <h4 id="模块引用"><a href="#模块引用" class="header-anchor">#</a> 模块引用</h4> <p><strong>大致流程</strong></p> <ol><li>新建模块 , <a href="https://plus-doc.dromara.org/#/ruoyi-vue-plus/framework/association/new_module" target="_blank" rel="noopener noreferrer">关联模块<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 并引入 common模块依赖</li> <li>配置模块 , admin模块配置文件中 , 配置 ==springdoc.group-configs==包路径指定模块</li> <li>启用访问 <a href="https://localhost:8080/v3/api-docs/1.%E6%BC%94%E7%A4%BA%E6%A8%A1%E5%9D%97" target="_blank" rel="noopener noreferrer">https://localhost:8080/v3/api-docs/{模块名}<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://localhost:8080/v3/api-docs/1.%E6%BC%94%E7%A4%BA%E6%A8%A1%E5%9D%97" target="_blank" rel="noopener noreferrer">https://localhost:8080/v3/api-docs/1.演示模块<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ol> <h4 id="apifox自动导入"><a href="#apifox自动导入" class="header-anchor">#</a> apifox自动导入</h4> <p><strong>大致流程</strong></p> <p>打开 <a href="https://apifox.com/" target="_blank" rel="noopener noreferrer">apifox<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> -&gt; 进入项目 -&gt; 项目设置 -&gt; 定时导入 -&gt; 新建</p> <p>根据 模块URL形式进行定时导入</p> <blockquote><p>这种形式模块化分类明确!</p></blockquote></div></div>  <div class="page-edit"><!----> <div class="tags"><a href="/tags/?tag=ruoyi-vue-plus" title="标签">#ruoyi-vue-plus</a></div> <!----></div> <div class="page-nav-wapper"><!----> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/ruoyi-vue-plus/97/" class="prev">ruoyi-vue-plus-工具篇</a></span> <span class="next"><a href="/ruoyi-vue-plus/99/">ruoyi-vue-plus-问题解决</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/ruoyi-vue-plus/18/"><div>
            ruoyi-vue-plus-单元测试
            <!----></div></a> <span class="date">05-03</span></dt></dl><dl><dd>02</dd> <dt><a href="/ruoyi-vue-plus/17/"><div>
            ruoyi-vue-plus-数据加密
            <!----></div></a> <span class="date">05-01</span></dt></dl><dl><dd>03</dd> <dt><a href="/ruoyi-vue-plus/97/"><div>
            ruoyi-vue-plus-工具篇
            <!----></div></a> <span class="date">04-21</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="Bozhu12" title="联系" target="_blank" class="iconfont icon-weixin"></a><a href="https://github.com/Bozhu12" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/user/home?id=448156561" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2019-2024
    <span> | <a href="https://beian.miit.gov.cn/">桂ICP备2022009417号-1</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <div class="body-bg" style="background:url() center center / cover no-repeat;opacity:0.5;"></div> <!----> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.59868afa.js" defer></script><script src="/assets/js/2.b26d2d6f.js" defer></script><script src="/assets/js/121.4d431d9c.js" defer></script>
  </body>
</html>
