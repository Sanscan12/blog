<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Hibernate | 柏竹</title>
    <meta name="generator" content="VuePress 1.9.5">
    <link rel="icon" href="https://image.bozhu12.cc/myblog/Essay/favicon.ico">
    <script language="javascript" type="text/javascript" src="/js/pgmanor-self.js"></script>
    <meta name="description" content="学习足迹 , 记录生活!">
    <meta name="Sasncan12" content="柏竹博客, 个人技术博客, 前后端端 , 技术文档">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#bd93f9">
    
    <link rel="preload" href="/assets/css/0.styles.7521ea85.css" as="style"><link rel="preload" href="/assets/js/app.f3207224.js" as="script"><link rel="preload" href="/assets/js/2.b26d2d6f.js" as="script"><link rel="preload" href="/assets/js/56.908edc6d.js" as="script"><link rel="prefetch" href="/assets/js/10.40fa2b9f.js"><link rel="prefetch" href="/assets/js/100.46cdfe91.js"><link rel="prefetch" href="/assets/js/101.060fd0c8.js"><link rel="prefetch" href="/assets/js/102.1b05f722.js"><link rel="prefetch" href="/assets/js/103.5b94f613.js"><link rel="prefetch" href="/assets/js/104.140bfd08.js"><link rel="prefetch" href="/assets/js/105.381e872a.js"><link rel="prefetch" href="/assets/js/106.3ce733fe.js"><link rel="prefetch" href="/assets/js/107.c1aa8a3a.js"><link rel="prefetch" href="/assets/js/108.1a511947.js"><link rel="prefetch" href="/assets/js/109.033c746b.js"><link rel="prefetch" href="/assets/js/11.95f8dafb.js"><link rel="prefetch" href="/assets/js/110.8798f788.js"><link rel="prefetch" href="/assets/js/111.ad93940f.js"><link rel="prefetch" href="/assets/js/112.b260a449.js"><link rel="prefetch" href="/assets/js/113.fc297055.js"><link rel="prefetch" href="/assets/js/114.a3fc5259.js"><link rel="prefetch" href="/assets/js/115.4222fe1f.js"><link rel="prefetch" href="/assets/js/116.31a2d21a.js"><link rel="prefetch" href="/assets/js/117.fb7be406.js"><link rel="prefetch" href="/assets/js/118.aef72217.js"><link rel="prefetch" href="/assets/js/119.3173de9a.js"><link rel="prefetch" href="/assets/js/12.ece21d43.js"><link rel="prefetch" href="/assets/js/120.bd58cde5.js"><link rel="prefetch" href="/assets/js/121.d3b0cecd.js"><link rel="prefetch" href="/assets/js/122.4ce94e2d.js"><link rel="prefetch" href="/assets/js/123.a8a704cc.js"><link rel="prefetch" href="/assets/js/124.3a38f764.js"><link rel="prefetch" href="/assets/js/125.b63ae826.js"><link rel="prefetch" href="/assets/js/126.72c5dd47.js"><link rel="prefetch" href="/assets/js/127.47b425a1.js"><link rel="prefetch" href="/assets/js/128.6befb483.js"><link rel="prefetch" href="/assets/js/129.c98c715a.js"><link rel="prefetch" href="/assets/js/13.ff3bdc87.js"><link rel="prefetch" href="/assets/js/14.eeb80160.js"><link rel="prefetch" href="/assets/js/15.8b3c0729.js"><link rel="prefetch" href="/assets/js/16.4700baf2.js"><link rel="prefetch" href="/assets/js/17.44662dbd.js"><link rel="prefetch" href="/assets/js/18.870eb21a.js"><link rel="prefetch" href="/assets/js/19.94ff4bba.js"><link rel="prefetch" href="/assets/js/20.6802ce4f.js"><link rel="prefetch" href="/assets/js/21.075e8623.js"><link rel="prefetch" href="/assets/js/22.cd5b0f4c.js"><link rel="prefetch" href="/assets/js/23.82bd4a9c.js"><link rel="prefetch" href="/assets/js/24.1d88f10f.js"><link rel="prefetch" href="/assets/js/25.65e92ad2.js"><link rel="prefetch" href="/assets/js/26.468456c3.js"><link rel="prefetch" href="/assets/js/27.3cbd695a.js"><link rel="prefetch" href="/assets/js/28.e9a560ea.js"><link rel="prefetch" href="/assets/js/29.3b2bc765.js"><link rel="prefetch" href="/assets/js/3.00d27ac4.js"><link rel="prefetch" href="/assets/js/30.8d3f31d6.js"><link rel="prefetch" href="/assets/js/31.6d0bcdc1.js"><link rel="prefetch" href="/assets/js/32.c15d12ad.js"><link rel="prefetch" href="/assets/js/33.2e34e0f1.js"><link rel="prefetch" href="/assets/js/34.07a748b3.js"><link rel="prefetch" href="/assets/js/35.371d75ef.js"><link rel="prefetch" href="/assets/js/36.47833f09.js"><link rel="prefetch" href="/assets/js/37.5aff573e.js"><link rel="prefetch" href="/assets/js/38.98b7aca0.js"><link rel="prefetch" href="/assets/js/39.97563f6f.js"><link rel="prefetch" href="/assets/js/4.5017c5ca.js"><link rel="prefetch" href="/assets/js/40.61fb895c.js"><link rel="prefetch" href="/assets/js/41.35928488.js"><link rel="prefetch" href="/assets/js/42.759c42f7.js"><link rel="prefetch" href="/assets/js/43.e21776c9.js"><link rel="prefetch" href="/assets/js/44.255279ff.js"><link rel="prefetch" href="/assets/js/45.ef371806.js"><link rel="prefetch" href="/assets/js/46.622027f3.js"><link rel="prefetch" href="/assets/js/47.cbf8e024.js"><link rel="prefetch" href="/assets/js/48.4ae56a6b.js"><link rel="prefetch" href="/assets/js/49.f4018cc1.js"><link rel="prefetch" href="/assets/js/5.9c242416.js"><link rel="prefetch" href="/assets/js/50.7c62f270.js"><link rel="prefetch" href="/assets/js/51.07cd59a4.js"><link rel="prefetch" href="/assets/js/52.231bcdc6.js"><link rel="prefetch" href="/assets/js/53.29fe203c.js"><link rel="prefetch" href="/assets/js/54.35582c86.js"><link rel="prefetch" href="/assets/js/55.b19e1986.js"><link rel="prefetch" href="/assets/js/57.fcc2a3c2.js"><link rel="prefetch" href="/assets/js/58.448150de.js"><link rel="prefetch" href="/assets/js/59.aa0ee6c8.js"><link rel="prefetch" href="/assets/js/6.20f6982a.js"><link rel="prefetch" href="/assets/js/60.72f477f4.js"><link rel="prefetch" href="/assets/js/61.688d929f.js"><link rel="prefetch" href="/assets/js/62.fb7fdc39.js"><link rel="prefetch" href="/assets/js/63.46704b5a.js"><link rel="prefetch" href="/assets/js/64.0f47fc41.js"><link rel="prefetch" href="/assets/js/65.b5e933d1.js"><link rel="prefetch" href="/assets/js/66.6922c108.js"><link rel="prefetch" href="/assets/js/67.60ec4d8d.js"><link rel="prefetch" href="/assets/js/68.238b7ee4.js"><link rel="prefetch" href="/assets/js/69.999b211a.js"><link rel="prefetch" href="/assets/js/7.4c5dac4c.js"><link rel="prefetch" href="/assets/js/70.6d04da00.js"><link rel="prefetch" href="/assets/js/71.4533c8e2.js"><link rel="prefetch" href="/assets/js/72.3713cccd.js"><link rel="prefetch" href="/assets/js/73.34d08f4c.js"><link rel="prefetch" href="/assets/js/74.792ec8d5.js"><link rel="prefetch" href="/assets/js/75.9be3ffbe.js"><link rel="prefetch" href="/assets/js/76.51dc28a8.js"><link rel="prefetch" href="/assets/js/77.64dae30a.js"><link rel="prefetch" href="/assets/js/78.cc08edd6.js"><link rel="prefetch" href="/assets/js/79.0128fc12.js"><link rel="prefetch" href="/assets/js/8.6a57f7df.js"><link rel="prefetch" href="/assets/js/80.559288fa.js"><link rel="prefetch" href="/assets/js/81.5f2b15cb.js"><link rel="prefetch" href="/assets/js/82.7ab9c70b.js"><link rel="prefetch" href="/assets/js/83.f6086a96.js"><link rel="prefetch" href="/assets/js/84.e20b6490.js"><link rel="prefetch" href="/assets/js/85.7eb7cf11.js"><link rel="prefetch" href="/assets/js/86.515e4b4a.js"><link rel="prefetch" href="/assets/js/87.7912c6cf.js"><link rel="prefetch" href="/assets/js/88.7d3a28b9.js"><link rel="prefetch" href="/assets/js/89.d9d8ca6f.js"><link rel="prefetch" href="/assets/js/9.e5373fa3.js"><link rel="prefetch" href="/assets/js/90.aa1fa506.js"><link rel="prefetch" href="/assets/js/91.b12dc3ef.js"><link rel="prefetch" href="/assets/js/92.2a3eed45.js"><link rel="prefetch" href="/assets/js/93.437c1211.js"><link rel="prefetch" href="/assets/js/94.89f48741.js"><link rel="prefetch" href="/assets/js/95.636a4ed0.js"><link rel="prefetch" href="/assets/js/96.30adf466.js"><link rel="prefetch" href="/assets/js/97.63c9e300.js"><link rel="prefetch" href="/assets/js/98.6483b8d7.js"><link rel="prefetch" href="/assets/js/99.fc6a018d.js">
    <link rel="stylesheet" href="/assets/css/0.styles.7521ea85.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu have-body-img"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="https://image.bozhu12.cc/myblog/Essay/hendImage01.jpg" alt="柏竹" class="logo"> <span class="site-name can-hide">柏竹</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/backend/" class="nav-link router-link-active">后端</a></div><div class="nav-item"><a href="/web/" class="nav-link">前端</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/other/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/Amway/" class="nav-link">应用推荐</a></li></ul></div></div><div class="nav-item"><a href="/say/say2023/#四月" class="nav-link">说说</a></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/friendLink/" class="nav-link">友链</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://image.bozhu12.cc/myblog/Essay/favicon.ico"> <div class="blogger-info"><h3>柏竹</h3> <span>奋斗柏竹</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/backend/" class="nav-link router-link-active">后端</a></div><div class="nav-item"><a href="/web/" class="nav-link">前端</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/other/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/Amway/" class="nav-link">应用推荐</a></li></ul></div></div><div class="nav-item"><a href="/say/say2023/#四月" class="nav-link">说说</a></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/friendLink/" class="nav-link">友链</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/archives/" class="nav-link">归档</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Java基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JavaWeb</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>拓展技术</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>框架技术</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>数据库</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/backend/621sa1/" class="sidebar-link">MySQL</a></li><li><a href="/backend/0ygxqu/" class="sidebar-link">JDBC</a></li><li><a href="/backend/k5hxej/" aria-current="page" class="active sidebar-link">Hibernate</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/backend/k5hxej/#orm" class="sidebar-link">ORM</a></li><li class="sidebar-sub-header level2"><a href="/backend/k5hxej/#hibernate架构" class="sidebar-link">Hibernate架构</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/backend/k5hxej/#配置对象" class="sidebar-link">配置对象</a></li><li class="sidebar-sub-header level3"><a href="/backend/k5hxej/#会话工厂对象" class="sidebar-link">会话工厂对象</a></li><li class="sidebar-sub-header level3"><a href="/backend/k5hxej/#会话对象" class="sidebar-link">会话对象</a></li><li class="sidebar-sub-header level3"><a href="/backend/k5hxej/#事务对象" class="sidebar-link">事务对象</a></li><li class="sidebar-sub-header level3"><a href="/backend/k5hxej/#查询对象" class="sidebar-link">查询对象</a></li><li class="sidebar-sub-header level3"><a href="/backend/k5hxej/#约束对象" class="sidebar-link">约束对象</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/backend/k5hxej/#配置属性" class="sidebar-link">配置属性</a></li><li class="sidebar-sub-header level2"><a href="/backend/k5hxej/#映射文件" class="sidebar-link">映射文件</a></li><li class="sidebar-sub-header level2"><a href="/backend/k5hxej/#hibernate应用" class="sidebar-link">Hibernate应用</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/backend/k5hxej/#搭建环境-idea" class="sidebar-link">搭建环境 IDEA</a></li><li class="sidebar-sub-header level3"><a href="/backend/k5hxej/#连接操作" class="sidebar-link">连接操作</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/backend/k5hxej/#注解" class="sidebar-link">注解</a></li><li class="sidebar-sub-header level2"><a href="/backend/k5hxej/#反向工程" class="sidebar-link">反向工程</a></li><li class="sidebar-sub-header level2"><a href="/backend/k5hxej/#关联映射" class="sidebar-link">关联映射</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/backend/k5hxej/#一对多" class="sidebar-link">一对多</a></li><li class="sidebar-sub-header level3"><a href="/backend/k5hxej/#多对多" class="sidebar-link">多对多</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/backend/k5hxej/#高级查询" class="sidebar-link">高级查询</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/backend/k5hxej/#query" class="sidebar-link">Query</a></li><li class="sidebar-sub-header level3"><a href="/backend/k5hxej/#criteria" class="sidebar-link">Criteria</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/backend/k5hxej/#缓存机制" class="sidebar-link">缓存机制</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/backend/k5hxej/#一级缓存" class="sidebar-link">一级缓存</a></li><li class="sidebar-sub-header level3"><a href="/backend/k5hxej/#二级缓存" class="sidebar-link">二级缓存</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/backend/k5hxej/#hibernate问题" class="sidebar-link">Hibernate问题</a></li></ul></li><li><a href="/backend/zi2hq0/" class="sidebar-link">Mybatis</a></li><li><a href="/backend/ldn760/" class="sidebar-link">Redis</a></li><li><a href="/backend/redis2/" class="sidebar-link">Redis原理篇</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据结构</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Spring</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>SpringMVC</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>SpringBoot</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>SpringClound</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper bg-style-1"><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/backend/#后端" data-v-06225672>后端</a></li><li data-v-06225672><a href="/backend/#数据库" data-v-06225672>数据库</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="javascript:;" data-v-06225672>柏竹</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2020-02-18</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">Hibernate<!----></h1>  <div class="theme-vdoing-content content__default"><h1 id="hibernate"><a href="#hibernate" class="header-anchor">#</a> Hibernate</h1> <p>Hibernate 将 Java对象与数据库表之间建立起映射关系，并提供了一系列数据访问接口，可随心所欲对库进行操作</p> <p><strong>好处：</strong></p> <ul><li>Dao层开发简单</li> <li>兼容性好支持大多数主流数据库</li> <li>有二级缓存机制</li> <li>省略手动编写SQL语句（自动生成</li></ul> <p>Hibernate 开发包： <a href="https://sourceforge.net/projects/hibernate/files/hibernate-orm/5.5.3.Final/hibernate-release-5.5.3.Final.zip/download" target="_blank" rel="noopener noreferrer">Hibernate 官网<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><strong>目录说明：</strong></p> <ul><li>documentation：开发文档</li> <li>lib：依赖jar包</li> <li>project：工程实例</li></ul> <p>学习参考文档：</p> <ol><li>https://www.w3cschool.cn/hibernate/skzl1idz.html</li> <li>http://c.biancheng.net/hibernate/</li></ol> <h2 id="orm"><a href="#orm" class="header-anchor">#</a> ORM</h2> <p>ORM 是 Object Relational Mapping 的缩写，译为“对象关系映射”，它解决了对象和关系型数据库之间的数据交互问题</p> <p><strong>库与对象的关系</strong></p> <table><thead><tr><th style="text-align:center;">数据库</th> <th style="text-align:center;">类对象</th></tr></thead> <tbody><tr><td style="text-align:center;">表</td> <td style="text-align:center;">类</td></tr> <tr><td style="text-align:center;">表记录(数据)</td> <td style="text-align:center;">对象</td></tr> <tr><td style="text-align:center;">表字段</td> <td style="text-align:center;">对象属性</td></tr></tbody></table> <p><strong>ORM缺点</strong></p> <ul><li>学习成本高</li> <li>自动生成SQL会消耗资源</li> <li>复杂的SQL难以处理（有时候不如手写SQL</li></ul> <p><strong>好处上面有了（总之是JDBC使用的优化版</strong></p> <h2 id="hibernate架构"><a href="#hibernate架构" class="header-anchor">#</a> Hibernate架构</h2> <h3 id="配置对象"><a href="#配置对象" class="header-anchor">#</a> 配置对象</h3> <p>用于 <strong>连接数据库 / 创建类和表映射关系</strong> 的主要 配置文件</p> <p>默认全局配置文件：<code>hibernate.cfg.xml</code></p> <h3 id="会话工厂对象"><a href="#会话工厂对象" class="header-anchor">#</a> 会话工厂对象</h3> <p><code>SessionFactory</code>对象 用于 分配线程的应用(安全线程)，以防异步错乱的情况</p> <h3 id="会话对象"><a href="#会话对象" class="header-anchor">#</a> 会话对象</h3> <p><code>Session</code>对象 用于与数据库的物理连接</p> <p>详细说明：https://www.w3cschool.cn/hibernate/93tz1ied.html</p> <h3 id="事务对象"><a href="#事务对象" class="header-anchor">#</a> 事务对象</h3> <p><code>Transaction</code>对象 每个事务代表 一个单元CRUD操作 (一个以上</p> <h3 id="查询对象"><a href="#查询对象" class="header-anchor">#</a> 查询对象</h3> <p><code>org.hibernate.Query</code>对象 用于 自定义SQL / Hibernate语句 查询的数据集</p> <p><strong>对象获取</strong></p> <p>==Session.createQuery(String hql);==</p> <p><strong>常用方法</strong>（结果集获取</p> <table><thead><tr><th>返回</th> <th>方法</th> <th>说明</th></tr></thead> <tbody><tr><td><code>R</code></td> <td><code>uniqueResult()</code></td> <td>查询结果的单条数据，没有则null</td></tr> <tr><td><code>List&lt;R&gt;</code></td> <td><code>list()</code></td> <td>查询结果集以list形式的结果</td></tr> <tr><td><code>Iterator&lt;R&gt;</code></td> <td><code>iterate()</code></td> <td>查询结果集以迭代器形式的结果</td></tr></tbody></table> <blockquote><p>注意：list()方法 返回的数据 如果不为 实体对象的属性，那么它返回的是 <code>Object[]</code>数组</p></blockquote> <h3 id="约束对象"><a href="#约束对象" class="header-anchor">#</a> 约束对象</h3> <p><code>Criteria</code>对象 指定查询对象</p> <h2 id="配置属性"><a href="#配置属性" class="header-anchor">#</a> 配置属性</h2> <table><thead><tr><th>属性</th> <th>说明</th></tr></thead> <tbody><tr><td><code>hibernate.dialect</code></td> <td>配选定指定 库 生成对应的SQL</td></tr> <tr><td><code>hibernate.connection.driver_class</code></td> <td>加载 JDBC驱动</td></tr> <tr><td><code>hibernate.connection.url</code></td> <td>连接库的url</td></tr> <tr><td><code>hibernate.connection.username</code></td> <td>用户名</td></tr> <tr><td><code>hibernate.connection.password</code></td> <td>密码</td></tr> <tr><td><code>hibernate.connection.pool_size</code></td> <td>连接池中连接的数量</td></tr> <tr><td><code>hibernate.connection.autocommit</code></td> <td>允许JDBC自动提交模式</td></tr></tbody></table> <p><code>mapping</code>标签</p> <ul><li>resource 指定的是需要已经配置好的 ORM映射xml文件</li> <li>class 指定实体对象（用于注解）</li></ul> <p><strong>示例：</strong></p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">hibernate-configuration</span> <span class="token name">SYSTEM</span> 
<span class="token string">&quot;http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd&quot;</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hibernate-configuration</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>session-factory</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>hibernate.dialect<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>org.hibernate.dialect.MySQLDialect<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>hibernate.connection.driver_class<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>com.mysql.jdbc.Driver<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
       
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>hibernate.connection.url<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>jdbc:mysql://localhost/test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>hibernate.connection.username<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>root<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>hibernate.connection.password<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>root123<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>property</span><span class="token punctuation">&gt;</span></span>

   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapping</span> <span class="token attr-name">resource</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Employee.hbm.xml<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>session-factory</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>hibernate-configuration</span><span class="token punctuation">&gt;</span></span> 
</code></pre></div><h2 id="映射文件"><a href="#映射文件" class="header-anchor">#</a> 映射文件</h2> <p>映射文件 主要用于 让配置文件对应对接的映射配置，但也与实体类对接</p> <p><strong>命名规则：</strong> ==&lt;实体类名&gt;.hbm.xml==</p> <p><strong>标签描述：</strong></p> <ul><li><p><code>&lt;hibernate-mapping&gt;</code>：根元素的 XML 文件</p></li> <li><p><code>&lt;class&gt;</code>：指定 实体类 -&gt; 数据库表 的特定映射</p> <ul><li><code>name</code>：实体类（全限定名</li> <li><code>table</code>：数据库表名称</li></ul></li> <li><p><code>&lt;id&gt;</code>：类属性ID / 表ID字段 关联（唯一！！）</p> <ul><li><p><code>name</code>：类属性名</p></li> <li><p><code>column</code>：表字段名</p></li> <li><p><code>type</code>：映射类型</p></li> <li><p><code>&lt;generator&gt;</code> 自动生成主键值</p> <ul><li><p><code>class</code>：主键自增形式</p> <table><thead><tr><th>generator.class值</th> <th>说明</th></tr></thead> <tbody><tr><td>identity</td> <td>库底层自增机制</td></tr> <tr><td>increment</td> <td>Hibernate实现自增</td></tr> <tr><td>assigned</td> <td>字符串主键（算法生成</td></tr> <tr><td>sequence</td> <td>序列生成主键</td></tr></tbody></table></li></ul></li></ul></li> <li><p><code>&lt;property&gt;</code>：实体类属性 与 库表字段的匹配</p> <ul><li><code>name</code>：类属性名</li> <li><code>column</code>：表字段名</li> <li><code>type</code>：映射类型</li></ul></li></ul> <p>映射的数据类型：https://www.w3cschool.cn/hibernate/fzum1iem.html</p> <p><strong>示例：</strong></p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">hibernate-mapping</span> <span class="token name">PUBLIC</span> 
 <span class="token string">&quot;-//Hibernate/Hibernate Mapping DTD//EN&quot;</span>
 <span class="token string">&quot;http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd&quot;</span><span class="token punctuation">&gt;</span></span> 

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>hibernate-mapping</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>class</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Employee<span class="token punctuation">&quot;</span></span> <span class="token attr-name">table</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>EMPLOYEE<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">attribute</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>class-description<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
         This class contains the employee detail. 
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>meta</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>id<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>int<span class="token punctuation">&quot;</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>id<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
         <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>generator</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>identity<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>firstName<span class="token punctuation">&quot;</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>first_name<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>string<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>lastName<span class="token punctuation">&quot;</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>last_name<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>string<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>salary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>salary<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>int<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>class</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>hibernate-mapping</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><h2 id="hibernate应用"><a href="#hibernate应用" class="header-anchor">#</a> Hibernate应用</h2> <p>Hibernate上机操作应用</p> <h3 id="搭建环境-idea"><a href="#搭建环境-idea" class="header-anchor">#</a> 搭建环境 IDEA</h3> <p><strong>搭建步骤：</strong></p> <ol><li>引入lib</li> <li>连接数据库</li> <li>项目结构 -&gt; 模块 -&gt; 选中项目 -&gt;添加 Hibernate框架
(手动添加/生成 框架需要指定全局配置配置文件)</li></ol> <h3 id="连接操作"><a href="#连接操作" class="header-anchor">#</a> 连接操作</h3> <div style="background:rgba(64, 158, 255,0.6);border:1px solid rgba(1, 1, 1,0.2);border-radius:8px;padding:1px 12px;"><p style="font-size:20px;"></p><p style="font-size:20px;"><b>应用前提：</b> <ul><li>已经包含有 实体类/数据库数据 ，且他们的 实体类属性/数据库表字段 数据类型一致</li> <li>ORM映射关系和全局配置已经完善</li></ul></p></div> <p><strong>连接步骤：</strong></p> <ol><li><p>读取解析 全局配置文件</p> <p>==Configuration config = new Configuration().configure();==</p></li> <li><p>读取解析映射信息，创建SessionFactiory</p> <p>==SessionFactory sf = conf.buildSessionFactory();==</p></li> <li><p>获取Session
==Session session = sf.openSession();==</p></li> <li><p>启动事务</p> <p>==Transaction tx = session.beginTransaction();==</p></li> <li><p>CRUD操作数据 （通过session进行操作</p></li> <li><p>提交事务</p></li> <li><p>关闭资源</p></li></ol> <p><strong>应用工具类</strong></p> <blockquote><p>注意：由于新版使用的是 服务注册的形式 进行应用的，因此步骤可能有不一样</p></blockquote> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>sans<span class="token punctuation">.</span>util</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>hibernate<span class="token punctuation">.</span></span><span class="token class-name">Session</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>hibernate<span class="token punctuation">.</span></span><span class="token class-name">SessionFactory</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>hibernate<span class="token punctuation">.</span>cfg<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>hibernate<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">ServiceRegistry</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>hibernate<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">ServiceRegistryBuilder</span></span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HibernateUtil</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">ServiceRegistry</span> sr<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">SessionFactory</span> sf<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">ThreadLocal</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Session</span><span class="token punctuation">&gt;</span></span> localThread <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ThreadLocal</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">static</span> <span class="token punctuation">{</span>
        <span class="token class-name">Configuration</span> config <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Configuration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">configure</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        sr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ServiceRegistryBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">applySettings</span><span class="token punctuation">(</span>
                config<span class="token punctuation">.</span><span class="token function">getProperties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">buildServiceRegistry</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        config<span class="token punctuation">.</span><span class="token function">buildSessionFactory</span><span class="token punctuation">(</span>sr<span class="token punctuation">)</span><span class="token punctuation">;</span>
        sf <span class="token operator">=</span> config<span class="token punctuation">.</span><span class="token function">buildSessionFactory</span><span class="token punctuation">(</span>sr<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">/**
     * 获取会话
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Session</span> <span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Session</span> session <span class="token operator">=</span> localThread<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>session <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> <span class="token operator">!</span> session<span class="token punctuation">.</span><span class="token function">isOpen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            session <span class="token operator">=</span> sf<span class="token punctuation">.</span><span class="token function">openSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            localThread<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>session<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> session<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">/**
     * 关闭会话
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Session</span> session <span class="token operator">=</span> localThread<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>session <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            session<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            localThread<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            sf<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="注解"><a href="#注解" class="header-anchor">#</a> 注解</h2> <p>Hibernate注解 是摆脱了 xml 配置文件的应用</p> <div style="background:rgba(64, 158, 255,0.6);border:1px solid rgba(1, 1, 1,0.2);border-radius:8px;padding:1px 12px;"><p style="font-size:20px;"></p><p style="font-size:20px;"><b>应用前提：</b> <ul><li>Hibernate 3.x 以上的注释包</li> <li>关系jar包：</li> <ul><li><b>annotations.jar</b></li> <li><b>hibernate-comons-annotations.jar</b></li> <li><b>ejb3-persistence.jar</b></li></ul></ul></p></div> <table><thead><tr><th>注释</th> <th>范围</th> <th>参数</th> <th>说明</th></tr></thead> <tbody><tr><td><code>@Entity</code></td> <td>类</td> <td>-</td> <td>标志位实体类 bean</td></tr> <tr><td><code>@Table</code></td> <td>类</td> <td>String name 表名称 <br>String catalog  目录<br>String schema  模式<br>UniqueConstraint[] uniqueConstraints 约束</td> <td>映射表的配置</td></tr> <tr><td><code>@Id</code></td> <td>属性</td> <td>-</td> <td>主键</td></tr> <tr><td><code>@GeneratedValue</code></td> <td>属性</td> <td>GenerationType strategy 策略<br>String generator</td> <td>主键自动生成策略（一般默认即可）</td></tr> <tr><td><code>@Column</code></td> <td>属性</td> <td>String name 允许唯一<br>int length 指定数据长度<br>boolean nullable 非空<br>boolean unique 唯一</td> <td>定义属性与字段的细节属性</td></tr></tbody></table> <p><strong>示例：</strong></p> <p>SQL：</p> <div class="language-sql extra-class"><pre class="language-sql"><code><span class="token keyword">create</span> <span class="token keyword">table</span> EMPLOYEE <span class="token punctuation">(</span>
   id <span class="token keyword">INT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">auto_increment</span><span class="token punctuation">,</span>
   first_name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
   last_name  <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token keyword">default</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
   salary     <span class="token keyword">INT</span>  <span class="token keyword">default</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
   <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>id<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>实体对象：</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>persistence<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Entity</span>
<span class="token annotation punctuation">@Table</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;EMPLOYEE&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Employee</span> <span class="token punctuation">{</span>
   <span class="token annotation punctuation">@Id</span> <span class="token annotation punctuation">@GeneratedValue</span>
   <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span>
   <span class="token keyword">private</span> <span class="token keyword">int</span> id<span class="token punctuation">;</span>

   <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;first_name&quot;</span><span class="token punctuation">)</span>
   <span class="token keyword">private</span> <span class="token class-name">String</span> firstName<span class="token punctuation">;</span>

   <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;last_name&quot;</span><span class="token punctuation">)</span>
   <span class="token keyword">private</span> <span class="token class-name">String</span> lastName<span class="token punctuation">;</span>

   <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;salary&quot;</span><span class="token punctuation">)</span>
   <span class="token keyword">private</span> <span class="token keyword">int</span> salary<span class="token punctuation">;</span>  

   <span class="token keyword">public</span> <span class="token class-name">Employee</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
   <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> id<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setId</span><span class="token punctuation">(</span> <span class="token keyword">int</span> id <span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getFirstName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> firstName<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setFirstName</span><span class="token punctuation">(</span> <span class="token class-name">String</span> first_name <span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>firstName <span class="token operator">=</span> first_name<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getLastName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> lastName<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setLastName</span><span class="token punctuation">(</span> <span class="token class-name">String</span> last_name <span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>lastName <span class="token operator">=</span> last_name<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getSalary</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> salary<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
   <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setSalary</span><span class="token punctuation">(</span> <span class="token keyword">int</span> salary <span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>salary <span class="token operator">=</span> salary<span class="token punctuation">;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="反向工程"><a href="#反向工程" class="header-anchor">#</a> 反向工程</h2> <p>反向工程操作原意 数据库表 -&gt; 实体类</p> <p><strong>IDEA反向工程步骤：</strong></p> <p>**前提：**项目已 引入Hibernate框架</p> <ol><li>双击Shift -&gt; 操作项搜索<code>Persistence</code></li> <li>选中项目右键 -&gt; <code>生成持久映射</code></li> <li>指定数据库映射即可</li></ol> <p><strong>添加 数据构架的映射关系</strong>
添加关系映射关系一般用于 ==一对一 / 一对多 / 多对多== 的情况应用</p> <p><strong>确认必要信息</strong></p> <ul><li><p>源/目标 <strong>特定名称</strong> (指定实体对象的属性名)</p></li> <li><p>源/目标 <strong>属性类型</strong> （多则集合/少则对象</p></li> <li><p>联接列 必须选中 <strong>源的表字段/目标的表字段</strong> 两者是外键关系（一定要是外键关系</p></li> <li><p>多对多情况：需要手动指定联接表(第三表)进行对两表的进行连接</p> <p>需要手动确认4个列 分别为 ==<strong>源id</strong> / <strong>第三表外键源id</strong> / <strong>目标id</strong> / <strong>第三表外键目标id</strong>==</p></li></ul> <h2 id="关联映射"><a href="#关联映射" class="header-anchor">#</a> 关联映射</h2> <p>在关联映射当中有三种形式，分别为：</p> <ul><li>一对一</li> <li>一对多</li> <li>多对多</li></ul> <h3 id="一对多"><a href="#一对多" class="header-anchor">#</a> 一对多</h3> <p><strong>一方：</strong> 多方 的实体集合 ，通过标签 <code>&lt;set&gt;</code> 完成</p> <p><strong>多方：</strong> 一方 的实体类，通过标签 <code>&lt;many-to-one&gt;</code></p> <p><strong>必要标签说明：</strong></p> <p><code>&lt;many-to-one&gt;</code>：多对一</p> <ul><li><code>name</code>：关联对象的属性名</li> <li><code>column</code>：实体类对应的外键表字段名</li> <li><code>class</code>：关联对象类（全限定名</li></ul> <p><code>&lt;set&gt;</code>：一对多</p> <ul><li><code>name</code>：关联对象属性名</li> <li><code>&lt;key&gt;.column</code>：关联对象的外键名</li> <li><code>&lt;one-to-many&gt;.class</code>：关联对象类（全限定名</li></ul> <blockquote><p>一般情况会反向自动生成的xml</p></blockquote> <p><strong>联级操作：</strong></p> <p><code>&lt;set&gt;.cascade</code> ：联级操作</p> <ul><li><code>delete</code> ：联级删除</li> <li><code>all</code> ： 联级增删改</li> <li><code>sace-update</code> ：联级 增加/修改</li></ul> <p><strong>一对多示例：</strong>(部门一 - 员工多)</p> <p><strong>Staff员工表</strong></p> <table><thead><tr><th>字段名</th> <th>类型</th> <th>说明</th> <th>外键</th></tr></thead> <tbody><tr><td>id</td> <td>int</td> <td>-</td> <td>key</td></tr> <tr><td>name</td> <td>varchar</td> <td>名称</td> <td>-</td></tr> <tr><td>deptId</td> <td>int</td> <td>部门id</td> <td>dept.id</td></tr></tbody></table> <p><strong>Dept部门表</strong></p> <table><thead><tr><th>字段名</th> <th>类型</th> <th>说明</th> <th>外键</th></tr></thead> <tbody><tr><td>id</td> <td>int</td> <td>-</td> <td>key</td></tr> <tr><td>name</td> <td>varchar</td> <td>部门名称</td> <td>-</td></tr></tbody></table> <p><strong>Staff员工实体-xml配置</strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// Staff.java 员工实体对象</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Staff</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> id<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token comment">// 主要关系对象</span>
    <span class="token keyword">private</span> <span class="token class-name">Dept</span> dept<span class="token punctuation">;</span>
    <span class="token comment">//get、set配置。。。</span>
｝
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> <span class="token class-name">Staff</span><span class="token punctuation">.</span>hbm<span class="token punctuation">.</span>xml 配置 <span class="token operator">--</span><span class="token operator">&gt;</span> 
<span class="token operator">&lt;</span>hibernate<span class="token operator">-</span>mapping<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> <span class="token class-name"><span class="token namespace">oneToMany<span class="token punctuation">.</span></span>Staff</span> 包路径 <span class="token operator">/</span> staff 表名 <span class="token operator">--</span><span class="token operator">&gt;</span> 
    <span class="token operator">&lt;</span><span class="token keyword">class</span> name<span class="token operator">=</span><span class="token string">&quot;oneToMany.Staff&quot;</span> table<span class="token operator">=</span><span class="token string">&quot;staff&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>id name<span class="token operator">=</span><span class="token string">&quot;id&quot;</span> column<span class="token operator">=</span><span class="token string">&quot;id&quot;</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>generator <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;increment&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>generator<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>id<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">&quot;name&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>property<span class="token operator">&gt;</span>
    	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>  
                name<span class="token operator">:</span> <span class="token class-name">Staff</span>实体类中的dept属性
                column<span class="token operator">:</span> 子表中被外键约束修饰的字段名
				<span class="token keyword">class</span><span class="token operator">:</span> <span class="token class-name">Staff</span>相关联的<span class="token class-name">Dept</span>类
        <span class="token operator">--</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>many<span class="token operator">-</span><span class="token keyword">to</span><span class="token operator">-</span>one name<span class="token operator">=</span><span class="token string">&quot;dept&quot;</span> column<span class="token operator">=</span><span class="token string">&quot;deptId&quot;</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;oneToMany.Dept&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>many<span class="token operator">-</span><span class="token keyword">to</span><span class="token operator">-</span>one<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token keyword">class</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>hibernate<span class="token operator">-</span>mapping<span class="token operator">&gt;</span>
</code></pre></div><p><strong>Dept员工实体-xml配置</strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Dept</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> id<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token comment">// 建议手动创建初始化集合对象</span>
    <span class="token keyword">private</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Staff</span><span class="token punctuation">&gt;</span></span> staffSet <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// get、set配置。。。</span>
｝
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> <span class="token class-name">Staff</span><span class="token punctuation">.</span>hbm<span class="token punctuation">.</span>xml 配置 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>hibernate<span class="token operator">-</span>mapping<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token keyword">class</span> name<span class="token operator">=</span><span class="token string">&quot;oneToMany.Dept&quot;</span> table<span class="token operator">=</span><span class="token string">&quot;dept&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>id name<span class="token operator">=</span><span class="token string">&quot;id&quot;</span> column<span class="token operator">=</span><span class="token string">&quot;id&quot;</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>generator <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;increment&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>generator<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>id<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">&quot;name&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>property<span class="token operator">&gt;</span>
    	<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> key：子表被外键约束修饰的字段名 <span class="token operator">--</span><span class="token operator">&gt;</span> 
        <span class="token operator">&lt;</span>set name<span class="token operator">=</span><span class="token string">&quot;staffSet&quot;</span> cascade<span class="token operator">=</span><span class="token string">&quot;all&quot;</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>key column<span class="token operator">=</span><span class="token string">&quot;deptId&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>one<span class="token operator">-</span><span class="token keyword">to</span><span class="token operator">-</span>many <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;oneToMany.Staff&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>set<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token keyword">class</span><span class="token operator">&gt;</span>    
<span class="token operator">&lt;</span><span class="token operator">/</span>hibernate<span class="token operator">-</span>mapping<span class="token operator">&gt;</span>
</code></pre></div><p><strong>测试访问：</strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 多对一</span>
<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// 假设已经获取到了 Session 对象</span>
    
    <span class="token comment">//创建新部门</span>
    <span class="token class-name">Dept</span> dept <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Dept</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    dept<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;er部门&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

　　<span class="token comment">//创建新的职员</span>
    <span class="token class-name">Staff</span> staff <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Staff</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    staff<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;www&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

　　<span class="token comment">//给职员中添加部门</span>
    staff<span class="token punctuation">.</span><span class="token function">setDept</span><span class="token punctuation">(</span>dept<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
　　<span class="token comment">//给部门中添加职员</span>
    dept<span class="token punctuation">.</span><span class="token function">getStaffSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>staff<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
　　<span class="token comment">//保存部门</span>
    session<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>dept<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">del</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token comment">// 假设已经获取到了 Session 对象</span>
    <span class="token comment">// 指定查询id : 2</span>
	<span class="token class-name">Dept</span> dept <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Dept</span><span class="token punctuation">)</span> sesslin<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">Dept</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    session<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>dept<span class="token punctuation">)</span><span class="token punctuation">;</span>
  	
    <span class="token comment">// 删除会连同指定相同的id：2的部门一起删除</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// 假设已经获取到了 Session 对象</span>
 	<span class="token class-name">Dept</span> dept <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Dept</span><span class="token punctuation">)</span> sesslin<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">Dept</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>dept<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">Staff</span> staff <span class="token operator">:</span> detp<span class="token punctuation">.</span><span class="token function">getSeaff</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>staff<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="多对多"><a href="#多对多" class="header-anchor">#</a> 多对多</h3> <p>多对多关系 是两表之间对多关系，通常会以第三表为中间作为两表联系的关系表。两张表都只和关系表间建立主外键关系！</p> <p><code>&lt;many-to-many&gt;</code>：多对多</p> <ul><li><code>name</code>：关联对象的属性名</li> <li><code>column</code>：实体类对应的外键表字段名</li> <li><code>class</code>：关联对象类（全限定名</li></ul> <div style="background:rgba(64, 158, 255,0.6);border:1px solid rgba(1, 1, 1,0.2);border-radius:8px;padding:1px 12px;"><p style="font-size:20px;"></p><p style="font-size:20px;"><b>应用说明：</b> <ul><li>多对多的应用 也需要 cascade 联级操作 的操作</li></ul></p></div>
**多对多示例：**(功能多 - 角色多) （不同角色有不同的功能
<p><strong>Menu菜单表</strong></p> <table><thead><tr><th>字段名</th> <th>类型</th> <th>说明</th> <th>外键</th></tr></thead> <tbody><tr><td>m_id</td> <td>int</td> <td>-</td> <td>key</td></tr> <tr><td>m_name</td> <td>varchar</td> <td>菜单名称</td> <td>-</td></tr> <tr><td>m_state</td> <td>int</td> <td>状态</td> <td>-</td></tr></tbody></table> <p><strong>Role角色表</strong></p> <table><thead><tr><th>字段名</th> <th>类型</th> <th>说明</th> <th>外键</th></tr></thead> <tbody><tr><td>r_id</td> <td>int</td> <td>-</td> <td>key</td></tr> <tr><td>r_name</td> <td>varchar</td> <td>角色名称</td> <td>-</td></tr> <tr><td>r_state</td> <td>int</td> <td>状态</td> <td>-</td></tr></tbody></table> <p><strong>关系表</strong></p> <table><thead><tr><th>字段名</th> <th>类型</th> <th>说明</th> <th>外键</th></tr></thead> <tbody><tr><td>id</td> <td>int</td> <td>-</td> <td>key</td></tr> <tr><td>m_id</td> <td>int</td> <td>菜单id</td> <td>menu.id</td></tr> <tr><td>r_id</td> <td>int</td> <td>角色id</td> <td>role.id</td></tr></tbody></table> <p><strong>Role角色实体-xml配置</strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Role</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> rId<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> rName<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> rState<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Menu</span><span class="token punctuation">&gt;</span></span> menus <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// get/set ... </span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> <span class="token class-name">Role</span><span class="token punctuation">.</span>hbm<span class="token punctuation">.</span>xml 配置 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>hibernate<span class="token operator">-</span>mapping<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>sans<span class="token punctuation">.</span>pojo<span class="token punctuation">.</span></span>Role</span> 包路径 <span class="token operator">/</span> role 表名 <span class="token operator">/</span> hospital 数据库名 <span class="token operator">--</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token keyword">class</span> name<span class="token operator">=</span><span class="token string">&quot;com.sans.pojo.Role&quot;</span> table<span class="token operator">=</span><span class="token string">&quot;role&quot;</span> schema<span class="token operator">=</span><span class="token string">&quot;hospital&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>id name<span class="token operator">=</span><span class="token string">&quot;rId&quot;</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>column name<span class="token operator">=</span><span class="token string">&quot;r_id&quot;</span> sql<span class="token operator">-</span>type<span class="token operator">=</span><span class="token string">&quot;int&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>generator <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;native&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>id<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">&quot;rName&quot;</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>column name<span class="token operator">=</span><span class="token string">&quot;r_name&quot;</span> sql<span class="token operator">-</span>type<span class="token operator">=</span><span class="token string">&quot;varchar(80)&quot;</span> length<span class="token operator">=</span><span class="token string">&quot;80&quot;</span> not<span class="token operator">-</span><span class="token keyword">null</span><span class="token operator">=</span><span class="token string">&quot;true&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>property<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">&quot;rState&quot;</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>column name<span class="token operator">=</span><span class="token string">&quot;r_state&quot;</span> sql<span class="token operator">-</span>type<span class="token operator">=</span><span class="token string">&quot;int&quot;</span> not<span class="token operator">-</span><span class="token keyword">null</span><span class="token operator">=</span><span class="token string">&quot;true&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>property<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 联级操作第三表 需要配置 cascade<span class="token operator">=</span><span class="token string">&quot;all&quot;</span> <span class="token operator">--</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>set name<span class="token operator">=</span><span class="token string">&quot;menus&quot;</span> table<span class="token operator">=</span><span class="token string">&quot;role_menu&quot;</span> cascade<span class="token operator">=</span><span class="token string">&quot;all&quot;</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 外键字段 <span class="token operator">--</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>key column<span class="token operator">=</span><span class="token string">&quot;r_id&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 集合对应的实体类 <span class="token operator">--</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>many<span class="token operator">-</span><span class="token keyword">to</span><span class="token operator">-</span>many <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;com.sans.pojo.Menu&quot;</span> column<span class="token operator">=</span><span class="token string">&quot;m_id&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>set<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token keyword">class</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>hibernate<span class="token operator">-</span>mapping<span class="token operator">&gt;</span>
</code></pre></div><p><strong>Menu菜单实体-xml配置</strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Menu</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> mId<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> mName<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> mState<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Role</span><span class="token punctuation">&gt;</span></span> roles <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashSet</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// get/set ...</span>
<span class="token punctuation">}</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> <span class="token class-name">Menu</span><span class="token punctuation">.</span>hbm<span class="token punctuation">.</span>xml 配置 <span class="token operator">--</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>hibernate<span class="token operator">-</span>mapping<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token keyword">class</span> name<span class="token operator">=</span><span class="token string">&quot;com.sans.pojo.Menu&quot;</span> table<span class="token operator">=</span><span class="token string">&quot;menu&quot;</span> schema<span class="token operator">=</span><span class="token string">&quot;hospital&quot;</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>id name<span class="token operator">=</span><span class="token string">&quot;mId&quot;</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>column name<span class="token operator">=</span><span class="token string">&quot;m_id&quot;</span> sql<span class="token operator">-</span>type<span class="token operator">=</span><span class="token string">&quot;int&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>generator <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;native&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>id<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">&quot;mName&quot;</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>column name<span class="token operator">=</span><span class="token string">&quot;m_name&quot;</span> sql<span class="token operator">-</span>type<span class="token operator">=</span><span class="token string">&quot;varchar(80)&quot;</span> length<span class="token operator">=</span><span class="token string">&quot;80&quot;</span> not<span class="token operator">-</span><span class="token keyword">null</span><span class="token operator">=</span><span class="token string">&quot;true&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>property<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">&quot;mState&quot;</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>column name<span class="token operator">=</span><span class="token string">&quot;m_state&quot;</span> sql<span class="token operator">-</span>type<span class="token operator">=</span><span class="token string">&quot;int&quot;</span> not<span class="token operator">-</span><span class="token keyword">null</span><span class="token operator">=</span><span class="token string">&quot;true&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>property<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 联级操作第三表 需要配置 cascade<span class="token operator">=</span><span class="token string">&quot;all&quot;</span> <span class="token operator">--</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>set name<span class="token operator">=</span><span class="token string">&quot;roles&quot;</span> table<span class="token operator">=</span><span class="token string">&quot;role_menu&quot;</span> cascade<span class="token operator">=</span><span class="token string">&quot;all&quot;</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 外键字段 <span class="token operator">--</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>key column<span class="token operator">=</span><span class="token string">&quot;m_id&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 集合对应的实体类 <span class="token operator">--</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>many<span class="token operator">-</span><span class="token keyword">to</span><span class="token operator">-</span>many <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;com.sans.pojo.Role&quot;</span> column<span class="token operator">=</span><span class="token string">&quot;r_id&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>set<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token keyword">class</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>hibernate<span class="token operator">-</span>mapping<span class="token operator">&gt;</span>
</code></pre></div><p><strong>测试：</strong></p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">findByMenu</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Session</span> session <span class="token operator">=</span> <span class="token class-name">HibernateUtil</span><span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Transaction</span> tx <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">beginTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token class-name">Menu</span> menu <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Menu</span><span class="token punctuation">)</span> session<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">Menu</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;menu : &quot;</span> <span class="token operator">+</span> menu<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;menu.roles : &quot;</span> <span class="token operator">+</span> menu<span class="token punctuation">.</span><span class="token function">getRoles</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    tx<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">HibernateUtil</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">findByRole</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Session</span> session <span class="token operator">=</span> <span class="token class-name">HibernateUtil</span><span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Transaction</span> tx <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">beginTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    
    <span class="token class-name">Role</span> role <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Role</span><span class="token punctuation">)</span> session<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token class-name">Role</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;role : &quot;</span> <span class="token operator">+</span> role<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;role.menus : &quot;</span> <span class="token operator">+</span> role<span class="token punctuation">.</span><span class="token function">getMenus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    tx<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">HibernateUtil</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>

<span class="token comment">// 联级添加</span>
<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

    <span class="token class-name">Session</span> session <span class="token operator">=</span> <span class="token class-name">HibernateUtil</span><span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Transaction</span> tx <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">beginTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token class-name">Menu</span> menu <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Menu</span><span class="token punctuation">(</span><span class="token string">&quot;xx管理&quot;</span><span class="token punctuation">,</span><span class="token number">22</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;menu : &quot;</span> <span class="token operator">+</span> menu<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token class-name">Role</span> role1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Role</span><span class="token punctuation">(</span><span class="token string">&quot;医生&quot;</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Role</span> role2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Role</span><span class="token punctuation">(</span><span class="token string">&quot;主管&quot;</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    menu<span class="token punctuation">.</span><span class="token function">getRoles</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>role1<span class="token punctuation">)</span><span class="token punctuation">;</span>
    menu<span class="token punctuation">.</span><span class="token function">getRoles</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>role2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    session<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>menu<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    tx<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    session<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 联级删除</span>
<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">del</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Session</span> session <span class="token operator">=</span> <span class="token class-name">HibernateUtil</span><span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Transaction</span> tx <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">beginTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// 根据指定的 Role.id进行删除</span>
    <span class="token class-name">Role</span> role <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Role</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    role<span class="token punctuation">.</span><span class="token function">setrId</span><span class="token punctuation">(</span><span class="token number">39</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// 指定 Menu.id进行删除</span>
    <span class="token comment">// Menu menu = new Menu();</span>
    <span class="token comment">// menu.setmId(23);</span>
    
    session<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>role<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    tx<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">HibernateUtil</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="高级查询"><a href="#高级查询" class="header-anchor">#</a> 高级查询</h2> <p>Hibernate 框架 提供了两个用于查询的对象分别为 Query、Criteria对象</p> <blockquote><p>Criteria对象 应用起来方法较多，自行了解：</p> <p>https://www.w3cschool.cn/hibernate/ugov1ie8.html</p></blockquote> <h3 id="query"><a href="#query" class="header-anchor">#</a> Query</h3> <p>query查询方式 依靠自行编写的 hql语句进行查询数据</p> <p><strong>query对象获取</strong></p> <p>==Session.createQuery(String hql)==</p> <p><strong>query常用方法</strong></p> <p><strong>获取结果集方法</strong></p> <table><thead><tr><th>返回</th> <th>方法</th> <th>说明</th></tr></thead> <tbody><tr><td><code>R</code></td> <td><code>uniqueResult()</code></td> <td>查询结果的单条数据，没有则null</td></tr> <tr><td><code>List&lt;R&gt;</code></td> <td><code>list()</code></td> <td>查询结果集以list形式的结果</td></tr> <tr><td><code>Iterator&lt;R&gt;</code></td> <td><code>iterate()</code></td> <td>查询结果集以迭代器形式的结果</td></tr></tbody></table> <blockquote><p>**注意：**list()方法 返回的数据 如果不为 实体对象的属性，那么它返回的是 <code>Object[]</code>数组</p></blockquote> <p><strong>其他方法</strong></p> <table><thead><tr><th>返回</th> <th>方法</th> <th>说明</th></tr></thead> <tbody><tr><td><code>Query</code></td> <td><code>setXX( String/int , XX)</code> (XX为数据类型名)</td> <td>填充hql语句的 数据/占位符</td></tr> <tr><td><code>Query</code></td> <td><code>setFirstResult(int firstResult)</code></td> <td>设置 查询起始行数</td></tr> <tr><td><code>Query</code></td> <td><code>setMaxResults(int maxResults)</code></td> <td>设置 查询最大行数</td></tr></tbody></table> <p>更多方法可以在自行查看源码</p> <p><strong>query查询示例</strong></p> <div style="background:rgba(64, 158, 255,0.6);border:1px solid rgba(1, 1, 1,0.2);border-radius:8px;padding:1px 12px;"><p style="font-size:20px;"></p><p style="font-size:20px;"><b>示例说明：</b> <ul><li>仅展现功能代码块</li> <li>两表关系为 一对多 (一部门 - 多员工)</li></ul></p></div>
**数据库表**
<p><strong>dept部门表</strong></p> <table><thead><tr><th>字段名</th> <th>类型</th> <th>说明</th> <th>外键</th></tr></thead> <tbody><tr><td>deptno</td> <td>int</td> <td>id</td> <td>key</td></tr> <tr><td>dname</td> <td>varchar</td> <td>部门名</td> <td>-</td></tr> <tr><td>loc</td> <td>varhcar</td> <td>区</td> <td>-</td></tr></tbody></table> <p><strong>emp员工表</strong></p> <table><thead><tr><th>字段名</th> <th>类型</th> <th>说明</th> <th>外键</th></tr></thead> <tbody><tr><td>empno</td> <td>int</td> <td>id</td> <td>key</td></tr> <tr><td>ename</td> <td>varchar</td> <td>员工名称</td> <td>-</td></tr> <tr><td>sal</td> <td>decimal （浮点型</td> <td>工资</td> <td>-</td></tr> <tr><td>deptno</td> <td>int</td> <td>部门id</td> <td>dept.deptno</td></tr></tbody></table> <div class="language-java extra-class"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Demo</span> <span class="token punctuation">{</span>

    <span class="token comment">// 对象查询</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 查 部门对象</span>
        <span class="token class-name">String</span> hql <span class="token operator">=</span> <span class="token string">&quot;from Dept&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">Session</span> session <span class="token operator">=</span> <span class="token class-name">HibernateUtil</span><span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Query</span> query <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">createQuery</span><span class="token punctuation">(</span>hql<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Dept</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Dept</span> dept <span class="token operator">:</span> list<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;dept : &quot;</span> <span class="token operator">+</span> dept<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// 属性查询</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 查 指定部门</span>
        <span class="token class-name">String</span> hql <span class="token operator">=</span> <span class="token string">&quot;select loc,deptno from Dept&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">Session</span> session <span class="token operator">=</span> <span class="token class-name">HibernateUtil</span><span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Query</span> query <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">createQuery</span><span class="token punctuation">(</span>hql<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token operator">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> list <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> row <span class="token operator">:</span> list<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token string">&quot;\t - \t&quot;</span> <span class="token operator">+</span> row<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token class-name">HibernateUtil</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// 约束查询1</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test03</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> hql <span class="token operator">=</span> <span class="token string">&quot;from Dept where dname = ?&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">Session</span> session <span class="token operator">=</span> <span class="token class-name">HibernateUtil</span><span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Transaction</span> tx <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">beginTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Query</span> query <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">createQuery</span><span class="token punctuation">(</span>hql<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        query<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token number">0</span> <span class="token punctuation">,</span> <span class="token string">&quot;会计部&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Dept</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Dept</span> dept <span class="token operator">:</span> list<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>dept<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        
        tx<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">HibernateUtil</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// 约束查询2</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test04</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> hql <span class="token operator">=</span> <span class="token string">&quot;from Dept where dname = :name &quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">Session</span> session <span class="token operator">=</span> <span class="token class-name">HibernateUtil</span><span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Transaction</span> tx <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">beginTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Query</span> query <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">createQuery</span><span class="token punctuation">(</span>hql<span class="token punctuation">)</span><span class="token punctuation">;</span>
        query<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span> <span class="token punctuation">,</span> <span class="token string">&quot;会计部&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Dept</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Dept</span> dept <span class="token operator">:</span> list<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>dept<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        tx<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">HibernateUtil</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// 模糊查询</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test11</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> hql <span class="token operator">=</span> <span class="token string">&quot;from Emp where ename like :name&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">Session</span> session <span class="token operator">=</span> <span class="token class-name">HibernateUtil</span><span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Transaction</span> tx <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">beginTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Query</span> query <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">createQuery</span><span class="token punctuation">(</span>hql<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token comment">// 注意：不能含有单引号直接引用</span>
        <span class="token class-name">String</span> name <span class="token operator">=</span> <span class="token string">&quot;张&quot;</span><span class="token punctuation">;</span>
        query<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;%&quot;</span><span class="token operator">+</span>name<span class="token operator">+</span><span class="token string">&quot;%&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Emp</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Emp</span> emp <span class="token operator">:</span> list<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>emp<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    
        tx<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">HibernateUtil</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// 聚合查询</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test05</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> hql <span class="token operator">=</span> <span class="token string">&quot;select count(*) from Dept&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">Session</span> session <span class="token operator">=</span> <span class="token class-name">HibernateUtil</span><span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Transaction</span> tx <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">beginTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Query</span> query <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">createQuery</span><span class="token punctuation">(</span>hql<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token class-name">Long</span> count <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Long</span><span class="token punctuation">)</span> query<span class="token punctuation">.</span><span class="token function">uniqueResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;count : &quot;</span> <span class="token operator">+</span> count<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        tx<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">HibernateUtil</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// 分页查询</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test06</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> hql <span class="token operator">=</span> <span class="token string">&quot;from Emp&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">Session</span> session <span class="token operator">=</span> <span class="token class-name">HibernateUtil</span><span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Transaction</span> tx <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">beginTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Query</span> query <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">createQuery</span><span class="token punctuation">(</span>hql<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
        <span class="token keyword">int</span> index <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> pageSize <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
        <span class="token comment">// 指定 起始位置 和 总量</span>
        query<span class="token punctuation">.</span><span class="token function">setFirstResult</span><span class="token punctuation">(</span><span class="token punctuation">(</span>index <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> pageSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
        query<span class="token punctuation">.</span><span class="token function">setMaxResults</span><span class="token punctuation">(</span>pageSize<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Emp</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Emp</span> e <span class="token operator">:</span> list<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    
        tx<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">HibernateUtil</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// 内连接</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test07</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> hql <span class="token operator">=</span> <span class="token string">&quot;from Emp e inner join e.dept&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">Session</span> session <span class="token operator">=</span> <span class="token class-name">HibernateUtil</span><span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Transaction</span> tx <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">beginTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Query</span> query <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">createQuery</span><span class="token punctuation">(</span>hql<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
        <span class="token comment">// 将 emp的外键 deptno结合 dept 连接查询</span>
        <span class="token class-name">List</span><span class="token operator">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> list <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> row <span class="token operator">:</span> list<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Emp</span> emp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Emp</span><span class="token punctuation">)</span> row<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token class-name">Dept</span> dept <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Dept</span><span class="token punctuation">)</span> row<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;==========&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;emp : &quot;</span> <span class="token operator">+</span> emp<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;dept : &quot;</span> <span class="token operator">+</span> dept<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    
        tx<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">HibernateUtil</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// 追切内连接</span>
    <span class="token comment">// 解决封装的问题</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test08</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> hql <span class="token operator">=</span> <span class="token string">&quot;from Emp e inner join fetch e.dept&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">Session</span> session <span class="token operator">=</span> <span class="token class-name">HibernateUtil</span><span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Transaction</span> tx <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">beginTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Query</span> query <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">createQuery</span><span class="token punctuation">(</span>hql<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Emp</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Emp</span> emp <span class="token operator">:</span> list<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>emp<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        
        tx<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">HibernateUtil</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// 左外连接</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test09</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> hql <span class="token operator">=</span> <span class="token string">&quot;from Dept d left outer join d.emps&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">Session</span> session <span class="token operator">=</span> <span class="token class-name">HibernateUtil</span><span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Transaction</span> tx <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">beginTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Query</span> query <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">createQuery</span><span class="token punctuation">(</span>hql<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token class-name">List</span><span class="token operator">&lt;</span><span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> list <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> row <span class="token operator">:</span> list<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Dept</span> dept <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Dept</span><span class="token punctuation">)</span> row<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token class-name">Emp</span> emp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">Emp</span><span class="token punctuation">)</span> row<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;dept : &quot;</span> <span class="token operator">+</span> dept<span class="token punctuation">.</span><span class="token function">getDname</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>emp <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot; | &quot;</span><span class="token operator">+</span>emp<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot; | 无员工&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        
        tx<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">HibernateUtil</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// 追切左连接</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test10</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> hql <span class="token operator">=</span> <span class="token string">&quot;select distinct d from Dept d left outer join fetch d.emps&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">Session</span> session <span class="token operator">=</span> <span class="token class-name">HibernateUtil</span><span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Transaction</span> tx <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">beginTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Query</span> query <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">createQuery</span><span class="token punctuation">(</span>hql<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Dept</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> query<span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Dept</span> dept <span class="token operator">:</span> list<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;dept : &quot;</span> <span class="token operator">+</span> dept<span class="token punctuation">.</span><span class="token function">getDname</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Emp</span><span class="token punctuation">&gt;</span></span> emps <span class="token operator">=</span> dept<span class="token punctuation">.</span><span class="token function">getEmps</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>emps <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> emps<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Emp</span> emp <span class="token operator">:</span> emps<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\t&quot;</span> <span class="token operator">+</span> emp<span class="token punctuation">.</span><span class="token function">getEname</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\t无员工&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            
        <span class="token punctuation">}</span>
        
        tx<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">HibernateUtil</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre></div><h3 id="criteria"><a href="#criteria" class="header-anchor">#</a> Criteria</h3> <p><code>org.hibernate.Criteria</code>是 <strong>面向对象的方式</strong>在进行数据查询，无需手写hql语句</p> <p><strong>特点：</strong></p> <ul><li>面向对象查询</li> <li>摆脱hql语句拼接的应用</li></ul> <p><strong>Criteria对象获取</strong></p> <p>==Session.createCriteria(Class Bean)==</p> <p><strong>常用方法</strong></p> <p><strong>获取结果集</strong></p> <table><thead><tr><th>返回</th> <th>方法</th> <th>说明</th></tr></thead> <tbody><tr><td><code>List</code></td> <td><code>list()</code></td> <td>获取结果集列表</td></tr> <tr><td><code>Object</code></td> <td><code>uniqueResult()</code></td> <td>获取单个结果，没有则null</td></tr></tbody></table> <p><strong>查询约束</strong></p> <table><thead><tr><th>返回</th> <th>方法</th> <th>参数</th> <th>说明</th></tr></thead> <tbody><tr><td><code>Criterion</code></td> <td><code>add(Criterion criterion)</code></td> <td>约束criterion对象</td> <td>添加 约束条件</td></tr> <tr><td><code>Criterion</code></td> <td><code>setMaxResults(int maxResults)</code></td> <td>行最大值</td> <td>设置 查询最大行数</td></tr> <tr><td><code>Criterion</code></td> <td><code>setFirstResult(int firstResult)</code></td> <td>行起始值</td> <td>设置 查询起始行数</td></tr> <tr><td><code>Criterion</code></td> <td><code>createCriteria(String associationPath)</code></td> <td>属性数据集名称</td> <td>添加数据集 内连接</td></tr></tbody></table> <blockquote><p><code>org.hibernate.criterion.Criterion</code>约束对象（一般应用传递约束</p></blockquote> <p><strong><code>org.hibernate.criterion.Restrictions</code>标准约束对象</strong></p> <p>Restrictions对象 内置封装了常用约束静态方法</p> <p><strong>常用约束方法</strong></p> <table><thead><tr><th>返回</th> <th>方法</th> <th>说明</th></tr></thead> <tbody><tr><td><code>Criterion</code></td> <td><code>idEq(Object value)</code></td> <td>比较id</td></tr> <tr><td><code>Criterion</code></td> <td><code>eq(String propertyName, Object value)</code></td> <td>比较指定属性</td></tr> <tr><td><code>Criterion</code></td> <td><code>like(String propertyName, Object value)</code></td> <td>模糊指定属性</td></tr> <tr><td><code>Criterion</code></td> <td><code>ilike(String propertyName, Object value)</code></td> <td>模糊指定属性（省略大小写</td></tr> <tr><td><code>Criterion</code></td> <td><code>and(Criterion lhs, Criterion rhs)</code></td> <td>合并约束（同时满足）</td></tr> <tr><td><code>Criterion</code></td> <td><code>or(Criterion lhs, Criterion rhs)</code></td> <td>满足约束（其中满足）</td></tr> <tr><td><code>Criterion</code></td> <td><code>not(Criterion expression)</code></td> <td>约束取反（满足取反）</td></tr> <tr><td><code>Criterion</code></td> <td><code>between(String propertyName, Object lo, Object hi)</code></td> <td>选区范围值</td></tr> <tr><td>....</td> <td>....</td> <td>....</td></tr></tbody></table> <blockquote><p>方法比较多 自行查询API</p></blockquote> <p><strong><code>org.hibernate.criterion.Example</code>实例对象约束</strong></p> <p>Example对象 内置实例对象查询的方法一般情况直接写入实例对象即可</p> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// sfrom emp</span>
<span class="token class-name">List</span> results <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">createCriteria</span><span class="token punctuation">(</span><span class="token class-name">Emp</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
      			<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span> <span class="token class-name">Example</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>emp<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ignoreCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      			<span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p><strong>示例：</strong></p> <p><strong>数据库表</strong></p> <p><strong>dept部门表</strong></p> <table><thead><tr><th>字段名</th> <th>类型</th> <th>说明</th> <th>外键</th></tr></thead> <tbody><tr><td>deptno</td> <td>int</td> <td>id</td> <td>key</td></tr> <tr><td>dname</td> <td>varchar</td> <td>部门名</td> <td>-</td></tr> <tr><td>loc</td> <td>varhcar</td> <td>区</td> <td>-</td></tr></tbody></table> <p><strong>emp员工表</strong></p> <table><thead><tr><th>字段名</th> <th>类型</th> <th>说明</th> <th>外键</th></tr></thead> <tbody><tr><td>empno</td> <td>int</td> <td>id</td> <td>key</td></tr> <tr><td>ename</td> <td>varchar</td> <td>员工名称</td> <td>-</td></tr> <tr><td>sal</td> <td>decimal （浮点型</td> <td>工资</td> <td>-</td></tr> <tr><td>deptno</td> <td>int</td> <td>部门id</td> <td>dept.deptno</td></tr></tbody></table> <blockquote><p>PS：由于员工的工资属性sal 应用的是 BigDecimal 数据类型</p></blockquote> <div class="language-java extra-class"><pre class="language-java"><code><span class="token comment">// 普通类表查询</span>
<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test01</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Session</span> session <span class="token operator">=</span> <span class="token class-name">HibernateUtil</span><span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Transaction</span> tx <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">beginTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token class-name">Criteria</span> cr <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">createCriteria</span><span class="token punctuation">(</span><span class="token class-name">Emp</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Emp</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> cr<span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Emp</span> emp <span class="token operator">:</span> list<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>emp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    tx<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">HibernateUtil</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 约束查询</span>
<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test02</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Session</span> session <span class="token operator">=</span> <span class="token class-name">HibernateUtil</span><span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Transaction</span> tx <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">beginTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">Criteria</span> cr <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">createCriteria</span><span class="token punctuation">(</span><span class="token class-name">Emp</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 约束查 大于等于</span>
    cr<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">Restrictions</span><span class="token punctuation">.</span><span class="token function">ge</span><span class="token punctuation">(</span><span class="token string">&quot;sal&quot;</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Emp</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> cr<span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Emp</span> emp <span class="token operator">:</span> list<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>emp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    tx<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">HibernateUtil</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token comment">// 实例查询</span>
<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test03</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Session</span> session <span class="token operator">=</span> <span class="token class-name">HibernateUtil</span><span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Transaction</span> tx <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">beginTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token class-name">Criteria</span> cr <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">createCriteria</span><span class="token punctuation">(</span><span class="token class-name">Emp</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">Emp</span> emp <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Emp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    emp<span class="token punctuation">.</span><span class="token function">setJob</span><span class="token punctuation">(</span><span class="token string">&quot;CLERK&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    cr<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">Example</span><span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>emp<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Emp</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> cr<span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Emp</span> e <span class="token operator">:</span> list<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    tx<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">HibernateUtil</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 链式内连接查询</span>
<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test04</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Session</span> session <span class="token operator">=</span> <span class="token class-name">HibernateUtil</span><span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Transaction</span> tx <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">beginTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Dept</span><span class="token punctuation">&gt;</span></span> depts <span class="token operator">=</span>
            session<span class="token punctuation">.</span><span class="token function">createCriteria</span><span class="token punctuation">(</span><span class="token class-name">Dept</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">Restrictions</span><span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token string">&quot;dname&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;cqc&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">createCriteria</span><span class="token punctuation">(</span><span class="token string">&quot;emps&quot;</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">Restrictions</span><span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token string">&quot;ename&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;j4&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Dept</span> dept <span class="token operator">:</span> depts<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>dept<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    tx<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">HibernateUtil</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 表达式and约束查询</span>
<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test05</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">Session</span> session <span class="token operator">=</span> <span class="token class-name">HibernateUtil</span><span class="token punctuation">.</span><span class="token function">getSession</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Transaction</span> tx <span class="token operator">=</span> session<span class="token punctuation">.</span><span class="token function">beginTransaction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// 查工资大于5k 且 职位为 CLERK</span>
    <span class="token class-name">Criterion</span> crSal <span class="token operator">=</span> <span class="token class-name">Restrictions</span><span class="token punctuation">.</span><span class="token function">gt</span><span class="token punctuation">(</span><span class="token string">&quot;sal&quot;</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Criterion</span> crJob <span class="token operator">=</span> <span class="token class-name">Restrictions</span><span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token string">&quot;job&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;CLERK&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Emp</span><span class="token punctuation">&gt;</span></span> emps <span class="token operator">=</span>
    session<span class="token punctuation">.</span><span class="token function">createCriteria</span><span class="token punctuation">(</span><span class="token class-name">Emp</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">Restrictions</span><span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span>crSal<span class="token punctuation">,</span>crJob<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Emp</span> emp <span class="token operator">:</span> emps<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>emp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    tx<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">HibernateUtil</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="缓存机制"><a href="#缓存机制" class="header-anchor">#</a> 缓存机制</h2> <h3 id="一级缓存"><a href="#一级缓存" class="header-anchor">#</a> 一级缓存</h3> <p>Hibernate一级缓存是强制性的缓存，在 Session层(会话)</p> <p>**清空缓存条件：**Session关闭、数据更变</p> <h3 id="二级缓存"><a href="#二级缓存" class="header-anchor">#</a> 二级缓存</h3> <p>Hibernate一级缓存是选择性的缓存，主要负责跨会话缓存对象。</p> <p>需要直接配置策略</p> <h2 id="hibernate问题"><a href="#hibernate问题" class="header-anchor">#</a> Hibernate问题</h2> <ol><li><p><strong>hql语句 问题</strong></p> <ul><li>hql语句中的 表名的首字母一定要大写 （因：与类名一致，否则找不着</li> <li>遵守数据库命名规则</li></ul></li> <li><p><strong>联级操作 问题</strong></p> <ul><li><p>要手动添加 <code>&lt;set&gt;.cascade</code>属性/<code>&lt;generator&gt;.class</code>id自增策略 的应用（因：反向生成不会生成</p></li> <li><p>在联级添加数据时，尽可能避免指定外键id值添加数据（因：id值约束可能影响数据的添加</p></li> <li><p>在联级添加数据时，一方 配置的 <code>&lt;set&gt;.inverse</code>属性为true ，会产生二级数据的外键id为空，解决方式方案：将含有主键的一方设为 关系维护方即可</p> <div style="background:rgba(245, 108, 108,0.8);border:1px solid rgba(1, 1, 1,0.2);border-radius:8px;padding:1px 12px;"><p style="font-size:20px;"></p><p style="font-size:20px;"><b>原因: </b>
    以上的设置是 将 一方的 <b>关系维护</b> 交给多方管理,那么多方 在插入数据时会 根据对象的联级关系进行插入的，而一方的主键id生成在写入数据库之后生成的，因此二级的外键id为空
    </p></div></li> <li><p>在联级删除 多的一方，<code>&lt;set&gt;.cascade</code>属性值不能为none</p></li> <li><p>在联级删除 单的一方时，不能含有该属性<code>cascade</code></p></li></ul></li> <li><p><strong>反向生成 问题</strong></p> <ul><li>反向生成xml，不会生成 <code>&lt;generator&gt;.class</code>id自增策略（因：id可能会相同导致异常</li> <li>反向生成实体对象，实体对象的 对多关系 的 集合数据 需要初始化 （因：不初始化联级操作可能会出现异常</li></ul></li> <li><p><strong>对多数据 问题</strong></p> <ul><li>多对一 查询：<code>&lt;many-to-one&gt;</code>标签 添加 ==insert=&quot;false&quot; update=&quot;false&quot;==属性（因：在查询中可能会出现重复列的问题</li> <li>多对多 删除：多对多含有关系表的情况下，只要一方的数据被删除完，另一方还会存在数据指定的是双方的外键id（因：两表的外键约束的在第三方的关系表中，因此两表的是互补干扰的！</li></ul></li></ol></div></div>  <div class="page-edit"><!----> <div class="tags"><a href="/tags/?tag=Hibernate" title="标签">#Hibernate</a><a href="/tags/?tag=%E6%95%B0%E6%8D%AE%E5%BA%93" title="标签">#数据库</a></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2023/03/12, 00:43:49</span></div></div> <div class="page-nav-wapper"><!----> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/backend/0ygxqu/" class="prev">JDBC</a></span> <span class="next"><a href="/backend/zi2hq0/">Mybatis</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/%E8%8D%89%E7%A8%BF.html"><div>
            摘要
            <!----></div></a> <span class="date"></span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/cb60aa/"><div>
            整合WebSocket实现聊天功能
            <!----></div></a> <span class="date">07-02</span></dt></dl><dl><dd>03</dd> <dt><a href="/backend/40kn91/"><div>
            SpringBoot部署
            <!----></div></a> <span class="date">06-10</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="Sanscan12" title="联系" target="_blank" class="iconfont icon-weixin"></a><a href="https://github.com/Sanscan12" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/user/home?id=448156561" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2019-2023
    <span> | <a href="https://beian.miit.gov.cn/">桂ICP备2022009417号-1</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <div class="body-bg" style="background:url() center center / cover no-repeat;opacity:0.5;"></div> <!----> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.f3207224.js" defer></script><script src="/assets/js/2.b26d2d6f.js" defer></script><script src="/assets/js/56.908edc6d.js" defer></script>
  </body>
</html>
